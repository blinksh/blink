var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.checkStringArgs=function(a,b,c){if(null==a)throw new TypeError("The 'this' value for String.prototype."+c+" must not be null or undefined");if(b instanceof RegExp)throw new TypeError("First argument to String.prototype."+c+" must not be a regular expression");return a+""};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("String.prototype.repeat",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"repeat");if(0>a||1342177279<a)throw new RangeError("Invalid count value");a|=0;for(var d="";a;)if(a&1&&(d+=b),a>>>=1)b+=b;return d}},"es6","es3");$jscomp.polyfill("Object.getOwnPropertySymbols",function(a){return a?a:function(){return[]}},"es6","es5");
$jscomp.polyfill("Reflect.ownKeys",function(a){return a?a:function(a){var b=[],d=Object.getOwnPropertyNames(a);a=Object.getOwnPropertySymbols(a);for(var e=0;e<d.length;e++)("jscomp_symbol_"==d[e].substring(0,14)?a:b).push(d[e]);return b.concat(a)}},"es6","es5");
$jscomp.polyfill("String.prototype.startsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"startsWith");a+="";var e=b.length,g=a.length;c=Math.max(0,Math.min(c|0,b.length));for(var h=0;h<g&&c<e;)if(b[c++]!=a[h++])return!1;return h>=g}},"es6","es3");
$jscomp.polyfill("String.prototype.endsWith",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,a,"endsWith");a+="";void 0===c&&(c=b.length);c=Math.max(0,Math.min(c|0,b.length));for(var e=a.length;0<e&&0<c;)if(b[--c]!=a[--e])return!1;return 0>=e}},"es6","es3");$jscomp.stringPadding=function(a,b){a=void 0!==a?String(a):" ";return 0<b&&a?a.repeat(Math.ceil(b/a.length)).substring(0,b):""};
$jscomp.polyfill("String.prototype.padStart",function(a){return a?a:function(a,c){var b=$jscomp.checkStringArgs(this,null,"padStart");return $jscomp.stringPadding(c,a-b.length)+b}},"es8","es3");$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(m){this.asyncThrow_(m)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(n){b.reject(n)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(n){this.reject_(n);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var g=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(m){c.reject(m)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(r){g(r)}}:b}var d,g,f=new e(function(a,
b){d=a;g=b});this.callWhenSettled_(c(a,d),c(b,g));return f};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?g.asyncExecute(c):this.onSettledCallbacks_.push(function(){g.asyncExecute(c)})};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,
d){for(var e=$jscomp.makeIterator(a),g=e.next();!g.done;g=e.next())c(g.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
$jscomp.polyfill("Object.is",function(a){return a?a:function(a,c){return a===c?0!==a||1/a===1/c:a!==a&&c!==c}},"es6","es3");$jscomp.polyfill("Array.prototype.includes",function(a){return a?a:function(a,c){var b=this;b instanceof String&&(b=String(b));var e=b.length;for(c=c||0;c<e;c++)if(b[c]==a||Object.is(b[c],a))return!0;return!1}},"es7","es3");
$jscomp.polyfill("String.prototype.includes",function(a){return a?a:function(a,c){return-1!==$jscomp.checkStringArgs(this,a,"includes").indexOf(a,c||0)}},"es6","es3");$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");$jscomp.polyfill("String.prototype.codePointAt",function(a){return a?a:function(a){var b=$jscomp.checkStringArgs(this,null,"codePointAt"),d=b.length;a=Number(a)||0;if(0<=a&&a<d){a|=0;var e=b.charCodeAt(a);if(55296>e||56319<e||a+1===d)return e;a=b.charCodeAt(a+1);return 56320>a||57343<a?e:1024*(e-55296)+a+9216}}},"es6","es3");
$jscomp.polyfill("Number.isFinite",function(a){return a?a:function(a){return"number"!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}},"es6","es3");$jscomp.polyfill("Number.isInteger",function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(a){return a?a:function(a,c,d){var b=this.length||0;0>c&&(c=Math.max(0,b+c));if(null==d||d>b)d=b;d=Number(d);0>d&&(d=Math.max(0,b+d));for(c=Number(c||0);c<d;c++)this[c]=a;return this}},"es6","es3");$jscomp.owns=function(a,b){return Object.prototype.hasOwnProperty.call(a,b)};
$jscomp.polyfill("Object.assign",function(a){return a?a:function(a,c){for(var b=1;b<arguments.length;b++){var e=arguments[b];if(e)for(var g in e)$jscomp.owns(e,g)&&(a[g]=e[g])}return a}},"es6","es3");function setNodeText(a,b){a.textContent=b;a&&"SPAN"===a.nodeName&&!a.wcNode&&(b=b.length,a._len!==b&&(a._len=b,a.style.display="inline-block",a.style.overflowX="hidden",a.style.width="calc(var(--hterm-charsize-width) * "+b+")"))}
if("undefined"!=typeof lib)throw Error('Global "lib" object already exists.');
var lib={runtimeDependencies_:{},initCallbacks_:[],rtdep:function(a){try{throw Error();}catch(g){var b=g.stack.split("\n");b=3<=b.length?b[2].replace(/^\s*at\s+/,""):b[1].replace(/^\s*global code@/,"")}for(var c=0;c<arguments.length;c++){var d=arguments[c];if(d instanceof Array)lib.rtdep.apply(lib,d);else{var e=this.runtimeDependencies_[d];e||(e=this.runtimeDependencies_[d]=[]);e.push(b)}}},ensureRuntimeDependencies_:function(){var a=!0,b;for(b in lib.runtimeDependencies_)for(var c=lib.runtimeDependencies_[b],
d=b.split("."),e=window||self,g=0;g<d.length;g++){if(!(d[g]in e)){console.warn('Missing "'+b+'" is needed by',c);a=!1;break}e=e[d[g]]}if(!a)throw Error("Failed runtime dependency check");},registerInit:function(a,b){lib.initCallbacks_.push([a,b]);return b},init:function(a,b){var c=lib.initCallbacks_,d=function(){if(c.length){var e=c.shift();b&&b("init: "+e[0]);e[1](lib.f.alarm(d))}else a()};if("function"!=typeof a)throw Error("Missing or invalid argument: onInit");lib.ensureRuntimeDependencies_();
setTimeout(d,0)}};"use strict";String.prototype.padStart||(String.prototype.padStart=function(a,b){a-=this.length;if(0>=a)return String(this);void 0===b&&(b=" ");a>b.length&&(b=b.repeat(a/b.length+1));return b.slice(0,a)+String(this)});String.prototype.padEnd||(String.prototype.padEnd=function(a,b){a-=this.length;if(0>=a)return String(this);void 0===b&&(b=" ");a>b.length&&(b=b.repeat(a/b.length+1));return String(this)+b.slice(0,a)});
if(!Object.values||!Object.entries){var reduce=Function.bind.call(Function.call,Array.prototype.reduce),isEnumerable=Function.bind.call(Function.call,Object.prototype.propertyIsEnumerable),concat=Function.bind.call(Function.call,Array.prototype.concat);Object.values||(Object.values=function(a){return reduce(Reflect.ownKeys(a),function(b,c){return concat(b,"string"===typeof c&&isEnumerable(a,c)?[a[c]]:[])},[])});Object.entries||(Object.entries=function(a){return reduce(Reflect.ownKeys(a),function(b,
c){return concat(b,"string"===typeof c&&isEnumerable(a,c)?[[c,a[c]]]:[])},[])})}"use strict";lib.array={};lib.array.arrayBigEndianToUint32=function(a){return(a[0]<<24|a[1]<<16|a[2]<<8|a[3]<<0)>>>0};lib.array.uint32ToArrayBigEndian=function(a){return[a>>>24&255,a>>>16&255,a>>>8&255,a>>>0&255]};
lib.array.concatTyped=function(a){for(var b=[],c=0;c<arguments.length;++c)b[c-0]=arguments[c];var d=0,e=$jscomp.makeIterator(b);for(c=e.next();!c.done;c=e.next())d+=c.value.length;d=new b[0].constructor(d);e=0;b=$jscomp.makeIterator(b);for(c=b.next();!c.done;c=b.next())c=c.value,d.set(c,e),e+=c.length;return d};lib.array.compare=function(a,b){if(null===a||null===b)return null===a&&null===b;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!1;return!0};"use strict";
lib.colors={};
lib.colors.re_={hex16:/#([a-f0-9])([a-f0-9])([a-f0-9])/i,hex24:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/i,rgb:new RegExp("^/s*rgb/s*/(/s*(/d{1,3})/s*,/s*(/d{1,3})/s*,/s*(/d{1,3})/s*/)/s*$".replace(/\//g,"\\"),"i"),rgba:new RegExp("^/s*rgba/s*/(/s*(/d{1,3})/s*,/s*(/d{1,3})/s*,/s*(/d{1,3})/s*(?:,/s*(/d+(?:/./d+)?)/s*)/)/s*$".replace(/\//g,"\\"),"i"),rgbx:new RegExp("^/s*rgba?/s*/(/s*(/d{1,3})/s*,/s*(/d{1,3})/s*,/s*(/d{1,3})/s*(?:,/s*(/d+(?:/./d+)?)/s*)?/)/s*$".replace(/\//g,"\\"),"i"),x11rgb:/^\s*rgb:([a-f0-9]{1,4})\/([a-f0-9]{1,4})\/([a-f0-9]{1,4})\s*$/i,
name:/[a-z][a-z0-9\s]+/};lib.colors.rgbToX11=function(a){function b(a){a=(257*Math.min(a,255)).toString(16);return lib.f.zpad(a,4)}return(a=a.match(lib.colors.re_.rgbx))?"rgb:"+b(a[1])+"/"+b(a[2])+"/"+b(a[3]):null};
lib.colors.x11HexToCSS=function(a){if(!a.startsWith("#"))return null;a=a.substr(1);if(-1==[3,6,9,12].indexOf(a.length)||a.match(/[^a-f0-9]/i))return null;var b=a.length/3,c=a.substr(0,b),d=a.substr(b,b);a=a.substr(b+b,b);return lib.colors.arrayToRGBA([c,d,a].map(function(a){a=parseInt(a,16);return 2==b?a:1==b?a<<4:a>>4*(b-2)}))};
lib.colors.x11ToCSS=function(a){var b=a.match(lib.colors.re_.x11rgb);if(!b)return a.startsWith("#")?lib.colors.x11HexToCSS(a):lib.colors.nameToRGB(a);b.splice(0,1);return lib.colors.arrayToRGBA(b.map(function(a){if(1==a.length)return parseInt(a+a,16);if(2==a.length)return parseInt(a,16);3==a.length&&(a+=a.substr(2));return Math.round(parseInt(a,16)/257)}))};
lib.colors.hexToRGB=function(a){function b(a){4==a.length&&(a=a.replace(c,function(a,b,c,d){return"#"+b+b+c+c+d+d}));return(a=a.match(d))?"rgb("+parseInt(a[1],16)+", "+parseInt(a[2],16)+", "+parseInt(a[3],16)+")":null}var c=lib.colors.re_.hex16,d=lib.colors.re_.hex24;if(a instanceof Array)for(var e=0;e<a.length;e++)a[e]=b(a[e]);else a=b(a);return a};
lib.colors.rgbToHex=function(a){function b(a){return(a=lib.colors.crackRGB(a))?"#"+lib.f.zpad((parseInt(a[0])<<16|parseInt(a[1])<<8|parseInt(a[2])<<0).toString(16),6):null}if(a instanceof Array)for(var c=0;c<a.length;c++)a[c]=b(a[c]);else a=b(a);return a};lib.colors.normalizeCSS=function(a){return a.startsWith("#")?lib.colors.hexToRGB(a):lib.colors.re_.rgbx.test(a)?a:lib.colors.nameToRGB(a)};lib.colors.arrayToRGBA=function(a){return"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+(3<a.length?a[3]:1)+")"};
lib.colors.setAlpha=function(a,b){a=lib.colors.crackRGB(a);a[3]=b;return lib.colors.arrayToRGBA(a)};lib.colors.mix=function(a,b,c){a=lib.colors.crackRGB(a);b=lib.colors.crackRGB(b);for(var d=0;4>d;++d){var e=b[d]-a[d];a[d]=Math.round(parseInt(a[d])+e*c)}return lib.colors.arrayToRGBA(a)};
lib.colors.crackRGB=function(a){if(a.startsWith("rgba")){var b=a.match(lib.colors.re_.rgba);if(b)return b.shift(),b}else if(b=a.match(lib.colors.re_.rgb))return b.shift(),b.push("1"),b;console.error("Couldn't crack: "+a);return null};lib.colors.nameToRGB=function(a){if(a in lib.colors.colorNames)return lib.colors.colorNames[a];a=a.toLowerCase();if(a in lib.colors.colorNames)return lib.colors.colorNames[a];a=a.replace(/\s+/g,"");return a in lib.colors.colorNames?lib.colors.colorNames[a]:null};
lib.colors.stockColorPalette=lib.colors.hexToRGB("#000000 #CC0000 #4E9A06 #C4A000 #3465A4 #75507B #06989A #D3D7CF #555753 #EF2929 #00BA13 #FCE94F #729FCF #F200CB #00B5BD #EEEEEC #000000 #00005F #000087 #0000AF #0000D7 #0000FF #005F00 #005F5F #005F87 #005FAF #005FD7 #005FFF #008700 #00875F #008787 #0087AF #0087D7 #0087FF #00AF00 #00AF5F #00AF87 #00AFAF #00AFD7 #00AFFF #00D700 #00D75F #00D787 #00D7AF #00D7D7 #00D7FF #00FF00 #00FF5F #00FF87 #00FFAF #00FFD7 #00FFFF #5F0000 #5F005F #5F0087 #5F00AF #5F00D7 #5F00FF #5F5F00 #5F5F5F #5F5F87 #5F5FAF #5F5FD7 #5F5FFF #5F8700 #5F875F #5F8787 #5F87AF #5F87D7 #5F87FF #5FAF00 #5FAF5F #5FAF87 #5FAFAF #5FAFD7 #5FAFFF #5FD700 #5FD75F #5FD787 #5FD7AF #5FD7D7 #5FD7FF #5FFF00 #5FFF5F #5FFF87 #5FFFAF #5FFFD7 #5FFFFF #870000 #87005F #870087 #8700AF #8700D7 #8700FF #875F00 #875F5F #875F87 #875FAF #875FD7 #875FFF #878700 #87875F #878787 #8787AF #8787D7 #8787FF #87AF00 #87AF5F #87AF87 #87AFAF #87AFD7 #87AFFF #87D700 #87D75F #87D787 #87D7AF #87D7D7 #87D7FF #87FF00 #87FF5F #87FF87 #87FFAF #87FFD7 #87FFFF #AF0000 #AF005F #AF0087 #AF00AF #AF00D7 #AF00FF #AF5F00 #AF5F5F #AF5F87 #AF5FAF #AF5FD7 #AF5FFF #AF8700 #AF875F #AF8787 #AF87AF #AF87D7 #AF87FF #AFAF00 #AFAF5F #AFAF87 #AFAFAF #AFAFD7 #AFAFFF #AFD700 #AFD75F #AFD787 #AFD7AF #AFD7D7 #AFD7FF #AFFF00 #AFFF5F #AFFF87 #AFFFAF #AFFFD7 #AFFFFF #D70000 #D7005F #D70087 #D700AF #D700D7 #D700FF #D75F00 #D75F5F #D75F87 #D75FAF #D75FD7 #D75FFF #D78700 #D7875F #D78787 #D787AF #D787D7 #D787FF #D7AF00 #D7AF5F #D7AF87 #D7AFAF #D7AFD7 #D7AFFF #D7D700 #D7D75F #D7D787 #D7D7AF #D7D7D7 #D7D7FF #D7FF00 #D7FF5F #D7FF87 #D7FFAF #D7FFD7 #D7FFFF #FF0000 #FF005F #FF0087 #FF00AF #FF00D7 #FF00FF #FF5F00 #FF5F5F #FF5F87 #FF5FAF #FF5FD7 #FF5FFF #FF8700 #FF875F #FF8787 #FF87AF #FF87D7 #FF87FF #FFAF00 #FFAF5F #FFAF87 #FFAFAF #FFAFD7 #FFAFFF #FFD700 #FFD75F #FFD787 #FFD7AF #FFD7D7 #FFD7FF #FFFF00 #FFFF5F #FFFF87 #FFFFAF #FFFFD7 #FFFFFF #080808 #121212 #1C1C1C #262626 #303030 #3A3A3A #444444 #4E4E4E #585858 #626262 #6C6C6C #767676 #808080 #8A8A8A #949494 #9E9E9E #A8A8A8 #B2B2B2 #BCBCBC #C6C6C6 #D0D0D0 #DADADA #E4E4E4 #EEEEEE".split(" "));
lib.colors.colorPalette=lib.colors.stockColorPalette;
lib.colors.colorNames={aliceblue:"rgb(240, 248, 255)",antiquewhite:"rgb(250, 235, 215)",antiquewhite1:"rgb(255, 239, 219)",antiquewhite2:"rgb(238, 223, 204)",antiquewhite3:"rgb(205, 192, 176)",antiquewhite4:"rgb(139, 131, 120)",aquamarine:"rgb(127, 255, 212)",aquamarine1:"rgb(127, 255, 212)",aquamarine2:"rgb(118, 238, 198)",aquamarine3:"rgb(102, 205, 170)",aquamarine4:"rgb(69, 139, 116)",azure:"rgb(240, 255, 255)",azure1:"rgb(240, 255, 255)",azure2:"rgb(224, 238, 238)",azure3:"rgb(193, 205, 205)",
azure4:"rgb(131, 139, 139)",beige:"rgb(245, 245, 220)",bisque:"rgb(255, 228, 196)",bisque1:"rgb(255, 228, 196)",bisque2:"rgb(238, 213, 183)",bisque3:"rgb(205, 183, 158)",bisque4:"rgb(139, 125, 107)",black:"rgb(0, 0, 0)",blanchedalmond:"rgb(255, 235, 205)",blue:"rgb(0, 0, 255)",blue1:"rgb(0, 0, 255)",blue2:"rgb(0, 0, 238)",blue3:"rgb(0, 0, 205)",blue4:"rgb(0, 0, 139)",blueviolet:"rgb(138, 43, 226)",brown:"rgb(165, 42, 42)",brown1:"rgb(255, 64, 64)",brown2:"rgb(238, 59, 59)",brown3:"rgb(205, 51, 51)",
brown4:"rgb(139, 35, 35)",burlywood:"rgb(222, 184, 135)",burlywood1:"rgb(255, 211, 155)",burlywood2:"rgb(238, 197, 145)",burlywood3:"rgb(205, 170, 125)",burlywood4:"rgb(139, 115, 85)",cadetblue:"rgb(95, 158, 160)",cadetblue1:"rgb(152, 245, 255)",cadetblue2:"rgb(142, 229, 238)",cadetblue3:"rgb(122, 197, 205)",cadetblue4:"rgb(83, 134, 139)",chartreuse:"rgb(127, 255, 0)",chartreuse1:"rgb(127, 255, 0)",chartreuse2:"rgb(118, 238, 0)",chartreuse3:"rgb(102, 205, 0)",chartreuse4:"rgb(69, 139, 0)",chocolate:"rgb(210, 105, 30)",
chocolate1:"rgb(255, 127, 36)",chocolate2:"rgb(238, 118, 33)",chocolate3:"rgb(205, 102, 29)",chocolate4:"rgb(139, 69, 19)",coral:"rgb(255, 127, 80)",coral1:"rgb(255, 114, 86)",coral2:"rgb(238, 106, 80)",coral3:"rgb(205, 91, 69)",coral4:"rgb(139, 62, 47)",cornflowerblue:"rgb(100, 149, 237)",cornsilk:"rgb(255, 248, 220)",cornsilk1:"rgb(255, 248, 220)",cornsilk2:"rgb(238, 232, 205)",cornsilk3:"rgb(205, 200, 177)",cornsilk4:"rgb(139, 136, 120)",cyan:"rgb(0, 255, 255)",cyan1:"rgb(0, 255, 255)",cyan2:"rgb(0, 238, 238)",
cyan3:"rgb(0, 205, 205)",cyan4:"rgb(0, 139, 139)",darkblue:"rgb(0, 0, 139)",darkcyan:"rgb(0, 139, 139)",darkgoldenrod:"rgb(184, 134, 11)",darkgoldenrod1:"rgb(255, 185, 15)",darkgoldenrod2:"rgb(238, 173, 14)",darkgoldenrod3:"rgb(205, 149, 12)",darkgoldenrod4:"rgb(139, 101, 8)",darkgray:"rgb(169, 169, 169)",darkgreen:"rgb(0, 100, 0)",darkgrey:"rgb(169, 169, 169)",darkkhaki:"rgb(189, 183, 107)",darkmagenta:"rgb(139, 0, 139)",darkolivegreen:"rgb(85, 107, 47)",darkolivegreen1:"rgb(202, 255, 112)",darkolivegreen2:"rgb(188, 238, 104)",
darkolivegreen3:"rgb(162, 205, 90)",darkolivegreen4:"rgb(110, 139, 61)",darkorange:"rgb(255, 140, 0)",darkorange1:"rgb(255, 127, 0)",darkorange2:"rgb(238, 118, 0)",darkorange3:"rgb(205, 102, 0)",darkorange4:"rgb(139, 69, 0)",darkorchid:"rgb(153, 50, 204)",darkorchid1:"rgb(191, 62, 255)",darkorchid2:"rgb(178, 58, 238)",darkorchid3:"rgb(154, 50, 205)",darkorchid4:"rgb(104, 34, 139)",darkred:"rgb(139, 0, 0)",darksalmon:"rgb(233, 150, 122)",darkseagreen:"rgb(143, 188, 143)",darkseagreen1:"rgb(193, 255, 193)",
darkseagreen2:"rgb(180, 238, 180)",darkseagreen3:"rgb(155, 205, 155)",darkseagreen4:"rgb(105, 139, 105)",darkslateblue:"rgb(72, 61, 139)",darkslategray:"rgb(47, 79, 79)",darkslategray1:"rgb(151, 255, 255)",darkslategray2:"rgb(141, 238, 238)",darkslategray3:"rgb(121, 205, 205)",darkslategray4:"rgb(82, 139, 139)",darkslategrey:"rgb(47, 79, 79)",darkturquoise:"rgb(0, 206, 209)",darkviolet:"rgb(148, 0, 211)",debianred:"rgb(215, 7, 81)",deeppink:"rgb(255, 20, 147)",deeppink1:"rgb(255, 20, 147)",deeppink2:"rgb(238, 18, 137)",
deeppink3:"rgb(205, 16, 118)",deeppink4:"rgb(139, 10, 80)",deepskyblue:"rgb(0, 191, 255)",deepskyblue1:"rgb(0, 191, 255)",deepskyblue2:"rgb(0, 178, 238)",deepskyblue3:"rgb(0, 154, 205)",deepskyblue4:"rgb(0, 104, 139)",dimgray:"rgb(105, 105, 105)",dimgrey:"rgb(105, 105, 105)",dodgerblue:"rgb(30, 144, 255)",dodgerblue1:"rgb(30, 144, 255)",dodgerblue2:"rgb(28, 134, 238)",dodgerblue3:"rgb(24, 116, 205)",dodgerblue4:"rgb(16, 78, 139)",firebrick:"rgb(178, 34, 34)",firebrick1:"rgb(255, 48, 48)",firebrick2:"rgb(238, 44, 44)",
firebrick3:"rgb(205, 38, 38)",firebrick4:"rgb(139, 26, 26)",floralwhite:"rgb(255, 250, 240)",forestgreen:"rgb(34, 139, 34)",gainsboro:"rgb(220, 220, 220)",ghostwhite:"rgb(248, 248, 255)",gold:"rgb(255, 215, 0)",gold1:"rgb(255, 215, 0)",gold2:"rgb(238, 201, 0)",gold3:"rgb(205, 173, 0)",gold4:"rgb(139, 117, 0)",goldenrod:"rgb(218, 165, 32)",goldenrod1:"rgb(255, 193, 37)",goldenrod2:"rgb(238, 180, 34)",goldenrod3:"rgb(205, 155, 29)",goldenrod4:"rgb(139, 105, 20)",gray:"rgb(190, 190, 190)",gray0:"rgb(0, 0, 0)",
gray1:"rgb(3, 3, 3)",gray10:"rgb(26, 26, 26)",gray100:"rgb(255, 255, 255)",gray11:"rgb(28, 28, 28)",gray12:"rgb(31, 31, 31)",gray13:"rgb(33, 33, 33)",gray14:"rgb(36, 36, 36)",gray15:"rgb(38, 38, 38)",gray16:"rgb(41, 41, 41)",gray17:"rgb(43, 43, 43)",gray18:"rgb(46, 46, 46)",gray19:"rgb(48, 48, 48)",gray2:"rgb(5, 5, 5)",gray20:"rgb(51, 51, 51)",gray21:"rgb(54, 54, 54)",gray22:"rgb(56, 56, 56)",gray23:"rgb(59, 59, 59)",gray24:"rgb(61, 61, 61)",gray25:"rgb(64, 64, 64)",gray26:"rgb(66, 66, 66)",gray27:"rgb(69, 69, 69)",
gray28:"rgb(71, 71, 71)",gray29:"rgb(74, 74, 74)",gray3:"rgb(8, 8, 8)",gray30:"rgb(77, 77, 77)",gray31:"rgb(79, 79, 79)",gray32:"rgb(82, 82, 82)",gray33:"rgb(84, 84, 84)",gray34:"rgb(87, 87, 87)",gray35:"rgb(89, 89, 89)",gray36:"rgb(92, 92, 92)",gray37:"rgb(94, 94, 94)",gray38:"rgb(97, 97, 97)",gray39:"rgb(99, 99, 99)",gray4:"rgb(10, 10, 10)",gray40:"rgb(102, 102, 102)",gray41:"rgb(105, 105, 105)",gray42:"rgb(107, 107, 107)",gray43:"rgb(110, 110, 110)",gray44:"rgb(112, 112, 112)",gray45:"rgb(115, 115, 115)",
gray46:"rgb(117, 117, 117)",gray47:"rgb(120, 120, 120)",gray48:"rgb(122, 122, 122)",gray49:"rgb(125, 125, 125)",gray5:"rgb(13, 13, 13)",gray50:"rgb(127, 127, 127)",gray51:"rgb(130, 130, 130)",gray52:"rgb(133, 133, 133)",gray53:"rgb(135, 135, 135)",gray54:"rgb(138, 138, 138)",gray55:"rgb(140, 140, 140)",gray56:"rgb(143, 143, 143)",gray57:"rgb(145, 145, 145)",gray58:"rgb(148, 148, 148)",gray59:"rgb(150, 150, 150)",gray6:"rgb(15, 15, 15)",gray60:"rgb(153, 153, 153)",gray61:"rgb(156, 156, 156)",gray62:"rgb(158, 158, 158)",
gray63:"rgb(161, 161, 161)",gray64:"rgb(163, 163, 163)",gray65:"rgb(166, 166, 166)",gray66:"rgb(168, 168, 168)",gray67:"rgb(171, 171, 171)",gray68:"rgb(173, 173, 173)",gray69:"rgb(176, 176, 176)",gray7:"rgb(18, 18, 18)",gray70:"rgb(179, 179, 179)",gray71:"rgb(181, 181, 181)",gray72:"rgb(184, 184, 184)",gray73:"rgb(186, 186, 186)",gray74:"rgb(189, 189, 189)",gray75:"rgb(191, 191, 191)",gray76:"rgb(194, 194, 194)",gray77:"rgb(196, 196, 196)",gray78:"rgb(199, 199, 199)",gray79:"rgb(201, 201, 201)",gray8:"rgb(20, 20, 20)",
gray80:"rgb(204, 204, 204)",gray81:"rgb(207, 207, 207)",gray82:"rgb(209, 209, 209)",gray83:"rgb(212, 212, 212)",gray84:"rgb(214, 214, 214)",gray85:"rgb(217, 217, 217)",gray86:"rgb(219, 219, 219)",gray87:"rgb(222, 222, 222)",gray88:"rgb(224, 224, 224)",gray89:"rgb(227, 227, 227)",gray9:"rgb(23, 23, 23)",gray90:"rgb(229, 229, 229)",gray91:"rgb(232, 232, 232)",gray92:"rgb(235, 235, 235)",gray93:"rgb(237, 237, 237)",gray94:"rgb(240, 240, 240)",gray95:"rgb(242, 242, 242)",gray96:"rgb(245, 245, 245)",gray97:"rgb(247, 247, 247)",
gray98:"rgb(250, 250, 250)",gray99:"rgb(252, 252, 252)",green:"rgb(0, 255, 0)",green1:"rgb(0, 255, 0)",green2:"rgb(0, 238, 0)",green3:"rgb(0, 205, 0)",green4:"rgb(0, 139, 0)",greenyellow:"rgb(173, 255, 47)",grey:"rgb(190, 190, 190)",grey0:"rgb(0, 0, 0)",grey1:"rgb(3, 3, 3)",grey10:"rgb(26, 26, 26)",grey100:"rgb(255, 255, 255)",grey11:"rgb(28, 28, 28)",grey12:"rgb(31, 31, 31)",grey13:"rgb(33, 33, 33)",grey14:"rgb(36, 36, 36)",grey15:"rgb(38, 38, 38)",grey16:"rgb(41, 41, 41)",grey17:"rgb(43, 43, 43)",
grey18:"rgb(46, 46, 46)",grey19:"rgb(48, 48, 48)",grey2:"rgb(5, 5, 5)",grey20:"rgb(51, 51, 51)",grey21:"rgb(54, 54, 54)",grey22:"rgb(56, 56, 56)",grey23:"rgb(59, 59, 59)",grey24:"rgb(61, 61, 61)",grey25:"rgb(64, 64, 64)",grey26:"rgb(66, 66, 66)",grey27:"rgb(69, 69, 69)",grey28:"rgb(71, 71, 71)",grey29:"rgb(74, 74, 74)",grey3:"rgb(8, 8, 8)",grey30:"rgb(77, 77, 77)",grey31:"rgb(79, 79, 79)",grey32:"rgb(82, 82, 82)",grey33:"rgb(84, 84, 84)",grey34:"rgb(87, 87, 87)",grey35:"rgb(89, 89, 89)",grey36:"rgb(92, 92, 92)",
grey37:"rgb(94, 94, 94)",grey38:"rgb(97, 97, 97)",grey39:"rgb(99, 99, 99)",grey4:"rgb(10, 10, 10)",grey40:"rgb(102, 102, 102)",grey41:"rgb(105, 105, 105)",grey42:"rgb(107, 107, 107)",grey43:"rgb(110, 110, 110)",grey44:"rgb(112, 112, 112)",grey45:"rgb(115, 115, 115)",grey46:"rgb(117, 117, 117)",grey47:"rgb(120, 120, 120)",grey48:"rgb(122, 122, 122)",grey49:"rgb(125, 125, 125)",grey5:"rgb(13, 13, 13)",grey50:"rgb(127, 127, 127)",grey51:"rgb(130, 130, 130)",grey52:"rgb(133, 133, 133)",grey53:"rgb(135, 135, 135)",
grey54:"rgb(138, 138, 138)",grey55:"rgb(140, 140, 140)",grey56:"rgb(143, 143, 143)",grey57:"rgb(145, 145, 145)",grey58:"rgb(148, 148, 148)",grey59:"rgb(150, 150, 150)",grey6:"rgb(15, 15, 15)",grey60:"rgb(153, 153, 153)",grey61:"rgb(156, 156, 156)",grey62:"rgb(158, 158, 158)",grey63:"rgb(161, 161, 161)",grey64:"rgb(163, 163, 163)",grey65:"rgb(166, 166, 166)",grey66:"rgb(168, 168, 168)",grey67:"rgb(171, 171, 171)",grey68:"rgb(173, 173, 173)",grey69:"rgb(176, 176, 176)",grey7:"rgb(18, 18, 18)",grey70:"rgb(179, 179, 179)",
grey71:"rgb(181, 181, 181)",grey72:"rgb(184, 184, 184)",grey73:"rgb(186, 186, 186)",grey74:"rgb(189, 189, 189)",grey75:"rgb(191, 191, 191)",grey76:"rgb(194, 194, 194)",grey77:"rgb(196, 196, 196)",grey78:"rgb(199, 199, 199)",grey79:"rgb(201, 201, 201)",grey8:"rgb(20, 20, 20)",grey80:"rgb(204, 204, 204)",grey81:"rgb(207, 207, 207)",grey82:"rgb(209, 209, 209)",grey83:"rgb(212, 212, 212)",grey84:"rgb(214, 214, 214)",grey85:"rgb(217, 217, 217)",grey86:"rgb(219, 219, 219)",grey87:"rgb(222, 222, 222)",grey88:"rgb(224, 224, 224)",
grey89:"rgb(227, 227, 227)",grey9:"rgb(23, 23, 23)",grey90:"rgb(229, 229, 229)",grey91:"rgb(232, 232, 232)",grey92:"rgb(235, 235, 235)",grey93:"rgb(237, 237, 237)",grey94:"rgb(240, 240, 240)",grey95:"rgb(242, 242, 242)",grey96:"rgb(245, 245, 245)",grey97:"rgb(247, 247, 247)",grey98:"rgb(250, 250, 250)",grey99:"rgb(252, 252, 252)",honeydew:"rgb(240, 255, 240)",honeydew1:"rgb(240, 255, 240)",honeydew2:"rgb(224, 238, 224)",honeydew3:"rgb(193, 205, 193)",honeydew4:"rgb(131, 139, 131)",hotpink:"rgb(255, 105, 180)",
hotpink1:"rgb(255, 110, 180)",hotpink2:"rgb(238, 106, 167)",hotpink3:"rgb(205, 96, 144)",hotpink4:"rgb(139, 58, 98)",indianred:"rgb(205, 92, 92)",indianred1:"rgb(255, 106, 106)",indianred2:"rgb(238, 99, 99)",indianred3:"rgb(205, 85, 85)",indianred4:"rgb(139, 58, 58)",ivory:"rgb(255, 255, 240)",ivory1:"rgb(255, 255, 240)",ivory2:"rgb(238, 238, 224)",ivory3:"rgb(205, 205, 193)",ivory4:"rgb(139, 139, 131)",khaki:"rgb(240, 230, 140)",khaki1:"rgb(255, 246, 143)",khaki2:"rgb(238, 230, 133)",khaki3:"rgb(205, 198, 115)",
khaki4:"rgb(139, 134, 78)",lavender:"rgb(230, 230, 250)",lavenderblush:"rgb(255, 240, 245)",lavenderblush1:"rgb(255, 240, 245)",lavenderblush2:"rgb(238, 224, 229)",lavenderblush3:"rgb(205, 193, 197)",lavenderblush4:"rgb(139, 131, 134)",lawngreen:"rgb(124, 252, 0)",lemonchiffon:"rgb(255, 250, 205)",lemonchiffon1:"rgb(255, 250, 205)",lemonchiffon2:"rgb(238, 233, 191)",lemonchiffon3:"rgb(205, 201, 165)",lemonchiffon4:"rgb(139, 137, 112)",lightblue:"rgb(173, 216, 230)",lightblue1:"rgb(191, 239, 255)",
lightblue2:"rgb(178, 223, 238)",lightblue3:"rgb(154, 192, 205)",lightblue4:"rgb(104, 131, 139)",lightcoral:"rgb(240, 128, 128)",lightcyan:"rgb(224, 255, 255)",lightcyan1:"rgb(224, 255, 255)",lightcyan2:"rgb(209, 238, 238)",lightcyan3:"rgb(180, 205, 205)",lightcyan4:"rgb(122, 139, 139)",lightgoldenrod:"rgb(238, 221, 130)",lightgoldenrod1:"rgb(255, 236, 139)",lightgoldenrod2:"rgb(238, 220, 130)",lightgoldenrod3:"rgb(205, 190, 112)",lightgoldenrod4:"rgb(139, 129, 76)",lightgoldenrodyellow:"rgb(250, 250, 210)",
lightgray:"rgb(211, 211, 211)",lightgreen:"rgb(144, 238, 144)",lightgrey:"rgb(211, 211, 211)",lightpink:"rgb(255, 182, 193)",lightpink1:"rgb(255, 174, 185)",lightpink2:"rgb(238, 162, 173)",lightpink3:"rgb(205, 140, 149)",lightpink4:"rgb(139, 95, 101)",lightsalmon:"rgb(255, 160, 122)",lightsalmon1:"rgb(255, 160, 122)",lightsalmon2:"rgb(238, 149, 114)",lightsalmon3:"rgb(205, 129, 98)",lightsalmon4:"rgb(139, 87, 66)",lightseagreen:"rgb(32, 178, 170)",lightskyblue:"rgb(135, 206, 250)",lightskyblue1:"rgb(176, 226, 255)",
lightskyblue2:"rgb(164, 211, 238)",lightskyblue3:"rgb(141, 182, 205)",lightskyblue4:"rgb(96, 123, 139)",lightslateblue:"rgb(132, 112, 255)",lightslategray:"rgb(119, 136, 153)",lightslategrey:"rgb(119, 136, 153)",lightsteelblue:"rgb(176, 196, 222)",lightsteelblue1:"rgb(202, 225, 255)",lightsteelblue2:"rgb(188, 210, 238)",lightsteelblue3:"rgb(162, 181, 205)",lightsteelblue4:"rgb(110, 123, 139)",lightyellow:"rgb(255, 255, 224)",lightyellow1:"rgb(255, 255, 224)",lightyellow2:"rgb(238, 238, 209)",lightyellow3:"rgb(205, 205, 180)",
lightyellow4:"rgb(139, 139, 122)",limegreen:"rgb(50, 205, 50)",linen:"rgb(250, 240, 230)",magenta:"rgb(255, 0, 255)",magenta1:"rgb(255, 0, 255)",magenta2:"rgb(238, 0, 238)",magenta3:"rgb(205, 0, 205)",magenta4:"rgb(139, 0, 139)",maroon:"rgb(176, 48, 96)",maroon1:"rgb(255, 52, 179)",maroon2:"rgb(238, 48, 167)",maroon3:"rgb(205, 41, 144)",maroon4:"rgb(139, 28, 98)",mediumaquamarine:"rgb(102, 205, 170)",mediumblue:"rgb(0, 0, 205)",mediumorchid:"rgb(186, 85, 211)",mediumorchid1:"rgb(224, 102, 255)",mediumorchid2:"rgb(209, 95, 238)",
mediumorchid3:"rgb(180, 82, 205)",mediumorchid4:"rgb(122, 55, 139)",mediumpurple:"rgb(147, 112, 219)",mediumpurple1:"rgb(171, 130, 255)",mediumpurple2:"rgb(159, 121, 238)",mediumpurple3:"rgb(137, 104, 205)",mediumpurple4:"rgb(93, 71, 139)",mediumseagreen:"rgb(60, 179, 113)",mediumslateblue:"rgb(123, 104, 238)",mediumspringgreen:"rgb(0, 250, 154)",mediumturquoise:"rgb(72, 209, 204)",mediumvioletred:"rgb(199, 21, 133)",midnightblue:"rgb(25, 25, 112)",mintcream:"rgb(245, 255, 250)",mistyrose:"rgb(255, 228, 225)",
mistyrose1:"rgb(255, 228, 225)",mistyrose2:"rgb(238, 213, 210)",mistyrose3:"rgb(205, 183, 181)",mistyrose4:"rgb(139, 125, 123)",moccasin:"rgb(255, 228, 181)",navajowhite:"rgb(255, 222, 173)",navajowhite1:"rgb(255, 222, 173)",navajowhite2:"rgb(238, 207, 161)",navajowhite3:"rgb(205, 179, 139)",navajowhite4:"rgb(139, 121, 94)",navy:"rgb(0, 0, 128)",navyblue:"rgb(0, 0, 128)",oldlace:"rgb(253, 245, 230)",olivedrab:"rgb(107, 142, 35)",olivedrab1:"rgb(192, 255, 62)",olivedrab2:"rgb(179, 238, 58)",olivedrab3:"rgb(154, 205, 50)",
olivedrab4:"rgb(105, 139, 34)",orange:"rgb(255, 165, 0)",orange1:"rgb(255, 165, 0)",orange2:"rgb(238, 154, 0)",orange3:"rgb(205, 133, 0)",orange4:"rgb(139, 90, 0)",orangered:"rgb(255, 69, 0)",orangered1:"rgb(255, 69, 0)",orangered2:"rgb(238, 64, 0)",orangered3:"rgb(205, 55, 0)",orangered4:"rgb(139, 37, 0)",orchid:"rgb(218, 112, 214)",orchid1:"rgb(255, 131, 250)",orchid2:"rgb(238, 122, 233)",orchid3:"rgb(205, 105, 201)",orchid4:"rgb(139, 71, 137)",palegoldenrod:"rgb(238, 232, 170)",palegreen:"rgb(152, 251, 152)",
palegreen1:"rgb(154, 255, 154)",palegreen2:"rgb(144, 238, 144)",palegreen3:"rgb(124, 205, 124)",palegreen4:"rgb(84, 139, 84)",paleturquoise:"rgb(175, 238, 238)",paleturquoise1:"rgb(187, 255, 255)",paleturquoise2:"rgb(174, 238, 238)",paleturquoise3:"rgb(150, 205, 205)",paleturquoise4:"rgb(102, 139, 139)",palevioletred:"rgb(219, 112, 147)",palevioletred1:"rgb(255, 130, 171)",palevioletred2:"rgb(238, 121, 159)",palevioletred3:"rgb(205, 104, 137)",palevioletred4:"rgb(139, 71, 93)",papayawhip:"rgb(255, 239, 213)",
peachpuff:"rgb(255, 218, 185)",peachpuff1:"rgb(255, 218, 185)",peachpuff2:"rgb(238, 203, 173)",peachpuff3:"rgb(205, 175, 149)",peachpuff4:"rgb(139, 119, 101)",peru:"rgb(205, 133, 63)",pink:"rgb(255, 192, 203)",pink1:"rgb(255, 181, 197)",pink2:"rgb(238, 169, 184)",pink3:"rgb(205, 145, 158)",pink4:"rgb(139, 99, 108)",plum:"rgb(221, 160, 221)",plum1:"rgb(255, 187, 255)",plum2:"rgb(238, 174, 238)",plum3:"rgb(205, 150, 205)",plum4:"rgb(139, 102, 139)",powderblue:"rgb(176, 224, 230)",purple:"rgb(160, 32, 240)",
purple1:"rgb(155, 48, 255)",purple2:"rgb(145, 44, 238)",purple3:"rgb(125, 38, 205)",purple4:"rgb(85, 26, 139)",red:"rgb(255, 0, 0)",red1:"rgb(255, 0, 0)",red2:"rgb(238, 0, 0)",red3:"rgb(205, 0, 0)",red4:"rgb(139, 0, 0)",rosybrown:"rgb(188, 143, 143)",rosybrown1:"rgb(255, 193, 193)",rosybrown2:"rgb(238, 180, 180)",rosybrown3:"rgb(205, 155, 155)",rosybrown4:"rgb(139, 105, 105)",royalblue:"rgb(65, 105, 225)",royalblue1:"rgb(72, 118, 255)",royalblue2:"rgb(67, 110, 238)",royalblue3:"rgb(58, 95, 205)",
royalblue4:"rgb(39, 64, 139)",saddlebrown:"rgb(139, 69, 19)",salmon:"rgb(250, 128, 114)",salmon1:"rgb(255, 140, 105)",salmon2:"rgb(238, 130, 98)",salmon3:"rgb(205, 112, 84)",salmon4:"rgb(139, 76, 57)",sandybrown:"rgb(244, 164, 96)",seagreen:"rgb(46, 139, 87)",seagreen1:"rgb(84, 255, 159)",seagreen2:"rgb(78, 238, 148)",seagreen3:"rgb(67, 205, 128)",seagreen4:"rgb(46, 139, 87)",seashell:"rgb(255, 245, 238)",seashell1:"rgb(255, 245, 238)",seashell2:"rgb(238, 229, 222)",seashell3:"rgb(205, 197, 191)",
seashell4:"rgb(139, 134, 130)",sienna:"rgb(160, 82, 45)",sienna1:"rgb(255, 130, 71)",sienna2:"rgb(238, 121, 66)",sienna3:"rgb(205, 104, 57)",sienna4:"rgb(139, 71, 38)",skyblue:"rgb(135, 206, 235)",skyblue1:"rgb(135, 206, 255)",skyblue2:"rgb(126, 192, 238)",skyblue3:"rgb(108, 166, 205)",skyblue4:"rgb(74, 112, 139)",slateblue:"rgb(106, 90, 205)",slateblue1:"rgb(131, 111, 255)",slateblue2:"rgb(122, 103, 238)",slateblue3:"rgb(105, 89, 205)",slateblue4:"rgb(71, 60, 139)",slategray:"rgb(112, 128, 144)",
slategray1:"rgb(198, 226, 255)",slategray2:"rgb(185, 211, 238)",slategray3:"rgb(159, 182, 205)",slategray4:"rgb(108, 123, 139)",slategrey:"rgb(112, 128, 144)",snow:"rgb(255, 250, 250)",snow1:"rgb(255, 250, 250)",snow2:"rgb(238, 233, 233)",snow3:"rgb(205, 201, 201)",snow4:"rgb(139, 137, 137)",springgreen:"rgb(0, 255, 127)",springgreen1:"rgb(0, 255, 127)",springgreen2:"rgb(0, 238, 118)",springgreen3:"rgb(0, 205, 102)",springgreen4:"rgb(0, 139, 69)",steelblue:"rgb(70, 130, 180)",steelblue1:"rgb(99, 184, 255)",
steelblue2:"rgb(92, 172, 238)",steelblue3:"rgb(79, 148, 205)",steelblue4:"rgb(54, 100, 139)",tan:"rgb(210, 180, 140)",tan1:"rgb(255, 165, 79)",tan2:"rgb(238, 154, 73)",tan3:"rgb(205, 133, 63)",tan4:"rgb(139, 90, 43)",thistle:"rgb(216, 191, 216)",thistle1:"rgb(255, 225, 255)",thistle2:"rgb(238, 210, 238)",thistle3:"rgb(205, 181, 205)",thistle4:"rgb(139, 123, 139)",tomato:"rgb(255, 99, 71)",tomato1:"rgb(255, 99, 71)",tomato2:"rgb(238, 92, 66)",tomato3:"rgb(205, 79, 57)",tomato4:"rgb(139, 54, 38)",turquoise:"rgb(64, 224, 208)",
turquoise1:"rgb(0, 245, 255)",turquoise2:"rgb(0, 229, 238)",turquoise3:"rgb(0, 197, 205)",turquoise4:"rgb(0, 134, 139)",violet:"rgb(238, 130, 238)",violetred:"rgb(208, 32, 144)",violetred1:"rgb(255, 62, 150)",violetred2:"rgb(238, 58, 140)",violetred3:"rgb(205, 50, 120)",violetred4:"rgb(139, 34, 82)",wheat:"rgb(245, 222, 179)",wheat1:"rgb(255, 231, 186)",wheat2:"rgb(238, 216, 174)",wheat3:"rgb(205, 186, 150)",wheat4:"rgb(139, 126, 102)",white:"rgb(255, 255, 255)",whitesmoke:"rgb(245, 245, 245)",yellow:"rgb(255, 255, 0)",
yellow1:"rgb(255, 255, 0)",yellow2:"rgb(238, 238, 0)",yellow3:"rgb(205, 205, 0)",yellow4:"rgb(139, 139, 0)",yellowgreen:"rgb(154, 205, 50)"};"use strict";lib.f={};lib.f.createEnum=function(a){return new String(a)};lib.f.replaceVars=function(a,b){return a.replace(/%([a-z]*)\(([^\)]+)\)/gi,function(a,d,e){if("undefined"==typeof b[e])throw"Unknown variable: "+e;a=b[e];if(d in lib.f.replaceVars.functions)a=lib.f.replaceVars.functions[d](a);else if(d)throw"Unknown escape function: "+d;return a})};
lib.f.replaceVars.functions={encodeURI:encodeURI,encodeURIComponent:encodeURIComponent,escapeHTML:function(a){var b={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"};return a.replace(/[<>&"']/g,function(a){return b[a]})}};lib.f.getAcceptLanguages=function(a){lib.f.getAcceptLanguages.chromeSupported()?chrome.i18n.getAcceptLanguages(a):setTimeout(function(){a([navigator.language.replace(/-/g,"_")])},0)};lib.f.getAcceptLanguages.chromeSupported=function(){return window.chrome&&chrome.i18n};
lib.f.parseQuery=function(a){a.startsWith("?")&&(a=a.substr(1));var b={};a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].split("="),e=decodeURIComponent(d[0]);d=decodeURIComponent(d[1]);e.endsWith("[]")?(e=e.slice(0,-2),b[e]instanceof Array||(b[e]=[]),b[e].push(d)):b[e]=d}return b};lib.f.getURL=function(a){return lib.f.getURL.chromeSupported()?chrome.runtime.getURL(a):a};lib.f.getURL.chromeSupported=function(){return window.chrome&&chrome.runtime&&chrome.runtime.getURL};
lib.f.clamp=function(a,b,c){return a<b?b:a>c?c:a};lib.f.zpad=function(a,b){return String(a).padStart(b,"0")};lib.f.getWhitespace=function(a){if(0>=a)return"";var b=this.getWhitespace;b.whitespace||(b.whitespace="          ");for(;a>b.whitespace.length;)b.whitespace+=b.whitespace;return b.whitespace.substr(0,a)};
lib.f.alarm=function(a,b){var c=b||5E3,d=lib.f.getStack(1);return function(){var b=setTimeout(function(){var e="string"==typeof a?e:a.name;console.warn("lib.f.alarm: timeout expired: "+c/1E3+"s"+(e?": "+e:""));console.log(d);b=null},c),g=function(a){return function(){b&&(clearTimeout(b),b=null);return a.apply(null,arguments)}};return"string"==typeof a?g:g(a)}()};
lib.f.getStack=function(a){a=a?a+2:2;try{throw Error();}catch(e){var b=e.stack.split("\n")}for(var c={},d=a;d<b.length;d++)c[d-a]=b[d].replace(/^\s*at\s+/,"");return c};lib.f.smartFloorDivide=function(a,b){a/=b;b=Math.ceil(a);return 1E-4>b-a?b:Math.floor(a)};lib.f.randomInt=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};
lib.f.getOs=function(){if(window.browser&&browser.runtime&&browser.runtime.getPlatformInfo)return browser.runtime.getPlatformInfo().then(function(a){return a.os});if(window.chrome&&chrome.runtime&&chrome.runtime.getPlatformInfo)return new Promise(function(a,c){return chrome.runtime.getPlatformInfo(function(b){return a(b.os)})});if(window.navigator&&navigator.userAgent){var a=navigator.userAgent;if(a.includes("Mac OS X"))return Promise.resolve("mac");if(a.includes("CrOS"))return Promise.resolve("cros");
if(a.includes("Linux"))return Promise.resolve("linux");if(a.includes("Android"))return Promise.resolve("android");if(a.includes("Windows"))return Promise.resolve("windows")}return Promise.reject(null)};lib.f.getChromeMilestone=function(){if(window.navigator&&navigator.userAgent){var a=navigator.userAgent.match(/\sChrome\/(\d+)/);if(a)return parseInt(a[1])}return NaN};"use strict";
lib.MessageManager=function(a){this.languages_=a.map(function(a){return a.replace(/-/g,"_")});-1==this.languages_.indexOf("en")&&this.languages_.unshift("en");this.messages={}};lib.MessageManager.prototype.addMessages=function(a){for(var b in a){var c=a[b];this.messages[b]=c.placeholders?c.message.replace(/\$([a-z][^\s\$]+)\$/ig,function(c,e){return a[b].placeholders[e.toLowerCase()].content}):c.message}};
lib.MessageManager.prototype.findAndLoadMessages=function(a,b){function c(a){a?e=d.shift():g=d.shift();d.length?h():b(e,g)}var d=this.languages_.concat(),e=[],g=[],h=function(){this.loadMessages(this.replaceReferences(a,d),c.bind(this,!0),c.bind(this,!1))}.bind(this);h()};lib.MessageManager.prototype.loadMessages=function(a,b,c){var d=this,e=new XMLHttpRequest;e.onload=function(){d.addMessages(JSON.parse(e.responseText));b()};c&&(e.onerror=function(){return c(e)});e.open("GET",a);e.send()};
lib.MessageManager.replaceReferences=function(a,b){return a.replace(/\$(\d+)/g,function(a,d){return b[d-1]})};lib.MessageManager.prototype.replaceReferences=lib.MessageManager.replaceReferences;
lib.MessageManager.prototype.get=function(a,b,c){if(a in this.messages)var d=this.messages[a];else window.chrome&&window.chrome.i18n&&(d=chrome.i18n.getMessage(a)),d||(console.warn("Unknown message: "+a),d=void 0===c?a:c,this.messages[a]=d);if(!b)return d;b instanceof Array||(b=[b]);return this.replaceReferences(d,b)};lib.MessageManager.prototype.processI18nAttributes=function(a){a=a.querySelectorAll("[i18n]");for(var b=0;b<a.length;b++)this.processI18nAttribute(a[b])};
lib.MessageManager.prototype.processI18nAttribute=function(a){var b=a.getAttribute("i18n");if(b){try{b=JSON.parse(b)}catch(g){throw console.error("Can't parse "+a.tagName+"#"+a.id+": "+b),g;}for(var c in b){var d=c,e=b[c];e.startsWith("=")&&(c=e.substr(1),e=b[c]);e.startsWith("$")&&(e=(a.getAttribute(e.substr(1))+"_"+c).replace(/-/g,"_").toUpperCase());e=this.get(e);"_"==d?a.textContent=e:a.setAttribute(d,e)}}};"use strict";
lib.PreferenceManager=function(a,b){this.storage=a;this.storageObserver_=this.onStorageChange_.bind(this);this.isActive_=!1;this.activate();this.trace=!1;a=b||"/";a.endsWith("/")||(a+="/");this.prefix=a;this.prefRecords_={};this.globalObservers_=[];this.childFactories_={};this.childLists_={}};lib.PreferenceManager.prototype.DEFAULT_VALUE=lib.f.createEnum("DEFAULT");lib.PreferenceManager.Record=function(a,b){this.name=a;this.defaultValue=b;this.currentValue=this.DEFAULT_VALUE;this.observers=[]};
lib.PreferenceManager.Record.prototype.DEFAULT_VALUE=lib.PreferenceManager.prototype.DEFAULT_VALUE;lib.PreferenceManager.Record.prototype.addObserver=function(a){this.observers.push(a)};lib.PreferenceManager.Record.prototype.removeObserver=function(a){a=this.observers.indexOf(a);0<=a&&this.observers.splice(a,1)};
lib.PreferenceManager.Record.prototype.get=function(){return this.currentValue===this.DEFAULT_VALUE?/^(string|number)$/.test(typeof this.defaultValue)?this.defaultValue:"object"==typeof this.defaultValue?JSON.parse(JSON.stringify(this.defaultValue)):this.defaultValue:this.currentValue};lib.PreferenceManager.prototype.deactivate=function(){if(!this.isActive_)throw Error("Not activated");this.isActive_=!1;this.storage.removeObserver(this.storageObserver_)};
lib.PreferenceManager.prototype.activate=function(){if(this.isActive_)throw Error("Already activated");this.isActive_=!0;this.storage.addObserver(this.storageObserver_)};
lib.PreferenceManager.prototype.readStorage=function(a){function b(){0==--d&&a&&a()}var c=this,d=0,e=Object.keys(this.prefRecords_).map(function(a){return c.prefix+a});this.trace&&console.log("Preferences read: "+this.prefix);this.storage.getItems(e,function(c){var e=this.prefix.length,g;for(g in c){var n=c[g],m=g.substr(e),p=m in this.childLists_&&JSON.stringify(n)!=JSON.stringify(this.prefRecords_[m].currentValue);this.prefRecords_[m].currentValue=n;p&&(d++,this.syncChildList(m,b))}0==d&&a&&setTimeout(a)}.bind(this))};
lib.PreferenceManager.prototype.definePreference=function(a,b,c){var d=this.prefRecords_[a];d?this.changeDefault(a,b):d=this.prefRecords_[a]=new lib.PreferenceManager.Record(a,b);c&&d.addObserver(c)};lib.PreferenceManager.prototype.definePreferences=function(a){for(var b=0;b<a.length;b++)this.definePreference(a[b][0],a[b][1],a[b][2])};
lib.PreferenceManager.prototype.defineChildren=function(a,b){this.definePreference(a,[],this.onChildListChange_.bind(this,a));this.childFactories_[a]=b;this.childLists_[a]={}};lib.PreferenceManager.prototype.addObservers=function(a,b){if(a&&"function"!=typeof a)throw Error("Invalid param: globals");a&&this.globalObservers_.push(a);if(b)for(var c in b){if(!(c in this.prefRecords_))throw Error("Unknown preference: "+c);this.prefRecords_[c].addObserver(b[c])}};
lib.PreferenceManager.prototype.notifyAll=function(){for(var a in this.prefRecords_)this.notifyChange_(a)};lib.PreferenceManager.prototype.notifyChange_=function(a){var b=this.prefRecords_[a];if(!b)throw Error("Unknown preference: "+a);for(var c=b.get(),d=0;d<this.globalObservers_.length;d++)this.globalObservers_[d](a,c);for(d=0;d<b.observers.length;d++)b.observers[d](c,a,this)};
lib.PreferenceManager.prototype.createChild=function(a,b,c){var d=this.get(a);if(c){var e=c;if(-1!=d.indexOf(e))throw Error("Duplicate child: "+a+": "+e);}else for(;!e||-1!=d.indexOf(e);)e=lib.f.randomInt(1,65535).toString(16),e=lib.f.zpad(e,4),b&&(e=b+":"+e);b=this.childFactories_[a](this,e);b.trace=this.trace;b.resetAll();this.childLists_[a][e]=b;d.push(e);this.set(a,d);return b};
lib.PreferenceManager.prototype.removeChild=function(a,b){this.getChild(a,b).resetAll();var c=this.get(a),d=c.indexOf(b);-1!=d&&(c.splice(d,1),this.set(a,c));delete this.childLists_[a][b]};lib.PreferenceManager.prototype.getChild=function(a,b,c){if(!(a in this.childLists_))throw Error("Unknown child list: "+a);var d=this.childLists_[a];if(!(b in d)){if("undefined"==typeof c)throw Error('Unknown "'+a+'" child: '+b);return c}return d[b]};
lib.PreferenceManager.diffChildLists=function(a,b){for(var c={added:{},removed:{},common:{}},d=0;d<a.length;d++)-1!=b.indexOf(a[d])?c.common[a[d]]=!0:c.added[a[d]]=!0;for(d=0;d<b.length;d++)b[d]in c.added||b[d]in c.common||(c.removed[b[d]]=!0);return c};
lib.PreferenceManager.prototype.syncChildList=function(a,b){function c(){0==--d&&b&&b()}var d=0,e=this.get(a),g=Object.keys(this.childLists_[a]);lib.PreferenceManager.diffChildLists(e,g);for(var h=0;h<e.length;h++){var l=e[h],n=g.indexOf(l);0<=n&&g.splice(n,1);this.childLists_[a][l]||((n=this.childFactories_[a](this,l))?(n.trace=this.trace,this.childLists_[a][l]=n,d++,n.readStorage(c)):console.warn("Unable to restore child: "+a+": "+l))}for(h=0;h<g.length;h++)delete this.childLists_[a][g[h]];!d&&
b&&setTimeout(b)};lib.PreferenceManager.prototype.reset=function(a){var b=this.prefRecords_[a];if(!b)throw Error("Unknown preference: "+a);this.storage.removeItem(this.prefix+a);b.currentValue!==this.DEFAULT_VALUE&&(b.currentValue=this.DEFAULT_VALUE,this.notifyChange_(a))};
lib.PreferenceManager.prototype.resetAll=function(){var a=[];for(e in this.childLists_){var b=this.childLists_[e],c;for(c in b)b[c].resetAll()}for(var d in this.prefRecords_)this.prefRecords_[d].currentValue!==this.DEFAULT_VALUE&&(this.prefRecords_[d].currentValue=this.DEFAULT_VALUE,a.push(d));var e=Object.keys(this.prefRecords_).map(function(a){return this.prefix+a}.bind(this));this.storage.removeItems(e);a.forEach(this.notifyChange_.bind(this))};
lib.PreferenceManager.prototype.diff=function(a,b){return typeof a===typeof b&&/^(undefined|boolean|number|string)$/.test(typeof a)?a!==b:!0};lib.PreferenceManager.prototype.changeDefault=function(a,b){var c=this.prefRecords_[a];if(!c)throw Error("Unknown preference: "+a);this.diff(c.defaultValue,b)&&(c.currentValue!==this.DEFAULT_VALUE?c.defaultValue=b:(c.defaultValue=b,this.notifyChange_(a)))};lib.PreferenceManager.prototype.changeDefaults=function(a){for(var b in a)this.changeDefault(b,a[b])};
lib.PreferenceManager.prototype.set=function(a,b){var c=this.prefRecords_[a];if(!c)throw Error("Unknown preference: "+a);var d=c.get();this.diff(d,b)&&(this.diff(c.defaultValue,b)?(c.currentValue=b,this.storage.setItem(this.prefix+a,b)):(c.currentValue=this.DEFAULT_VALUE,this.storage.removeItem(this.prefix+a)),setTimeout(this.notifyChange_.bind(this,a),0))};lib.PreferenceManager.prototype.get=function(a){var b=this.prefRecords_[a];if(!b)throw Error("Unknown preference: "+a);return b.get()};
lib.PreferenceManager.prototype.exportAsJson=function(){var a={},b;for(b in this.prefRecords_)if(b in this.childLists_){a[b]=[];for(var c=this.get(b),d=0;d<c.length;d++){var e=c[d];a[b].push({id:e,json:this.getChild(b,e).exportAsJson()})}}else c=this.prefRecords_[b],c.currentValue!=this.DEFAULT_VALUE&&(a[b]=c.currentValue);return a};
lib.PreferenceManager.prototype.importFromJson=function(a,b){var c=0,d=function(){1>--c&&b&&b()},e;for(e in a)if(e in this.childLists_)for(var g=a[e],h=0;h<g.length;h++){var l=g[h].id,n=this.childLists_[e][l];n||(n=this.createChild(e,null,l));n.importFromJson(g[h].json,d);c++}else this.set(e,a[e]);0==c&&b&&b()};lib.PreferenceManager.prototype.onChildListChange_=function(a){this.syncChildList(a)};
lib.PreferenceManager.prototype.onStorageChange_=function(a){for(var b in a)if(!this.prefix||0==b.lastIndexOf(this.prefix,0)){var c=b.substr(this.prefix.length);if(c in this.prefRecords_){var d=this.prefRecords_[c],e=a[b].newValue,g=d.currentValue;g===d.DEFAULT_VALUE&&(g=void 0);this.diff(g,e)&&(d.currentValue="undefined"==typeof e||null===e?d.DEFAULT_VALUE:e,this.notifyChange_(c))}}};"use strict";lib.resource={resources_:{}};
lib.resource.add=function(a,b,c){lib.resource.resources_[a]={type:b,name:a,data:c}};lib.resource.get=function(a,b){if(!(a in lib.resource.resources_)){if("undefined"==typeof b)throw"Unknown resource: "+a;return b}return lib.resource.resources_[a]};lib.resource.getData=function(a,b){if(!(a in lib.resource.resources_)){if("undefined"==typeof b)throw"Unknown resource: "+a;return b}return lib.resource.resources_[a].data};
lib.resource.getDataUrl=function(a,b){a=lib.resource.get(a,b);return"data:"+a.type+","+a.data};"use strict";lib.Storage={};"use strict";lib.Storage.Chrome=function(a){this.storage_=a;this.observers_=[];chrome.storage.onChanged.addListener(this.onChanged_.bind(this))};lib.Storage.Chrome.prototype.onChanged_=function(a,b){if(chrome.storage[b]==this.storage_)for(b=0;b<this.observers_.length;b++)this.observers_[b](a)};lib.Storage.Chrome.prototype.addObserver=function(a){this.observers_.push(a)};
lib.Storage.Chrome.prototype.removeObserver=function(a){a=this.observers_.indexOf(a);-1!=a&&this.observers_.splice(a,1)};lib.Storage.Chrome.prototype.clear=function(a){this.storage_.clear();a&&setTimeout(a,0)};lib.Storage.Chrome.prototype.getItem=function(a,b){this.storage_.get(a,b)};lib.Storage.Chrome.prototype.getItems=function(a,b){this.storage_.get(a,b)};
lib.Storage.Chrome.prototype.setItem=function(a,b,c){var d=this,e=function(){if(chrome.runtime.lastError){if(chrome.runtime.lastError.message.indexOf("MAX_WRITE_OPERATIONS")){console.warn("Will retry save of "+a+" after exceeding quota",chrome.runtime.lastError);setTimeout(function(){return d.setItem(a,b,e)},1E3);return}console.error("Unknown runtime error",chrome.runtime.lastError)}c&&c()},g={};g[a]=b;this.storage_.set(g,e)};
lib.Storage.Chrome.prototype.setItems=function(a,b){this.storage_.set(a,b)};lib.Storage.Chrome.prototype.removeItem=function(a,b){this.storage_.remove(a,b)};lib.Storage.Chrome.prototype.removeItems=function(a,b){this.storage_.remove(a,b)};"use strict";lib.Storage.Local=function(){this.observers_=[];this.storage_=window.localStorage;window.addEventListener("storage",this.onStorage_.bind(this))};
lib.Storage.Local.prototype.onStorage_=function(a){if(a.storageArea==this.storage_){var b=a.oldValue?JSON.parse(a.oldValue):a.oldValue,c=a.newValue?JSON.parse(a.newValue):a.newValue,d={};d[a.key]={oldValue:b,newValue:c};for(a=0;a<this.observers_.length;a++)this.observers_[a](d)}};lib.Storage.Local.prototype.addObserver=function(a){this.observers_.push(a)};lib.Storage.Local.prototype.removeObserver=function(a){a=this.observers_.indexOf(a);-1!=a&&this.observers_.splice(a,1)};
lib.Storage.Local.prototype.clear=function(a){this.storage_.clear();a&&setTimeout(a,0)};lib.Storage.Local.prototype.getItem=function(a,b){a=this.storage_.getItem(a);if("string"==typeof a)try{a=JSON.parse(a)}catch(c){}setTimeout(b.bind(null,a),0)};lib.Storage.Local.prototype.getItems=function(a,b){for(var c={},d=a.length-1;0<=d;d--){var e=a[d],g=this.storage_.getItem(e);if("string"==typeof g)try{c[e]=JSON.parse(g)}catch(h){c[e]=g}else a.splice(d,1)}setTimeout(b.bind(null,c),0)};
lib.Storage.Local.prototype.setItem=function(a,b,c){this.storage_.setItem(a,JSON.stringify(b));c&&setTimeout(c,0)};lib.Storage.Local.prototype.setItems=function(a,b){for(var c in a)this.storage_.setItem(c,JSON.stringify(a[c]));b&&setTimeout(b,0)};lib.Storage.Local.prototype.removeItem=function(a,b){this.storage_.removeItem(a);b&&setTimeout(b,0)};lib.Storage.Local.prototype.removeItems=function(a,b){for(var c=0;c<a.length;c++)this.storage_.removeItem(a[c]);b&&setTimeout(b,0)};"use strict";
lib.Storage.Memory=function(){this.observers_=[];this.storage_={}};lib.Storage.Memory.prototype.addObserver=function(a){this.observers_.push(a)};lib.Storage.Memory.prototype.removeObserver=function(a){a=this.observers_.indexOf(a);-1!=a&&this.observers_.splice(a,1)};
lib.Storage.Memory.prototype.clear=function(a){var b={},c;for(c in this.storage_)b[c]={oldValue:this.storage_[c],newValue:void 0};this.storage_={};setTimeout(function(){for(var a=0;a<this.observers_.length;a++)this.observers_[a](b)}.bind(this),0);a&&setTimeout(a,0)};lib.Storage.Memory.prototype.getItem=function(a,b){a=this.storage_[a];if("string"==typeof a)try{a=JSON.parse(a)}catch(c){}setTimeout(b.bind(null,a),0)};
lib.Storage.Memory.prototype.getItems=function(a,b){for(var c={},d=a.length-1;0<=d;d--){var e=a[d],g=this.storage_[e];if("string"==typeof g)try{c[e]=JSON.parse(g)}catch(h){c[e]=g}else a.splice(d,1)}setTimeout(b.bind(null,c),0)};lib.Storage.Memory.prototype.setItem=function(a,b,c){var d=this.storage_[a];this.storage_[a]=JSON.stringify(b);var e={};e[a]={oldValue:d,newValue:b};setTimeout(function(){for(var a=0;a<this.observers_.length;a++)this.observers_[a](e)}.bind(this),0);c&&setTimeout(c,0)};
lib.Storage.Memory.prototype.setItems=function(a,b){var c={},d;for(d in a)c[d]={oldValue:this.storage_[d],newValue:a[d]},this.storage_[d]=JSON.stringify(a[d]);setTimeout(function(){for(var a=0;a<this.observers_.length;a++)this.observers_[a](c)}.bind(this));b&&setTimeout(b,0)};lib.Storage.Memory.prototype.removeItem=function(a,b){delete this.storage_[a];b&&setTimeout(b,0)};lib.Storage.Memory.prototype.removeItems=function(a,b){for(var c=0;c<a.length;c++)delete this.storage_[a[c]];b&&setTimeout(b,0)};
"use strict";lib.TestManager=function(a){this.log=a||new lib.TestManager.Log};lib.TestManager.prototype.createTestRun=function(a){return new lib.TestManager.TestRun(this,a)};lib.TestManager.prototype.onTestRunComplete=function(a){};lib.TestManager.prototype.testPreamble=function(a,b){};lib.TestManager.prototype.testPostamble=function(a,b){};
lib.TestManager.Log=function(a){var b=this;a=void 0===a?console:a;this.save=!1;this.prefix_=this.data="";this.prefixStack_=0;this.console_=a;["log","debug","info","warn","error"].forEach(function(a){var c="";switch(a){case "debug":case "warn":case "error":c=a.toUpperCase()+": "}var d=b.console_[a];b[a]=b.console_[a]=function(a){for(var e=[],g=0;g<arguments.length;++g)e[g-0]=arguments[g];b.save&&(b.data+=b.prefix_+c+e.join(" ")+"\n");d.apply(b.console_,e)}});["group","groupCollapsed"].forEach(function(a){var c=
b.console_[a];b[a]=b.console_[a]=function(a){a=void 0===a?"":a;c(a);b.save&&(b.data+=b.prefix_+a+"\n");b.prefix_="  ".repeat(++b.prefixStack_)}});var c=this.console_.groupEnd;this.groupEnd=this.console_.groupEnd=function(){c();b.prefixStack_&&(b.prefix_="  ".repeat(--b.prefixStack_))}};
lib.TestManager.Suite=function(a){function b(b,d){this.testManager_=b;this.suiteName=a;this.setup(d)}b.suiteName=a;b.addTest=lib.TestManager.Suite.addTest;b.disableTest=lib.TestManager.Suite.disableTest;b.getTest=lib.TestManager.Suite.getTest;b.getTestList=lib.TestManager.Suite.getTestList;b.testList_=[];b.testMap_={};b.prototype=Object.create(lib.TestManager.Suite.prototype);b.constructor=lib.TestManager.Suite;lib.TestManager.Suite.subclasses.push(b);return b};lib.TestManager.Suite.subclasses=[];
lib.TestManager.Suite.addTest=function(a,b){if(a in this.testMap_)throw"Duplicate test name: "+a;b=new lib.TestManager.Test(this,a,b);this.testMap_[a]=b;this.testList_.push(b)};lib.TestManager.Suite.disableTest=function(a,b){if(a in this.testMap_)throw"Duplicate test name: "+a;a=new lib.TestManager.Test(this,a,b);console.log("Disabled test: "+a.fullName)};lib.TestManager.Suite.getTest=function(a){return this.testMap_[a]};lib.TestManager.Suite.getTestList=function(){return this.testList_};
lib.TestManager.Suite.prototype.setDefaults=function(a,b){for(var c in b)this[c]=c in a?a[c]:b[c]};lib.TestManager.Suite.prototype.setup=function(a){};lib.TestManager.Suite.prototype.preamble=function(a,b){};lib.TestManager.Suite.prototype.postamble=function(a,b){};lib.TestManager.Test=function(a,b,c){this.suiteClass=a;this.testName=b;this.fullName=a.suiteName+"["+b+"]";this.testFunction_=c};
lib.TestManager.Test.prototype.run=function(a){try{this.testFunction_.apply(a.suite,[a,a.testRun.cx])}catch(b){b instanceof lib.TestManager.Result.TestComplete||(a.println("Test raised an exception: "+b),b.stack&&(b.stack instanceof Array?a.println(b.stack.join("\n")):a.println(b.stack)),a.completeTest_(a.FAILED,!1))}};
lib.TestManager.TestRun=function(a,b){this.testManager=a;this.log=a.log;this.cx=b||{};this.failures=[];this.passes=[];this.currentResult=this.duration=this.startDate=null;this.maxFailures=0;this.panic=!1;this.testQueue_=[]};lib.TestManager.TestRun.prototype.ALL_TESTS=lib.f.createEnum("<all-tests>");lib.TestManager.TestRun.prototype.selectTest=function(a){this.testQueue_.push(a)};
lib.TestManager.TestRun.prototype.selectSuite=function(a,b){b=b||this.ALL_TESTS;var c=0;a=a.getTestList();for(var d=0;d<a.length;d++){var e=a[d];if(b!==this.ALL_TESTS)if(b instanceof RegExp){if(!b.test(e.testName))continue}else if(e.testName!=b)continue;this.selectTest(e);c++}return c};
lib.TestManager.TestRun.prototype.selectPattern=function(a){for(var b=0,c=0;c<lib.TestManager.Suite.subclasses.length;c++)b+=this.selectSuite(lib.TestManager.Suite.subclasses[c],a);b||this.log.warn("No tests matched selection criteria: "+a);return b};
lib.TestManager.TestRun.prototype.onUncaughtException_=function(a,b,c){if(0==a.indexOf("Uncaught lib.TestManager.Result.TestComplete")||-1!=a.indexOf("status: passed"))return!0;if(this.currentResult&&a!="Uncaught "+this.currentResult.expectedErrorMessage_){var d="during";this.currentResult.status!=this.currentResult.PENDING&&(d="after");this.log.error("Uncaught exception "+d+" test case: "+this.currentResult.test.fullName);this.log.error(a+", "+b+":"+c);this.currentResult.completeTest_(this.currentResult.FAILED,
!1);return!1}};lib.TestManager.TestRun.prototype.onTestRunComplete_=function(a){a?(this.duration=new Date-this.startDate,this.log.groupEnd(),this.log.info(this.passes.length+" passed, "+this.failures.length+" failed, "+this.msToSeconds_(this.duration)),this.summarize(),window.onerror=null,this.testManager.onTestRunComplete(this)):setTimeout(this.onTestRunComplete_.bind(this),0,!0)};
lib.TestManager.TestRun.prototype.onResultComplete=function(a){try{this.testManager.testPostamble(a,this.cx),a.suite.postamble(a,this.ctx)}catch(b){this.log.error("Unexpected exception in postamble: "+(b.stack?b.stack:b)),this.panic=!0}a.status!=a.PASSED?this.log.error(a.status):500<a.duration&&this.log.warn("Slow test took "+this.msToSeconds_(a.duration));this.log.groupEnd();if(a.status==a.FAILED)this.failures.push(a),this.currentSuite=null;else if(a.status==a.PASSED)this.passes.push(a);else{this.log.error("Unknown result status: "+
a.test.fullName+": "+a.status);this.panic=!0;return}this.runNextTest_()};lib.TestManager.TestRun.prototype.onResultReComplete=function(a,b){this.log.error("Late complete for test: "+a.test.fullName+": "+b);b=this.passes.indexOf(a);0<=b&&(this.passes.splice(b,1),this.failures.push(a))};
lib.TestManager.TestRun.prototype.runNextTest_=function(){if(this.panic||!this.testQueue_.length)this.onTestRunComplete_();else if(this.maxFailures&&this.failures.length>=this.maxFailures)this.log.error("Maximum failure count reached, aborting test run."),this.onTestRunComplete_();else{var a=this.testQueue_[0],b=this.currentResult?this.currentResult.suite:null;try{b&&b instanceof a.suiteClass||(b&&this.log.groupEnd(),this.log.group(a.suiteClass.suiteName),b=new a.suiteClass(this.testManager,this.cx))}catch(c){this.log.error("Exception during setup: "+
(c.stack?c.stack:c));this.panic=!0;this.onTestRunComplete_();return}try{this.log.group(a.testName),this.currentResult=new lib.TestManager.Result(this,b,a),this.testManager.testPreamble(this.currentResult,this.cx),b.preamble(this.currentResult,this.cx),this.testQueue_.shift()}catch(c){this.log.error("Unexpected exception during test preamble: "+(c.stack?c.stack:c));this.log.groupEnd();this.panic=!0;this.onTestRunComplete_();return}try{this.currentResult.run()}catch(c){this.log.error("Unexpected exception during test run: "+
(c.stack?c.stack:c)),this.panic=!0}}};lib.TestManager.TestRun.prototype.run=function(){this.log.info("Running "+this.testQueue_.length+" test(s)");window.onerror=this.onUncaughtException_.bind(this);this.startDate=new Date;this.runNextTest_()};lib.TestManager.TestRun.prototype.msToSeconds_=function(a){return(a/1E3).toFixed(2)+"s"};
lib.TestManager.TestRun.prototype.summarize=function(){if(this.failures.length)for(var a=0;a<this.failures.length;a++)this.log.error("FAILED: "+this.failures[a].test.fullName);this.testQueue_.length&&this.log.warn("Test run incomplete: "+this.testQueue_.length+" test(s) were not run.")};lib.TestManager.Result=function(a,b,c){this.testRun=a;this.suite=b;this.test=c;this.duration=this.startDate=null;this.status=this.PENDING;this.expectedErrorMessage_=null};lib.TestManager.Result.prototype.PENDING="pending";
lib.TestManager.Result.prototype.FAILED="FAILED";lib.TestManager.Result.prototype.PASSED="passed";lib.TestManager.Result.TestComplete=function(a){this.result=a};lib.TestManager.Result.TestComplete.prototype.toString=function(){return"lib.TestManager.Result.TestComplete: "+this.result.test.fullName+", status: "+this.result.status};
lib.TestManager.Result.prototype.run=function(){this.startDate=new Date;this.test.run(this);this.status!=this.PENDING||this.timeout_||(this.println("Test did not return a value and did not request more time."),this.completeTest_(this.FAILED,!1))};lib.TestManager.Result.prototype.expectErrorMessage=function(a){this.expectedErrorMessage_=a};
lib.TestManager.Result.prototype.onTimeout_=function(){this.timeout_=null;this.status==this.PENDING&&(this.println("Test timed out."),this.completeTest_(this.FAILED,!1))};lib.TestManager.Result.prototype.requestTime=function(a){this.timeout_&&clearTimeout(this.timeout_);this.timeout_=setTimeout(this.onTimeout_.bind(this),a)};
lib.TestManager.Result.prototype.completeTest_=function(a,b){if(this.status==this.PENDING)this.duration=new Date-this.startDate,this.status=a,this.testRun.onResultComplete(this);else this.testRun.onResultReComplete(this,a);if(2>arguments.length||b)throw new lib.TestManager.Result.TestComplete(this);};
lib.TestManager.Result.prototype.assertEQ=function(a,b,c){function d(a){if("number"==typeof a)return a;a=String(a).split("\n").map(function(a){return JSON.stringify(a)});return 1<a.length?"\n"+a.join("\n"):a.join("\n")}a!==b&&(b instanceof Array&&lib.array.compare(a,b)||this.fail("assertEQ"+(c?"["+c+"]":"")+": "+this.getCallerLocation_(1)+": "+d(a)+" !== "+d(b)))};
lib.TestManager.Result.prototype.assert=function(a,b){!0!==a&&this.fail("assert"+(b?"["+b+"]":"")+": "+this.getCallerLocation_(1)+": "+String(a))};lib.TestManager.Result.prototype.getCallerLocation_=function(a){try{throw Error();}catch(b){return(a=b.stack.split("\n")[a+2].match(/([^/]+:\d+):\d+\)?$/))?a[1]:"???"}};lib.TestManager.Result.prototype.println=function(a){this.testRun.log.info(a)};
lib.TestManager.Result.prototype.fail=function(a){arguments.length&&this.println(a);this.completeTest_(this.FAILED,!0)};lib.TestManager.Result.prototype.pass=function(){this.completeTest_(this.PASSED,!0)};"use strict";lib.UTF8Decoder=function(){this.lowerBound=this.codePoint=this.bytesLeft=0};
lib.UTF8Decoder.prototype.decode=function(a){for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);0==this.bytesLeft?127>=d?b+=a.charAt(c):192<=d&&223>=d?(this.codePoint=d-192,this.bytesLeft=1,this.lowerBound=128):224<=d&&239>=d?(this.codePoint=d-224,this.bytesLeft=2,this.lowerBound=2048):240<=d&&247>=d?(this.codePoint=d-240,this.bytesLeft=3,this.lowerBound=65536):248<=d&&251>=d?(this.codePoint=d-248,this.bytesLeft=4,this.lowerBound=2097152):252<=d&&253>=d?(this.codePoint=d-252,this.bytesLeft=5,
this.lowerBound=67108864):b+="\ufffd":128<=d&&191>=d?(this.bytesLeft--,this.codePoint=(this.codePoint<<6)+(d-128),0==this.bytesLeft&&(d=this.codePoint,d<this.lowerBound||55296<=d&&57343>=d||1114111<d?b+="\ufffd":65536>d?b+=String.fromCharCode(d):(d-=65536,b+=String.fromCharCode(55296+(d>>>10&1023),56320+(d&1023))))):(b+="\ufffd",this.bytesLeft=0,c--)}return b};lib.decodeUTF8=function(a){return(new lib.UTF8Decoder).decode(a)};
lib.encodeUTF8=function(a){for(var b="",c=0;c<a.length;c++){var d=a.charCodeAt(c);if(56320<=d&&57343>=d)d=65533;else if(55296<=d&&56319>=d)if(c+1<a.length){var e=a.charCodeAt(c+1);56320<=e&&57343>=e?(d=65536+((d&1023)<<10)+(e&1023),c++):d=65533}else d=65533;if(127>=d)b+=a.charAt(c);else for(2047>=d?(b+=String.fromCharCode(192|d>>>6),e=1):65535>=d?(b+=String.fromCharCode(224|d>>>12),e=2):(b+=String.fromCharCode(240|d>>>18),e=3);0<e;)e--,b+=String.fromCharCode(128|d>>>6*e&63)}return b};"use strict";
lib.wc={};lib.wc.nulWidth=0;lib.wc.controlWidth=0;lib.wc.regardCjkAmbiguous=!1;lib.wc.cjkAmbiguousWidth=2;
lib.wc.combining=[[173,173],[768,879],[1155,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1552,1562],[1564,1564],[1611,1631],[1648,1648],[1750,1756],[1759,1764],[1767,1768],[1770,1773],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2070,2073],[2075,2083],[2085,2087],[2089,2093],[2137,2139],[2260,2273],[2275,2306],[2362,2362],[2364,2364],[2369,2376],[2381,2381],[2385,2391],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],
[2631,2632],[2635,2637],[2641,2641],[2672,2673],[2677,2677],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2810,2815],[2817,2817],[2876,2876],[2879,2879],[2881,2884],[2893,2893],[2902,2902],[2914,2915],[2946,2946],[3008,3008],[3021,3021],[3072,3072],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3170,3171],[3201,3201],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3328,3329],[3387,3388],[3393,3396],[3405,3405],[3426,3427],[3530,3530],[3538,3540],[3542,3542],
[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3981,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4151],[4153,4154],[4157,4158],[4184,4185],[4190,4192],[4209,4212],[4226,4226],[4229,4230],[4237,4237],[4253,4253],[4448,4607],[4957,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6158],[6277,6278],[6313,6313],
[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6683,6683],[6742,6742],[6744,6750],[6752,6752],[6754,6754],[6757,6764],[6771,6780],[6783,6783],[6832,6846],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7040,7041],[7074,7077],[7080,7081],[7083,7085],[7142,7142],[7144,7145],[7149,7149],[7151,7153],[7212,7219],[7222,7223],[7376,7378],[7380,7392],[7394,7400],[7405,7405],[7412,7412],[7416,7417],[7616,7673],[7675,7679],[8203,8207],[8234,8238],[8288,8292],[8294,8303],
[8400,8432],[11503,11505],[11647,11647],[11744,11775],[12330,12333],[12441,12442],[42607,42610],[42612,42621],[42654,42655],[42736,42737],[43010,43010],[43014,43014],[43019,43019],[43045,43046],[43204,43205],[43232,43249],[43302,43309],[43335,43345],[43392,43394],[43443,43443],[43446,43449],[43452,43452],[43493,43493],[43561,43566],[43569,43570],[43573,43574],[43587,43587],[43596,43596],[43644,43644],[43696,43696],[43698,43700],[43703,43704],[43710,43711],[43713,43713],[43756,43757],[43766,43766],
[44005,44005],[44008,44008],[44013,44013],[64286,64286],[65024,65039],[65056,65071],[65279,65279],[65529,65531],[66045,66045],[66272,66272],[66422,66426],[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[68325,68326],[69633,69633],[69688,69702],[69759,69761],[69811,69814],[69817,69818],[69888,69890],[69927,69931],[69933,69940],[70003,70003],[70016,70017],[70070,70078],[70090,70092],[70191,70193],[70196,70196],[70198,70199],[70206,70206],[70367,70367],[70371,70378],[70400,70401],
[70460,70460],[70464,70464],[70502,70508],[70512,70516],[70712,70719],[70722,70724],[70726,70726],[70835,70840],[70842,70842],[70847,70848],[70850,70851],[71090,71093],[71100,71101],[71103,71104],[71132,71133],[71219,71226],[71229,71229],[71231,71232],[71339,71339],[71341,71341],[71344,71349],[71351,71351],[71453,71455],[71458,71461],[71463,71467],[72193,72198],[72201,72202],[72243,72248],[72251,72254],[72263,72263],[72273,72278],[72281,72283],[72330,72342],[72344,72345],[72752,72758],[72760,72765],
[72767,72767],[72850,72871],[72874,72880],[72882,72883],[72885,72886],[73009,73014],[73018,73018],[73020,73021],[73023,73029],[73031,73031],[92912,92916],[92976,92982],[94095,94098],[113821,113822],[113824,113827],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[121344,121398],[121403,121452],[121461,121461],[121476,121476],[121499,121503],[121505,121519],[122880,122886],[122888,122904],[122907,122913],[122915,122916],[122918,122922],[125136,125142],[125252,125258],
[917505,917505],[917536,917631],[917760,917999]];
lib.wc.ambiguous=[[161,161],[164,164],[167,168],[170,170],[173,174],[176,180],[182,186],[188,191],[198,198],[208,208],[215,216],[222,225],[230,230],[232,234],[236,237],[240,240],[242,243],[247,250],[252,252],[254,254],[257,257],[273,273],[275,275],[283,283],[294,295],[299,299],[305,307],[312,312],[319,322],[324,324],[328,331],[333,333],[338,339],[358,359],[363,363],[462,462],[464,464],[466,466],[468,468],[470,470],[472,472],[474,474],[476,476],[593,593],[609,609],[708,708],[711,711],[713,715],[717,
717],[720,720],[728,731],[733,733],[735,735],[768,879],[913,929],[931,937],[945,961],[963,969],[1025,1025],[1040,1103],[1105,1105],[4352,4447],[8208,8208],[8211,8214],[8216,8217],[8220,8221],[8224,8226],[8228,8231],[8240,8240],[8242,8243],[8245,8245],[8251,8251],[8254,8254],[8308,8308],[8319,8319],[8321,8324],[8364,8364],[8451,8451],[8453,8453],[8457,8457],[8467,8467],[8470,8470],[8481,8482],[8486,8486],[8491,8491],[8531,8532],[8539,8542],[8544,8555],[8560,8569],[8585,8585],[8592,8601],[8632,8633],
[8658,8658],[8660,8660],[8679,8679],[8704,8704],[8706,8707],[8711,8712],[8715,8715],[8719,8719],[8721,8721],[8725,8725],[8730,8730],[8733,8736],[8739,8739],[8741,8741],[8743,8748],[8750,8750],[8756,8759],[8764,8765],[8776,8776],[8780,8780],[8786,8786],[8800,8801],[8804,8807],[8810,8811],[8814,8815],[8834,8835],[8838,8839],[8853,8853],[8857,8857],[8869,8869],[8895,8895],[8978,8978],[8986,8987],[9001,9002],[9193,9196],[9200,9200],[9203,9203],[9312,9449],[9451,9547],[9552,9587],[9600,9615],[9618,9621],
[9632,9633],[9635,9641],[9650,9651],[9654,9655],[9660,9661],[9664,9665],[9670,9672],[9675,9675],[9678,9681],[9698,9701],[9711,9711],[9725,9726],[9733,9734],[9737,9737],[9742,9743],[9748,9749],[9756,9756],[9758,9758],[9792,9792],[9794,9794],[9800,9811],[9824,9825],[9827,9829],[9831,9834],[9836,9837],[9839,9839],[9855,9855],[9875,9875],[9886,9887],[9889,9889],[9898,9899],[9917,9919],[9924,9953],[9955,9955],[9960,9983],[9989,9989],[9994,9995],[10024,10024],[10045,10045],[10060,10060],[10062,10062],[10067,
10069],[10071,10071],[10102,10111],[10133,10135],[10160,10160],[10175,10175],[11035,11036],[11088,11088],[11093,11097],[11904,12255],[12272,12350],[12352,19903],[19968,42191],[43360,43391],[44032,55203],[57344,64255],[65024,65049],[65072,65135],[65281,65376],[65504,65510],[65533,65533],[94176,94177],[94208,101119],[110592,110895],[110960,111359],[126980,126980],[127183,127183],[127232,127242],[127248,127277],[127280,127337],[127344,127404],[127488,127490],[127504,127547],[127552,127560],[127568,127569],
[127584,127589],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],[127988,127988],[127992,128062],[128064,128064],[128066,128252],[128255,128317],[128331,128334],[128336,128359],[128378,128378],[128405,128406],[128420,128420],[128507,128591],[128640,128709],[128716,128716],[128720,128722],[128747,128748],[128756,128760],[129296,129342],[129344,129356],[129360,129387],[129408,129431],[129472,129472],[129488,129510],[131072,196605],[196608,
262141],[917760,917999],[983040,1048573],[1048576,1114109]];
lib.wc.unambiguous=[[4352,4447],[8986,8987],[9001,9002],[9193,9196],[9200,9200],[9203,9203],[9725,9726],[9748,9749],[9800,9811],[9855,9855],[9875,9875],[9889,9889],[9898,9899],[9917,9918],[9924,9925],[9934,9934],[9940,9940],[9962,9962],[9970,9971],[9973,9973],[9978,9978],[9981,9981],[9989,9989],[9994,9995],[10024,10024],[10060,10060],[10062,10062],[10067,10069],[10071,10071],[10133,10135],[10160,10160],[10175,10175],[11035,11036],[11088,11088],[11093,11093],[11904,12255],[12272,12350],[12352,12871],
[12880,19903],[19968,42191],[43360,43391],[44032,55203],[63744,64255],[65040,65049],[65072,65135],[65281,65376],[65504,65510],[94176,94177],[94208,101119],[110592,110895],[110960,111359],[126980,126980],[127183,127183],[127374,127374],[127377,127386],[127488,127490],[127504,127547],[127552,127560],[127568,127569],[127584,127589],[127744,127776],[127789,127797],[127799,127868],[127870,127891],[127904,127946],[127951,127955],[127968,127984],[127988,127988],[127992,128062],[128064,128064],[128066,128252],
[128255,128317],[128331,128334],[128336,128359],[128378,128378],[128405,128406],[128420,128420],[128507,128591],[128640,128709],[128716,128716],[128720,128722],[128747,128748],[128756,128760],[129296,129342],[129344,129356],[129360,129387],[129408,129431],[129472,129472],[129488,129510],[131072,196605],[196608,262141]];lib.wc.binaryTableSearch_=function(a,b){var c=0,d=b.length-1;if(a<b[c][0]||a>b[d][1])return!1;for(;d>=c;){var e=Math.floor((c+d)/2);if(a>b[e][1])c=e+1;else if(a<b[e][0])d=e-1;else return!0}return!1};
lib.wc.isSpace=function(a){return lib.wc.binaryTableSearch_(a,lib.wc.combining)};lib.wc.isCjkAmbiguous=function(a){return lib.wc.binaryTableSearch_(a,lib.wc.ambiguous)};lib.wc.charWidth=function(a){return lib.wc.regardCjkAmbiguous?lib.wc.charWidthRegardAmbiguous(a):lib.wc.charWidthDisregardAmbiguous(a)};
lib.wc.charWidthDisregardAmbiguous=function(a){return 127>a?32<=a?1:0==a?lib.wc.nulWidth:lib.wc.controlWidth:160>a?lib.wc.controlWidth:lib.wc.isSpace(a)?0:lib.wc.binaryTableSearch_(a,lib.wc.unambiguous)?2:1};lib.wc.charWidthRegardAmbiguous=function(a){return lib.wc.isCjkAmbiguous(a)?lib.wc.cjkAmbiguousWidth:lib.wc.charWidthDisregardAmbiguous(a)};lib.wc.strWidth=function(a){for(var b,c=0,d=0;d<a.length;){var e=a.codePointAt(d);b=lib.wc.charWidth(e);if(0>b)return-1;c+=b;d+=65535>=e?1:2}return c};
lib.wc.substr=function(a,b,c){var d=0,e;if(b)for(e=0;d<a.length;){var g=a.codePointAt(d);e+=lib.wc.charWidth(g);if(e>b)break;d+=65535>=g?1:2}if(void 0!=c){b=d;for(e=0;b<a.length;){g=a.codePointAt(b);e+=lib.wc.charWidth(g);if(e>c)break;b+=65535>=g?1:2}return a.substring(d,b)}return a.substr(d)};lib.wc.substring=function(a,b,c){return lib.wc.substr(a,b,c-b)};lib.resource.add("libdot/changelog/version","text/plain","1.21");lib.resource.add("libdot/changelog/date","text/plain","2018-01-05");
lib.resource.add("hterm/audio/bell","audio/ogg;base64","base64  --  Encode/decode file as base64.  Call:            base64 [-e / -d] [options] [infile] [outfile]Options:           --copyright       Print copyright information           -d, --decode      Decode base64 encoded file           -e, --encode      Encode file into base64           -n, --noerrcheck  Ignore errors when decoding           -u, --help        Print this message           --version         Print version numberby John Walkerhttp://www.fourmilab.ch/");
lib.resource.add("hterm/images/icon-96","image/png;base64","base64  --  Encode/decode file as base64.  Call:            base64 [-e / -d] [options] [infile] [outfile]Options:           --copyright       Print copyright information           -d, --decode      Decode base64 encoded file           -e, --encode      Encode file into base64           -n, --noerrcheck  Ignore errors when decoding           -u, --help        Print this message           --version         Print version numberby John Walkerhttp://www.fourmilab.ch/");
lib.resource.add("hterm/concat/date","text/plain","Fri, 02 Feb 2018 11:09:26 +0000");lib.resource.add("hterm/changelog/version","text/plain","1.78");lib.resource.add("hterm/changelog/date","text/plain","2018-01-29");lib.resource.add("hterm/git/HEAD","text/plain","a8d402c0d12b1a88186cedaab208a91ce9f261f8");"use strict";lib.rtdep("lib.Storage");
var hterm={windowType:null,os:null,zoomWarningMessage:"ZOOM != 100%",notifyCopyMessage:"\u2702",desktopNotificationTitle:"\u266a %(title) \u266a",testDeps:["hterm.ScrollPort.Tests","hterm.Screen.Tests","hterm.Terminal.Tests","hterm.VT.Tests","hterm.VT.CannedTests"]};
lib.registerInit("hterm",function(a){function b(b){hterm.os=b;a()}function c(){lib.f.getAcceptLanguages(function(a){hterm.messageManager||(hterm.messageManager=new lib.MessageManager(a));lib.f.getOs().then(b).catch(b)})}function d(a){hterm.windowType=a.type;c()}function e(a){a&&window.chrome?chrome.windows.get(a.windowId,null,d):(hterm.windowType="normal",c())}hterm.defaultStorage||(hterm.defaultStorage=window.chrome&&chrome.storage&&chrome.storage.sync?new lib.Storage.Chrome(chrome.storage.sync):
new lib.Storage.Local);var g=!1;window.chrome&&chrome.runtime&&chrome.runtime.getManifest&&(g=chrome.runtime.getManifest(),g=g.app&&g.app.background);g?setTimeout(d.bind(null,{type:"popup"}),0):window.chrome&&chrome.tabs?chrome.tabs.getCurrent(e):setTimeout(d.bind(null,{type:"normal"}),0)});hterm.getClientSize=function(a){return a.getBoundingClientRect()};hterm.getClientWidth=function(a){return a.getBoundingClientRect().width};hterm.getClientHeight=function(a){return a.getBoundingClientRect().height};
hterm.copySelectionToClipboard=function(a){try{a.execCommand("copy")}catch(b){}};hterm.pasteFromClipboard=function(a){try{return a.execCommand("paste")}catch(b){return!1}};hterm.msg=function(a,b,c){b=void 0===b?[]:b;return hterm.messageManager.get("HTERM_"+a,b,c)};
hterm.notify=function(a){var b=function(a,b){return void 0!==a?a:b};if(void 0===a||null===a)a={};var c={body:a.body,icon:b(a.icon,lib.resource.getDataUrl("hterm/images/icon-96"))};(a=b(a.title,window.document.title))||(a="hterm");a=lib.f.replaceVars(hterm.desktopNotificationTitle,{title:a});c=new Notification(a,c);c.onclick=function(){window.focus();this.close()};return c};
hterm.openUrl=function(a){window.chrome&&chrome.browser&&chrome.browser.openTab?chrome.browser.openTab({url:a}):window.open(a,"_blank").focus()};hterm.Size=function(a,b){this.width=a;this.height=b};hterm.Size.prototype.resize=function(a,b){this.width=a;this.height=b};hterm.Size.prototype.clone=function(){return new hterm.Size(this.width,this.height)};hterm.Size.prototype.setTo=function(a){this.width=a.width;this.height=a.height};
hterm.Size.prototype.equals=function(a){return this.width==a.width&&this.height==a.height};hterm.Size.prototype.toString=function(){return"[hterm.Size: "+this.width+", "+this.height+"]"};hterm.RowCol=function(a,b,c){this.row=a;this.column=b;this.overflow=!!c};hterm.RowCol.prototype.move=function(a,b,c){this.row=a;this.column=b;this.overflow=!!c};hterm.RowCol.prototype.clone=function(){return new hterm.RowCol(this.row,this.column,this.overflow)};
hterm.RowCol.prototype.setTo=function(a){this.row=a.row;this.column=a.column;this.overflow=a.overflow};hterm.RowCol.prototype.equals=function(a){return this.row==a.row&&this.column==a.column&&this.overflow==a.overflow};hterm.RowCol.prototype.toString=function(){return"[hterm.RowCol: "+this.row+", "+this.column+", "+this.overflow+"]"};"use strict";lib.rtdep("lib.f");
hterm.Frame=function(a,b,c){this.terminal_=a;this.div_=a.div_;this.url=b;this.options=c||{};this.messageChannel_=this.container_=this.iframe_=null};hterm.Frame.prototype.onMessage_=function(a){switch(a.data.name){case "ipc-init-ok":this.sendTerminalInfo_();break;case "terminal-info-ok":this.container_.style.display="flex";this.postMessage("visible");this.messageChannel_.port1.onmessage=this.onMessage.bind(this);this.onLoad();break;default:console.log("Unknown message from frame:",a.data)}};
hterm.Frame.prototype.onMessage=function(){};hterm.Frame.prototype.onLoad_=function(){this.messageChannel_=new MessageChannel;this.messageChannel_.port1.onmessage=this.onMessage_.bind(this);this.messageChannel_.port1.start();this.iframe_.contentWindow.postMessage({name:"ipc-init",argv:[{messagePort:this.messageChannel_.port2}]},this.url,[this.messageChannel_.port2])};hterm.Frame.prototype.onLoad=function(){};
hterm.Frame.prototype.sendTerminalInfo_=function(){lib.f.getAcceptLanguages(function(a){this.postMessage("terminal-info",[{acceptLanguages:a,foregroundColor:this.terminal_.getForegroundColor(),backgroundColor:this.terminal_.getBackgroundColor(),cursorColor:this.terminal_.getCursorColor(),fontSize:this.terminal_.getFontSize(),fontFamily:this.terminal_.getFontFamily(),baseURL:lib.f.getURL("/")}])}.bind(this))};hterm.Frame.prototype.onCloseClicked_=function(){this.close()};
hterm.Frame.prototype.close=function(){this.container_&&this.container_.parentNode&&(this.container_.parentNode.removeChild(this.container_),this.onClose())};hterm.Frame.prototype.onClose=function(){};hterm.Frame.prototype.postMessage=function(a,b){if(!this.messageChannel_)throw Error("Message channel is not set up.");this.messageChannel_.port1.postMessage({name:a,argv:b})};
hterm.Frame.prototype.show=function(){function a(a,c){return a in b.options?b.options[a]:c}var b=this;b=this;if(this.container_&&this.container_.parentNode)console.error("Frame already visible");else{hterm.getClientSize(this.div_);a("width",640);a("height",480);var c=this.terminal_.document_,d=this.container_=c.createElement("div");d.style.cssText="position: absolute;display: none;flex-direction: column;top: 10%;left: 4%;width: 90%;height: 80%;min-height: 20%;max-height: 80%;box-shadow: 0 0 2px "+
this.terminal_.getForegroundColor()+";border: 2px "+this.terminal_.getForegroundColor()+" solid;";c=this.iframe_=c.createElement("iframe");c.onload=this.onLoad_.bind(this);c.style.cssText="display: flex;flex: 1;width: 100%";c.setAttribute("src",this.url);c.setAttribute("seamless",!0);d.appendChild(c);this.div_.appendChild(d)}};"use strict";lib.rtdep("hterm.Keyboard.KeyMap");
hterm.Keyboard=function(a){this.terminal=a;this.keyboardElement_=null;this.handlers_=[["focusout",this.onFocusOut_.bind(this)],["keydown",this.onKeyDown_.bind(this)],["keypress",this.onKeyPress_.bind(this)],["keyup",this.onKeyUp_.bind(this)],["textInput",this.onTextInput_.bind(this)]];this.keyMap=new hterm.Keyboard.KeyMap(this);this.bindings=new hterm.Keyboard.Bindings(this);this.altGrMode="none";this.shiftInsertPaste=!0;this.pageKeysScroll=this.homeKeysScroll=!1;this.ctrlPlusMinusZeroZoom=!0;this.backspaceSendsBackspace=
this.applicationCursor=this.applicationKeypad=this.ctrlVPaste=this.ctrlCCopy=!1;this.characterEncoding="utf-8";this.passMetaV=this.metaSendsEscape=!0;this.altSendsWhat="escape";this.altBackspaceIsMetaBackspace=this.altIsMeta=!1;this.altKeyPressed=0;this.mediaKeysAreFKeys=!1;this.previousAltSendsWhat_=null};hterm.Keyboard.KeyActions={CANCEL:lib.f.createEnum("CANCEL"),DEFAULT:lib.f.createEnum("DEFAULT"),PASS:lib.f.createEnum("PASS"),STRIP:lib.f.createEnum("STRIP")};
hterm.Keyboard.prototype.encode=function(a){return"utf-8"==this.characterEncoding?this.terminal.vt.encodeUTF8(a):a};hterm.Keyboard.prototype.installKeyboard=function(a){if(a!=this.keyboardElement_){a&&this.keyboardElement_&&this.installKeyboard(null);for(var b=0;b<this.handlers_.length;b++){var c=this.handlers_[b];a?a.addEventListener(c[0],c[1]):this.keyboardElement_.removeEventListener(c[0],c[1])}this.keyboardElement_=a}};hterm.Keyboard.prototype.uninstallKeyboard=function(){this.installKeyboard(null)};
hterm.Keyboard.prototype.onTextInput_=function(a){if(a.data)this.terminal.onVTKeystroke(a.data)};hterm.Keyboard.prototype.onKeyPress_=function(a){var b=String.fromCharCode(a.which).toLowerCase();if(!a.ctrlKey&&!a.metaKey||"c"!=b&&"v"!=b){if(a.altKey&&"browser-key"==this.altSendsWhat&&0==a.charCode){var c=String.fromCharCode(a.keyCode);a.shiftKey||(c=c.toLowerCase());c.charCodeAt(0)}else 32<=a.charCode&&(c=a.charCode);if(c)this.terminal.onVTKeystroke(String.fromCharCode(c));a.preventDefault();a.stopPropagation()}};
hterm.Keyboard.prototype.preventChromeAppNonCtrlShiftDefault_=function(a){window.chrome&&window.chrome.app&&window.chrome.app.window&&(a.ctrlKey&&a.shiftKey||a.preventDefault())};hterm.Keyboard.prototype.onFocusOut_=function(a){this.altKeyPressed=0};hterm.Keyboard.prototype.onKeyUp_=function(a){18==a.keyCode&&(this.altKeyPressed&=~(1<<a.location-1));27==a.keyCode&&this.preventChromeAppNonCtrlShiftDefault_(a)};
hterm.Keyboard.prototype.onKeyDown_=function(a){function b(f){d=f;var g=c[f];"function"==typeof g&&(g=g.apply(e.keyMap,[a,c]));g===h&&"normal"!=f&&(g=b("normal"));return g}18==a.keyCode&&(this.altKeyPressed|=1<<a.location-1);27==a.keyCode&&this.preventChromeAppNonCtrlShiftDefault_(a);var c=this.keyMap.keyDefs[a.keyCode];c||(console.warn("No definition for key "+a.key+" (keyCode "+a.keyCode+")"),c=this.keyMap.keyDefs[0],this.keyMap.addKeyDef(a.keyCode,c));var d=null,e=this,g=hterm.Keyboard.KeyActions.CANCEL,
h=hterm.Keyboard.KeyActions.DEFAULT,l=hterm.Keyboard.KeyActions.PASS,n=hterm.Keyboard.KeyActions.STRIP,m=a.ctrlKey,p=this.altIsMeta?!1:a.altKey,f=this.altIsMeta?a.altKey||a.metaKey:a.metaKey,k=!/^\[\w+\]$/.test(c.keyCap);switch(this.altGrMode){case "ctrl-alt":k&&m&&p&&(p=m=!1);break;case "right-alt":k&&this.terminal.keyboard.altKeyPressed&2&&(p=m=!1);break;case "left-alt":k&&this.terminal.keyboard.altKeyPressed&1&&(p=m=!1)}k=m?b("control"):p?b("alt"):f?b("meta"):b("normal");var q=!a.maskShiftKey&&
a.shiftKey,t={keyCode:a.keyCode,shift:a.shiftKey,ctrl:m,alt:p,meta:f},r=this.bindings.getBinding(t);r&&(q=m=p=f=!1,d="normal",k=r.action,"function"==typeof k&&(k=k.call(this,this.terminal,t)));p&&"browser-key"==this.altSendsWhat&&k==h&&(k=l);if(k!==l&&(k!==h||m||p||f)&&(k===n&&(p=m=!1,k=c.normal,"function"==typeof k&&(k=k.apply(this.keyMap,[a,c])),k==h&&2==c.keyCap.length&&(k=c.keyCap.substr(q?1:0,1))),a.preventDefault(),a.stopPropagation(),k!==g))if(k!==h&&"string"!=typeof k)console.warn("Invalid action: "+
JSON.stringify(k));else{"control"==d?m=!1:"alt"==d?p=!1:"meta"==d&&(f=!1);if("\u001b["==k.substr(0,2)&&(p||m||q||f))g=1,q&&(g+=1),p&&(g+=2),m&&(g+=4),f&&(g+=8),p=";"+g,k=3==k.length?"\u001b[1"+p+k.substr(2,1):k.substr(0,k.length-1)+p+k.substr(k.length-1);else if(k===h&&(k=c.keyCap.substr(q?1:0,1),m&&(m=c.keyCap.substr(0,1).charCodeAt(0),64<=m&&95>=m&&(k=String.fromCharCode(m-64)))),p&&"8-bit"==this.altSendsWhat&&1==k.length&&(m=k.charCodeAt(0)+128,k=String.fromCharCode(m)),p&&"escape"==this.altSendsWhat||
f&&this.metaSendsEscape)k="\u001b"+k;this.terminal.onVTKeystroke(k)}};"use strict";hterm.Keyboard.Bindings=function(){this.bindings_={}};hterm.Keyboard.Bindings.prototype.clear=function(){this.bindings_={}};
hterm.Keyboard.Bindings.prototype.addBinding_=function(a,b){var c=null,d=this.bindings_[a.keyCode];if(d)for(var e=0;e<d.length;e++)if(d[e].keyPattern.matchKeyPattern(a)){c=d[e];break}c?c.action=b:(c={keyPattern:a,action:b},d?(this.bindings_[a.keyCode].push(c),d.sort(function(a,b){return hterm.Keyboard.KeyPattern.sortCompare(a.keyPattern,b.keyPattern)})):this.bindings_[a.keyCode]=[c])};
hterm.Keyboard.Bindings.prototype.addBinding=function(a,b){if("string"!=typeof a)this.addBinding_(a,b);else{var c=new hterm.Parser;c.reset(a);try{var d=c.parseKeySequence()}catch(e){console.error(e);return}if(c.isComplete()){if("string"==typeof b){c.reset(b);try{b=c.parseKeyAction()}catch(e){console.error(e);return}}c.isComplete()?this.addBinding_(new hterm.Keyboard.KeyPattern(d),b):console.error(c.error("Expected end of sequence: "+d))}else console.error(c.error("Expected end of sequence: "+d))}};
hterm.Keyboard.Bindings.prototype.addBindings=function(a){for(var b in a)this.addBinding(b,a[b])};hterm.Keyboard.Bindings.prototype.getBinding=function(a){var b=this.bindings_[a.keyCode];if(!b)return null;for(var c=0;c<b.length;c++){var d=b[c];if(d.keyPattern.matchKeyDown(a))return d}return null};"use strict";lib.rtdep("hterm.Keyboard.KeyActions");hterm.Keyboard.KeyMap=function(a){this.keyboard=a;this.keyDefs={};this.reset()};
hterm.Keyboard.KeyMap.prototype.addKeyDef=function(a,b){a in this.keyDefs&&console.warn("Duplicate keyCode: "+a);this.keyDefs[a]=b};hterm.Keyboard.KeyMap.prototype.addKeyDefs=function(a){for(var b=0;b<arguments.length;b++)this.addKeyDef(arguments[b][0],{keyCap:arguments[b][1],normal:arguments[b][2],control:arguments[b][3],alt:arguments[b][4],meta:arguments[b][5]})};
hterm.Keyboard.KeyMap.prototype.reset=function(){function a(a,b,c){return"function"==typeof a?a.apply(m,[b,c]):a}function b(b,c){return function(d,e){return a(d.shiftKey||d.ctrlKey||d.altKey||d.metaKey||!m.keyboard.applicationCursor?b:c,d,e)}}function c(b,c){return function(d,e){return a(m.keyboard.backspaceSendsBackspace?c:b,d,e)}}function d(b,c){return function(d,e){var f=d.shiftKey?c:b;d.maskShiftKey=!0;return a(f,d,e)}}function e(b,c){return function(d,e){return a(d.altKey?c:b,d,e)}}function g(b,
c){return function(d,e){return a(d.shiftKey||d.ctrlKey||d.altKey||d.metaKey?c:b,d,e)}}function h(a){return String.fromCharCode(a.charCodeAt(0)-64)}function l(a){return function(b,c){return this[a](b,c)}}function n(b){return function(c,d){return m.keyboard.mediaKeysAreFKeys?a(b,c,d):166==c.keyCode||167==c.keyCode||168==c.keyCode?hterm.Keyboard.KeyActions.CANCEL:hterm.Keyboard.KeyActions.PASS}}this.keyDefs={};var m=this,p=hterm.Keyboard.KeyActions.CANCEL,f=hterm.Keyboard.KeyActions.DEFAULT,k=hterm.Keyboard.KeyActions.PASS,
q=hterm.Keyboard.KeyActions.STRIP;this.addKeyDefs([0,"[UNKNOWN]",k,k,k,k],[27,"[ESC]","\u001b",f,f,f],[112,"[F1]",g("\u001bOP","\u001b[P"),f,"\u001b[23~",f],[113,"[F2]",g("\u001bOQ","\u001b[Q"),f,"\u001b[24~",f],[114,"[F3]",g("\u001bOR","\u001b[R"),f,"\u001b[25~",f],[115,"[F4]",g("\u001bOS","\u001b[S"),f,"\u001b[26~",f],[116,"[F5]","\u001b[15~",f,"\u001b[28~",f],[117,"[F6]","\u001b[17~",f,"\u001b[29~",f],[118,"[F7]","\u001b[18~",f,"\u001b[31~",f],[119,"[F8]","\u001b[19~",f,"\u001b[32~",f],[120,"[F9]",
"\u001b[20~",f,"\u001b[33~",f],[121,"[F10]","\u001b[21~",f,"\u001b[34~",f],[122,"[F11]",l("onF11_"),f,"\u001b[42~",f],[123,"[F12]","\u001b[24~",f,"\u001b[43~",f],[192,"`~",f,d(h("@"),h("^")),f,k],[49,"1!",f,l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[50,"2@",f,l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[51,"3#",f,l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[52,"4$",f,l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[53,"5%",f,l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[54,"6^",f,
l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[55,"7&",f,l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[56,"8*",f,l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[57,"9(",f,l("onCtrlNum_"),l("onAltNum_"),l("onMetaNum_")],[48,"0)",f,l("onPlusMinusZero_"),l("onAltNum_"),l("onPlusMinusZero_")],[189,"-_",f,l("onPlusMinusZero_"),f,l("onPlusMinusZero_")],[187,"=+",f,l("onPlusMinusZero_"),f,l("onPlusMinusZero_")],[173,"-_",f,l("onPlusMinusZero_"),f,l("onPlusMinusZero_")],[61,"=+",f,l("onPlusMinusZero_"),
f,l("onPlusMinusZero_")],[171,"+*",f,l("onPlusMinusZero_"),f,l("onPlusMinusZero_")],[8,"[BKSP]",c("\u007f","\b"),c("\b","\u007f"),f,f],[9,"[TAB]",d("\t","\u001b[Z"),q,k,f],[81,"qQ",f,h("Q"),f,f],[87,"wW",f,h("W"),f,f],[69,"eE",f,h("E"),f,f],[82,"rR",f,h("R"),f,f],[84,"tT",f,h("T"),f,f],[89,"yY",f,h("Y"),f,f],[85,"uU",f,h("U"),f,f],[73,"iI",f,h("I"),f,f],[79,"oO",f,h("O"),f,f],[80,"pP",f,h("P"),f,f],[219,"[{",f,h("["),f,f],[221,"]}",f,h("]"),f,f],[220,"\\|",f,h("\\"),f,f],[20,"[CAPS]",k,k,k,f],[65,
"aA",f,h("A"),f,f],[83,"sS",f,h("S"),f,f],[68,"dD",f,h("D"),f,f],[70,"fF",f,h("F"),f,f],[71,"gG",f,h("G"),f,f],[72,"hH",f,h("H"),f,f],[74,"jJ",f,d(h("J"),k),f,f],[75,"kK",f,d(h("K"),l("onClear_")),f,f],[76,"lL",f,d(h("L"),k),f,f],[186,";:",f,q,f,f],[222,"'\"",f,q,f,f],[13,"[ENTER]","\r",p,p,f],[16,"[SHIFT]",k,k,k,f],[90,"zZ",f,h("Z"),f,f],[88,"xX",f,h("X"),f,f],[67,"cC",f,l("onCtrlC_"),f,l("onMetaC_")],[86,"vV",f,l("onCtrlV_"),f,l("onMetaV_")],[66,"bB",f,d(h("B"),k),f,d(f,k)],[78,"nN",f,l("onCtrlN_"),
f,l("onMetaN_")],[77,"mM",f,h("M"),f,f],[188,",<",f,e(q,k),f,f],[190,".>",f,e(q,k),f,f],[191,"/?",f,d(h("_"),h("?")),f,f],[17,"[CTRL]",k,k,k,k],[18,"[ALT]",k,k,k,k],[91,"[LAPL]",k,k,k,k],[32," ",f,h("@"),f,f],[92,"[RAPL]",k,k,k,k],[93,"[RMENU]",k,k,k,k],[42,"[PRTSCR]",k,k,k,k],[145,"[SCRLK]",k,k,k,k],[19,"[BREAK]",k,k,k,k],[45,"[INSERT]",l("onKeyInsert_"),f,f,f],[36,"[HOME]",l("onKeyHome_"),f,f,f],[33,"[PGUP]",l("onKeyPageUp_"),f,f,f],[46,"[DEL]",l("onKeyDel_"),f,f,f],[35,"[END]",l("onKeyEnd_"),f,
f,f],[34,"[PGDOWN]",l("onKeyPageDown_"),f,f,f],[38,"[UP]",l("onKeyArrowUp_"),f,f,f],[40,"[DOWN]",l("onKeyArrowDown_"),f,f,f],[39,"[RIGHT]",b("\u001b[C","\u001bOC"),f,f,f],[37,"[LEFT]",b("\u001b[D","\u001bOD"),f,f,f],[144,"[NUMLOCK]",k,k,k,k],[12,"[CLEAR]",k,k,k,k],[96,"[KP0]",f,f,f,f],[97,"[KP1]",f,f,f,f],[98,"[KP2]",f,f,f,f],[99,"[KP3]",f,f,f,f],[100,"[KP4]",f,f,f,f],[101,"[KP5]",f,f,f,f],[102,"[KP6]",f,f,f,f],[103,"[KP7]",f,f,f,f],[104,"[KP8]",f,f,f,f],[105,"[KP9]",f,f,f,f],[107,"[KP+]",f,l("onPlusMinusZero_"),
f,l("onPlusMinusZero_")],[109,"[KP-]",f,l("onPlusMinusZero_"),f,l("onPlusMinusZero_")],[106,"[KP*]",f,f,f,f],[111,"[KP/]",f,f,f,f],[110,"[KP.]",f,f,f,f],[166,"[BACK]",n(g("\u001bOP","\u001b[P")),f,"\u001b[23~",f],[167,"[FWD]",n(g("\u001bOQ","\u001b[Q")),f,"\u001b[24~",f],[168,"[RELOAD]",n(g("\u001bOR","\u001b[R")),f,"\u001b[25~",f],[183,"[FSCR]",n(g("\u001bOS","\u001b[S")),f,"\u001b[26~",f],[182,"[WINS]",n("\u001b[15~"),f,"\u001b[28~",f],[216,"[BRIT-]",n("\u001b[17~"),f,"\u001b[29~",f],[217,"[BRIT+]",
n("\u001b[18~"),f,"\u001b[31~",f])};hterm.Keyboard.KeyMap.prototype.onKeyInsert_=function(a){return this.keyboard.shiftInsertPaste&&a.shiftKey?hterm.Keyboard.KeyActions.PASS:"\u001b[2~"};hterm.Keyboard.KeyMap.prototype.onKeyHome_=function(a){if(!this.keyboard.homeKeysScroll^a.shiftKey)return a.altey||a.ctrlKey||a.shiftKey||!this.keyboard.applicationCursor?"\u001b[H":"\u001bOH";this.keyboard.terminal.scrollHome();return hterm.Keyboard.KeyActions.CANCEL};
hterm.Keyboard.KeyMap.prototype.onKeyEnd_=function(a){if(!this.keyboard.homeKeysScroll^a.shiftKey)return a.altKey||a.ctrlKey||a.shiftKey||!this.keyboard.applicationCursor?"\u001b[F":"\u001bOF";this.keyboard.terminal.scrollEnd();return hterm.Keyboard.KeyActions.CANCEL};hterm.Keyboard.KeyMap.prototype.onKeyPageUp_=function(a){if(!this.keyboard.pageKeysScroll^a.shiftKey)return"\u001b[5~";this.keyboard.terminal.scrollPageUp();return hterm.Keyboard.KeyActions.CANCEL};
hterm.Keyboard.KeyMap.prototype.onKeyDel_=function(a){return this.keyboard.altBackspaceIsMetaBackspace&&this.keyboard.altKeyPressed&&!a.altKey?"\u001b\u007f":"\u001b[3~"};hterm.Keyboard.KeyMap.prototype.onKeyPageDown_=function(a){if(!this.keyboard.pageKeysScroll^a.shiftKey)return"\u001b[6~";this.keyboard.terminal.scrollPageDown();return hterm.Keyboard.KeyActions.CANCEL};
hterm.Keyboard.KeyMap.prototype.onKeyArrowUp_=function(a){return!this.keyboard.applicationCursor&&a.shiftKey?(this.keyboard.terminal.scrollLineUp(),hterm.Keyboard.KeyActions.CANCEL):a.shiftKey||a.ctrlKey||a.altKey||a.metaKey||!this.keyboard.applicationCursor?"\u001b[A":"\u001bOA"};
hterm.Keyboard.KeyMap.prototype.onKeyArrowDown_=function(a){return!this.keyboard.applicationCursor&&a.shiftKey?(this.keyboard.terminal.scrollLineDown(),hterm.Keyboard.KeyActions.CANCEL):a.shiftKey||a.ctrlKey||a.altKey||a.metaKey||!this.keyboard.applicationCursor?"\u001b[B":"\u001bOB"};hterm.Keyboard.KeyMap.prototype.onClear_=function(a,b){this.keyboard.terminal.wipeContents();return hterm.Keyboard.KeyActions.CANCEL};
hterm.Keyboard.KeyMap.prototype.onF11_=function(a,b){return"popup"!=hterm.windowType?hterm.Keyboard.KeyActions.PASS:"\u001b[23~"};
hterm.Keyboard.KeyMap.prototype.onCtrlNum_=function(a,b){function c(a){return String.fromCharCode(a.charCodeAt(0)-64)}if(this.keyboard.terminal.passCtrlNumber&&!a.shiftKey)return hterm.Keyboard.KeyActions.PASS;switch(b.keyCap.substr(0,1)){case "1":return"1";case "2":return c("@");case "3":return c("[");case "4":return c("\\");case "5":return c("]");case "6":return c("^");case "7":return c("_");case "8":return"\u007f";case "9":return"9"}};
hterm.Keyboard.KeyMap.prototype.onAltNum_=function(a,b){return this.keyboard.terminal.passAltNumber&&!a.shiftKey?hterm.Keyboard.KeyActions.PASS:hterm.Keyboard.KeyActions.DEFAULT};hterm.Keyboard.KeyMap.prototype.onMetaNum_=function(a,b){return this.keyboard.terminal.passMetaNumber&&!a.shiftKey?hterm.Keyboard.KeyActions.PASS:hterm.Keyboard.KeyActions.DEFAULT};
hterm.Keyboard.KeyMap.prototype.onCtrlC_=function(a,b){b=this.keyboard.terminal.getDocument().getSelection();if(!b.isCollapsed){if(this.keyboard.ctrlCCopy&&!a.shiftKey)return this.keyboard.terminal.clearSelectionAfterCopy&&setTimeout(b.collapseToEnd.bind(b),50),hterm.Keyboard.KeyActions.PASS;if(!this.keyboard.ctrlCCopy&&a.shiftKey)return this.keyboard.terminal.clearSelectionAfterCopy&&setTimeout(b.collapseToEnd.bind(b),50),this.keyboard.terminal.copySelectionToClipboard(),hterm.Keyboard.KeyActions.CANCEL}return"\u0003"};
hterm.Keyboard.KeyMap.prototype.onCtrlN_=function(a,b){return a.shiftKey?(window.open(document.location.href,"","chrome=no,close=yes,resize=yes,scrollbars=yes,minimizable=yes,width="+window.innerWidth+",height="+window.innerHeight),hterm.Keyboard.KeyActions.CANCEL):"\u000e"};
hterm.Keyboard.KeyMap.prototype.onCtrlV_=function(a,b){return!a.shiftKey&&this.keyboard.ctrlVPaste||a.shiftKey&&!this.keyboard.ctrlVPaste?this.keyboard.terminal.paste()?hterm.Keyboard.KeyActions.CANCEL:hterm.Keyboard.KeyActions.PASS:"\u0016"};
hterm.Keyboard.KeyMap.prototype.onMetaN_=function(a,b){return a.shiftKey?(window.open(document.location.href,"","chrome=no,close=yes,resize=yes,scrollbars=yes,minimizable=yes,width="+window.outerWidth+",height="+window.outerHeight),hterm.Keyboard.KeyActions.CANCEL):hterm.Keyboard.KeyActions.DEFAULT};
hterm.Keyboard.KeyMap.prototype.onMetaC_=function(a,b){var c=this.keyboard.terminal.getDocument();if(a.shiftKey||c.getSelection().isCollapsed)return b.keyCap.substr(a.shiftKey?1:0,1);this.keyboard.terminal.clearSelectionAfterCopy&&setTimeout(function(){c.getSelection().collapseToEnd()},50);return hterm.Keyboard.KeyActions.PASS};hterm.Keyboard.KeyMap.prototype.onMetaV_=function(a,b){return a.shiftKey?hterm.Keyboard.KeyActions.PASS:this.keyboard.passMetaV?hterm.Keyboard.KeyActions.PASS:hterm.Keyboard.KeyActions.DEFAULT};
hterm.Keyboard.KeyMap.prototype.onPlusMinusZero_=function(a,b){if(!(this.keyboard.ctrlPlusMinusZeroZoom^a.shiftKey))return"-_"==b.keyCap?"\u001f":hterm.Keyboard.KeyActions.CANCEL;if(1!=this.keyboard.terminal.getZoomFactor())return hterm.Keyboard.KeyActions.PASS;a=b.keyCap.substr(0,1);if("0"==a)this.keyboard.terminal.setFontSize(0);else{var c=this.keyboard.terminal.getFontSize();c="-"==a||"[KP-]"==b.keyCap?c-1:c+1;this.keyboard.terminal.setFontSize(c)}return hterm.Keyboard.KeyActions.CANCEL};"use strict";
hterm.Keyboard.KeyPattern=function(a){this.wildcardCount=0;this.keyCode=a.keyCode;hterm.Keyboard.KeyPattern.modifiers.forEach(function(b){this[b]=a[b]||!1;"*"==this[b]&&this.wildcardCount++}.bind(this))};hterm.Keyboard.KeyPattern.modifiers=["shift","ctrl","alt","meta"];hterm.Keyboard.KeyPattern.sortCompare=function(a,b){return a.wildcardCount<b.wildcardCount?-1:a.wildcardCount>b.wildcardCount?1:0};
hterm.Keyboard.KeyPattern.prototype.match_=function(a,b){if(this.keyCode!=a.keyCode)return!1;var c=!0;hterm.Keyboard.KeyPattern.modifiers.forEach(function(d){var e=d in a?a[d]:!1;c&&(b||"*"!=this[d])&&this[d]!=e&&(c=!1)}.bind(this));return c};hterm.Keyboard.KeyPattern.prototype.matchKeyDown=function(a){return this.match_(a,!1)};hterm.Keyboard.KeyPattern.prototype.matchKeyPattern=function(a){return this.match_(a,!0)};"use strict";
hterm.Options=function(a){this.wraparound=a?a.wraparound:!0;this.reverseWraparound=a?a.reverseWraparound:!1;this.originMode=a?a.originMode:!1;this.autoCarriageReturn=a?a.autoCarriageReturn:!1;this.cursorVisible=a?a.cursorVisible:!1;this.cursorBlink=a?a.cursorBlink:!1;this.insertMode=a?a.insertMode:!1;this.reverseVideo=a?a.reverseVideo:!1;this.bracketedPaste=a?a.bracketedPaste:!1};"use strict";lib.rtdep("hterm.Keyboard.KeyActions");hterm.Parser=function(){this.source="";this.pos=0;this.ch=null};
hterm.Parser.prototype.error=function(a){return Error("Parse error at "+this.pos+": "+a)};hterm.Parser.prototype.isComplete=function(){return this.pos==this.source.length};hterm.Parser.prototype.reset=function(a,b){this.source=a;this.pos=b||0;this.ch=a.substr(0,1)};
hterm.Parser.prototype.parseKeySequence=function(){var a={keyCode:null};for(b in hterm.Parser.identifiers.modifierKeys)a[hterm.Parser.identifiers.modifierKeys[b]]=!1;for(;this.pos<this.source.length;){this.skipSpace();var b=this.parseToken();if("integer"==b.type)a.keyCode=b.value;else if("identifier"==b.type){var c=b.value.toUpperCase();if(c in hterm.Parser.identifiers.modifierKeys&&hterm.Parser.identifiers.modifierKeys.hasOwnProperty(c)){c=hterm.Parser.identifiers.modifierKeys[c];if(a[c]&&"*"!=a[c])throw this.error("Duplicate modifier: "+
b.value);a[c]=!0}else if(c in hterm.Parser.identifiers.keyCodes&&hterm.Parser.identifiers.keyCodes.hasOwnProperty(c))a.keyCode=hterm.Parser.identifiers.keyCodes[c];else throw this.error("Unknown key: "+b.value);}else if("symbol"==b.type)if("*"==b.value)for(var d in hterm.Parser.identifiers.modifierKeys)b=hterm.Parser.identifiers.modifierKeys[d],a[b]||(a[b]="*");else throw this.error("Unexpected symbol: "+b.value);else throw this.error("Expected integer or identifier");this.skipSpace();if("-"!=this.ch)break;
if(null!=a.keyCode)throw this.error("Extra definition after target key");this.advance(1)}if(null==a.keyCode)throw this.error("Missing target key");return a};
hterm.Parser.prototype.parseKeyAction=function(){this.skipSpace();var a=this.parseToken();if("string"==a.type)return a.value;if("identifier"==a.type){if(a.value in hterm.Parser.identifiers.actions&&hterm.Parser.identifiers.actions.hasOwnProperty(a.value))return hterm.Parser.identifiers.actions[a.value];throw this.error("Unknown key action: "+a.value);}throw this.error("Expected string or identifier");};hterm.Parser.prototype.peekString=function(){return"'"==this.ch||'"'==this.ch};
hterm.Parser.prototype.peekIdentifier=function(){return this.ch.match(/[a-z_]/i)};hterm.Parser.prototype.peekInteger=function(){return this.ch.match(/[0-9]/)};
hterm.Parser.prototype.parseToken=function(){if("*"==this.ch){var a={type:"symbol",value:this.ch};this.advance(1);return a}if(this.peekIdentifier())return{type:"identifier",value:this.parseIdentifier()};if(this.peekString())return{type:"string",value:this.parseString()};if(this.peekInteger())return{type:"integer",value:this.parseInteger()};throw this.error("Unexpected token");};hterm.Parser.prototype.parseIdentifier=function(){if(!this.peekIdentifier())throw this.error("Expected identifier");return this.parsePattern(/[a-z0-9_]+/ig)};
hterm.Parser.prototype.parseInteger=function(){return"0"==this.ch&&this.pos<this.source.length-1&&"x"==this.source.substr(this.pos+1,1)?parseInt(this.parsePattern(/0x[0-9a-f]+/gi)):parseInt(this.parsePattern(/\d+/g))};
hterm.Parser.prototype.parseString=function(){var a="",b=this.ch;if('"'!=b&&"'"!=b)throw this.error("String expected");this.advance(1);for(var c=new RegExp("[\\\\"+b+"]","g");this.pos<this.source.length;){c.lastIndex=this.pos;if(!c.exec(this.source))break;a+=this.source.substring(this.pos,c.lastIndex-1);this.advance(c.lastIndex-this.pos-1);if('"'==b&&"\\"==this.ch)this.advance(1),a+=this.parseEscape();else if("'"==b&&"\\"==this.ch)a+=this.ch,this.advance(1);else if(this.ch==b)return this.advance(1),
a}throw this.error("Unterminated string literal");};
hterm.Parser.prototype.parseEscape=function(){var a={'"':'"',"'":"'","\\":"\\",a:"\u0007",b:"\b",e:"\u001b",f:"\f",n:"\n",r:"\r",t:"\t",v:"\x0B",x:function(){var a=this.parsePattern(/[a-z0-9]{2}/ig);return String.fromCharCode(parseInt(a,16))},u:function(){var a=this.parsePattern(/[a-z0-9]{4}/ig);return String.fromCharCode(parseInt(a,16))}};if(!(this.ch in a&&a.hasOwnProperty(this.ch)))throw this.error("Unknown escape: "+this.ch);a=a[this.ch];this.advance(1);"function"==typeof a&&(a=a.call(this));
return a};hterm.Parser.prototype.parsePattern=function(a){if(!a.global)throw this.error("Internal error: Span patterns must be global");a.lastIndex=this.pos;var b=a.exec(this.source);if(!b||a.lastIndex-b[0].length!=this.pos)throw this.error("Expected match for: "+a);this.pos=a.lastIndex-1;this.advance(1);return b[0]};hterm.Parser.prototype.advance=function(a){this.pos+=a;this.ch=this.source.substr(this.pos,1)};
hterm.Parser.prototype.skipSpace=function(a){if(/\s/.test(this.ch)){var b=/\s+/gm;b.lastIndex=this.pos;b.exec(this.source)&&(this.pos=b.lastIndex);this.ch=this.source.substr(this.pos,1);if(a&&-1==this.ch.indexOf(a))throw this.error("Expected one of "+a+", found: "+this.ch);}};"use strict";hterm.Parser.identifiers={};hterm.Parser.identifiers.modifierKeys={SHIFT:"shift",CTRL:"ctrl",CONTROL:"ctrl",ALT:"alt",META:"meta"};
hterm.Parser.identifiers.keyCodes={ESCAPE:27,ESC:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,ZERO:48,BACKSPACE:8,BKSP:8,BS:8,TAB:9,Q:81,W:87,E:69,R:82,T:84,Y:89,U:85,I:73,O:79,P:80,CAPS_LOCK:20,CAPSLOCK:20,CAPS:20,A:65,S:83,D:68,F:70,G:71,H:72,J:74,K:75,L:76,ENTER:13,ENT:13,RETURN:13,RET:13,Z:90,X:88,C:67,V:86,B:66,N:78,M:77,SPACE:32,SP:32,PRINT_SCREEN:42,PRTSC:42,SCROLL_LOCK:145,
SCRLK:145,BREAK:19,BRK:19,INSERT:45,INS:45,HOME:36,PAGE_UP:33,PGUP:33,DELETE:46,DEL:46,END:35,PAGE_DOWN:34,PGDOWN:34,PGDN:34,UP:38,DOWN:40,RIGHT:39,LEFT:37,NUMLOCK:144,KP0:96,KP1:97,KP2:98,KP3:99,KP4:100,KP5:101,KP6:102,KP7:103,KP8:104,KP9:105,KP_PLUS:107,KP_ADD:107,KP_MINUS:109,KP_SUBTRACT:109,KP_STAR:106,KP_MULTIPLY:106,KP_DIVIDE:111,KP_DECIMAL:110,KP_PERIOD:110,NAVIGATE_BACK:166,NAVIGATE_FORWARD:167,RELOAD:168,FULL_SCREEN:183,WINDOW_OVERVIEW:182,BRIGHTNESS_UP:216,BRIGHTNESS_DOWN:217};
hterm.Parser.identifiers.actions={CANCEL:hterm.Keyboard.KeyActions.CANCEL,DEFAULT:hterm.Keyboard.KeyActions.DEFAULT,PASS:hterm.Keyboard.KeyActions.PASS,scrollPageUp:function(a){a.scrollPageUp();return hterm.Keyboard.KeyActions.CANCEL},scrollPageDown:function(a){a.scrollPageDown();return hterm.Keyboard.KeyActions.CANCEL},scrollToTop:function(a){a.scrollEnd();return hterm.Keyboard.KeyActions.CANCEL},scrollToBottom:function(a){a.scrollEnd();return hterm.Keyboard.KeyActions.CANCEL},clearScrollback:function(a){a.wipeContents();
return hterm.Keyboard.KeyActions.CANCEL}};"use strict";lib.rtdep("lib.f","lib.Storage");hterm.PreferenceManager=function(a){lib.PreferenceManager.call(this,hterm.defaultStorage,hterm.PreferenceManager.prefix_+a);var b=hterm.PreferenceManager.defaultPreferences;Object.keys(b).forEach(function(a){this.definePreference(a,b[a][1])}.bind(this))};hterm.PreferenceManager.prefix_="/hterm/profiles/";
hterm.PreferenceManager.listProfiles=function(a){hterm.defaultStorage.getItems(null,function(b){var c={};b=$jscomp.makeIterator(Object.keys(b));for(var d=b.next();!d.done;d=b.next())d=d.value,d.startsWith(hterm.PreferenceManager.prefix_)&&(d=d.slice(hterm.PreferenceManager.prefix_.length),c[d.split("/",1)[0]]=!0);a(Object.keys(c))})};hterm.PreferenceManager.categories={};hterm.PreferenceManager.categories.Keyboard="Keyboard";hterm.PreferenceManager.categories.Appearance="Appearance";
hterm.PreferenceManager.categories.CopyPaste="CopyPaste";hterm.PreferenceManager.categories.Sounds="Sounds";hterm.PreferenceManager.categories.Scrolling="Scrolling";hterm.PreferenceManager.categories.Encoding="Encoding";hterm.PreferenceManager.categories.Extensions="Extensions";hterm.PreferenceManager.categories.Miscellaneous="Miscellaneous";
hterm.PreferenceManager.categoryDefinitions=[{id:hterm.PreferenceManager.categories.Appearance,text:"Appearance (fonts, colors, images)"},{id:hterm.PreferenceManager.categories.CopyPaste,text:"Copy & Paste"},{id:hterm.PreferenceManager.categories.Encoding,text:"Encoding"},{id:hterm.PreferenceManager.categories.Keyboard,text:"Keyboard"},{id:hterm.PreferenceManager.categories.Scrolling,text:"Scrolling"},{id:hterm.PreferenceManager.categories.Sounds,text:"Sounds"},{id:hterm.PreferenceManager.categories.Extensions,
text:"Extensions"},{id:hterm.PreferenceManager.categories.Miscellaneous,text:"Misc."}];
hterm.PreferenceManager.defaultPreferences={"alt-gr-mode":[hterm.PreferenceManager.categories.Keyboard,null,[null,"none","ctrl-alt","left-alt","right-alt"],"Select an AltGr detection hack^Wheuristic.\n\n'null': Autodetect based on navigator.language:\n      'en-us' => 'none', else => 'right-alt'\n'none': Disable any AltGr related munging.\n'ctrl-alt': Assume Ctrl+Alt means AltGr.\n'left-alt': Assume left Alt means AltGr.\n'right-alt': Assume right Alt means AltGr."],"alt-backspace-is-meta-backspace":[hterm.PreferenceManager.categories.Keyboard,
!1,"bool","If set, undoes the Chrome OS Alt-Backspace->DEL remap, so that alt-backspace indeed is alt-backspace."],"alt-is-meta":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","Set whether the alt key acts as a meta key or as a distinct alt key."],"alt-sends-what":[hterm.PreferenceManager.categories.Keyboard,"escape",["escape","8-bit","browser-key"],"Controls how the alt key is handled.\n\n  escape....... Send an ESC prefix.\n  8-bit........ Add 128 to the unshifted character as in xterm.\n  browser-key.. Wait for the keypress event and see what the browser\n                says.  (This won't work well on platforms where the\n                browser performs a default action for some alt sequences.)"],
"audible-bell-sound":[hterm.PreferenceManager.categories.Sounds,"lib-resource:hterm/audio/bell","url","URL of the terminal bell sound.  Empty string for no audible bell."],"desktop-notification-bell":[hterm.PreferenceManager.categories.Sounds,!1,"bool",'If true, terminal bells in the background will create a Web Notification. https://www.w3.org/TR/notifications/\n\nDisplaying notifications requires permission from the user. When this option is set to true, hterm will attempt to ask the user for permission if necessary. Note browsers may not show this permission request if it did not originate from a user action.\n\nChrome extensions with the "notifications" permission have permission to display notifications.'],
"background-color":[hterm.PreferenceManager.categories.Appearance,"rgb(16, 16, 16)","color","The background color for text with no other color attributes."],"background-image":[hterm.PreferenceManager.categories.Appearance,"","string","CSS value of the background image.  Empty string for no image.\n\nFor example:\n  url(https://goo.gl/anedTK)\n  linear-gradient(top bottom, blue, red)"],"background-size":[hterm.PreferenceManager.categories.Appearance,"","string","CSS value of the background image size.  Defaults to none."],
"background-position":[hterm.PreferenceManager.categories.Appearance,"","string","CSS value of the background image position.\n\nFor example:\n  10% 10%\n  center"],"backspace-sends-backspace":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","If true, the backspace should send BS ('\\x08', aka ^H).  Otherwise the backspace key should send '\\x7f'."],"character-map-overrides":[hterm.PreferenceManager.categories.Appearance,null,"value",'This is specified as an object. It is a sparse array, where each property is the character set code and the value is an object that is a sparse array itself. In that sparse array, each property is the received character and the value is the displayed character.\n\nFor example:\n  {"0":{"+":"\\u2192",",":"\\u2190","-":"\\u2191",".":"\\u2193", "0":"\\u2588"}}'],
"close-on-exit":[hterm.PreferenceManager.categories.Miscellaneous,!0,"bool","Whether or not to close the window when the command exits."],"cursor-blink":[hterm.PreferenceManager.categories.Appearance,!1,"bool","Whether or not to blink the cursor by default."],"cursor-blink-cycle":[hterm.PreferenceManager.categories.Appearance,[1E3,500],"value","The cursor blink rate in milliseconds.\n\nA two element array, the first of which is how long the cursor should be on, second is how long it should be off."],
"cursor-color":[hterm.PreferenceManager.categories.Appearance,"rgba(255, 0, 0, 0.5)","color","The color of the visible cursor."],"color-palette-overrides":[hterm.PreferenceManager.categories.Appearance,null,"value","Override colors in the default palette.\n\nThis can be specified as an array or an object.  If specified as an object it is assumed to be a sparse array, where each property is a numeric index into the color palette.\n\nValues can be specified as almost any css color value.  This includes #RGB, #RRGGBB, rgb(...), rgba(...), and any color names that are also part of the stock X11 rgb.txt file.\n\nYou can use 'null' to specify that the default value should be not be changed.  This is useful for skipping a small number of indices when the value is specified as an array."],
"copy-on-select":[hterm.PreferenceManager.categories.CopyPaste,!0,"bool","Automatically copy mouse selection to the clipboard."],"use-default-window-copy":[hterm.PreferenceManager.categories.CopyPaste,!1,"bool","Whether to use the default window copy behavior"],"clear-selection-after-copy":[hterm.PreferenceManager.categories.CopyPaste,!0,"bool","Whether to clear the selection after copying."],"ctrl-plus-minus-zero-zoom":[hterm.PreferenceManager.categories.Keyboard,!0,"bool","If true, Ctrl-Plus/Minus/Zero controls zoom.\nIf false, Ctrl-Shift-Plus/Minus/Zero controls zoom, Ctrl-Minus sends ^_, Ctrl-Plus/Zero do nothing."],
"ctrl-c-copy":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","Ctrl+C copies if true, send ^C to host if false.\nCtrl+Shift+C sends ^C to host if true, copies if false."],"ctrl-v-paste":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","Ctrl+V pastes if true, send ^V to host if false.\nCtrl+Shift+V sends ^V to host if true, pastes if false."],"east-asian-ambiguous-as-two-column":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","Set whether East Asian Ambiguous characters have two column width."],
"enable-8-bit-control":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","True to enable 8-bit control characters, false to ignore them.\n\nWe'll respect the two-byte versions of these control characters regardless of this setting."],"enable-bold":[hterm.PreferenceManager.categories.Appearance,null,"tristate","True if we should use bold weight font for text with the bold/bright attribute.  False to use the normal weight font.  Null to autodetect."],"enable-bold-as-bright":[hterm.PreferenceManager.categories.Appearance,
!0,"bool","True if we should use bright colors (8-15 on a 16 color palette) for any text with the bold attribute.  False otherwise."],"enable-blink":[hterm.PreferenceManager.categories.Appearance,!0,"bool","True if we should respect the blink attribute.  False to ignore it.  "],"enable-clipboard-notice":[hterm.PreferenceManager.categories.CopyPaste,!0,"bool","Show a message in the terminal when the host writes to the clipboard."],"enable-clipboard-write":[hterm.PreferenceManager.categories.CopyPaste,
!0,"bool","Allow the remote host to write directly to the local system clipboard.\nRead access is never granted regardless of this setting.\n\nThis is used to control access to features like OSC-52."],"enable-dec12":[hterm.PreferenceManager.categories.Miscellaneous,!1,"bool","Respect the host's attempt to change the cursor blink status using DEC Private Mode 12."],environment:[hterm.PreferenceManager.categories.Miscellaneous,{NCURSES_NO_UTF8_ACS:"1",TERM:"xterm-256color"},"value","The default environment variables, as an object."],
"font-family":[hterm.PreferenceManager.categories.Appearance,'"DejaVu Sans Mono", "Everson Mono", FreeMono, "Menlo", "Terminal", monospace',"string","Default font family for the terminal text."],"font-size":[hterm.PreferenceManager.categories.Appearance,15,"int","The default font size in pixels."],"font-smoothing":[hterm.PreferenceManager.categories.Appearance,"antialiased","string","CSS font-smoothing property."],"foreground-color":[hterm.PreferenceManager.categories.Appearance,"rgb(240, 240, 240)",
"color","The foreground color for text with no other color attributes."],"home-keys-scroll":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","If true, home/end will control the terminal scrollbar and shift home/end will send the VT keycodes.  If false then home/end sends VT codes and shift home/end scrolls."],keybindings:[hterm.PreferenceManager.categories.Keyboard,null,"value",'A map of key sequence to key actions.  Key sequences include zero or more modifier keys followed by a key code.  Key codes can be decimal or hexadecimal numbers, or a key identifier.  Key actions can be specified a string to send to the host, or an action identifier.  For a full explanation of the format, see https://goo.gl/LWRndr.\n\nSample keybindings:\n{\n  "Ctrl-Alt-K": "clearScrollback",\n  "Ctrl-Shift-L": "PASS",\n  "Ctrl-H": "\'HELLO\\n\'"\n}'],
"media-keys-are-fkeys":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","If true, convert media keys to their Fkey equivalent. If false, let the browser handle the keys."],"meta-sends-escape":[hterm.PreferenceManager.categories.Keyboard,!0,"bool","Set whether the meta key sends a leading escape or not."],"mouse-right-click-paste":[hterm.PreferenceManager.categories.CopyPaste,!0,"bool",'Paste on right mouse button clicks.\n\nThis option is activate independent of the "mouse-paste-button" setting.\n\nNote: This will handle left & right handed mice correctly.'],
"mouse-paste-button":[hterm.PreferenceManager.categories.CopyPaste,null,[null,0,1,2,3,4,5,6],"Mouse paste button, or null to autodetect.\n\nFor autodetect, we'll use the middle mouse button for non-X11 platforms (including Chrome OS).  On X11, we'll use the right mouse button (since the native window manager should paste via the middle mouse button).\n\n0 == left (primary) button.\n1 == middle (auxiliary) button.\n2 == right (secondary) button.\n\nThis option is activate independent of the \"mouse-right-click-paste\" setting.\n\nNote: This will handle left & right handed mice correctly."],
"word-break-match-left":[hterm.PreferenceManager.categories.CopyPaste,"[^\\s\\[\\](){}<>\"'\\^!@#$%&*,;:`]","string",'Regular expression to halt matching to the left (start) of a selection.\n\nNormally this is a character class to reject specific characters.\nWe allow "~" and "." by default as paths frequently start with those.'],"word-break-match-right":[hterm.PreferenceManager.categories.CopyPaste,"[^\\s\\[\\](){}<>\"'\\^!@#$%&*,;:~.`]","string","Regular expression to halt matching to the right (end) of a selection.\n\nNormally this is a character class to reject specific characters."],
"word-break-match-middle":[hterm.PreferenceManager.categories.CopyPaste,"[^\\s\\[\\](){}<>\"'\\^]*","string","Regular expression to match all the characters in the middle.\n\nNormally this is a character class to reject specific characters.\n\nUsed to expand the selection surrounding the starting point."],"page-keys-scroll":[hterm.PreferenceManager.categories.Keyboard,!1,"bool","If true, page up/down will control the terminal scrollbar and shift page up/down will send the VT keycodes.  If false then page up/down sends VT codes and shift page up/down scrolls."],
"pass-alt-number":[hterm.PreferenceManager.categories.Keyboard,null,"tristate","Set whether we should pass Alt-1..9 to the browser.\n\nThis is handy when running hterm in a browser tab, so that you don't lose Chrome's \"switch to tab\" keyboard accelerators.  When not running in a tab it's better to send these keys to the host so they can be used in vim or emacs.\n\nIf true, Alt-1..9 will be handled by the browser.  If false, Alt-1..9 will be sent to the host.  If null, autodetect based on browser platform and window type."],
"pass-ctrl-number":[hterm.PreferenceManager.categories.Keyboard,null,"tristate","Set whether we should pass Ctrl-1..9 to the browser.\n\nThis is handy when running hterm in a browser tab, so that you don't lose Chrome's \"switch to tab\" keyboard accelerators.  When not running in a tab it's better to send these keys to the host so they can be used in vim or emacs.\n\nIf true, Ctrl-1..9 will be handled by the browser.  If false, Ctrl-1..9 will be sent to the host.  If null, autodetect based on browser platform and window type."],
"pass-meta-number":[hterm.PreferenceManager.categories.Keyboard,null,"tristate","Set whether we should pass Meta-1..9 to the browser.\n\nThis is handy when running hterm in a browser tab, so that you don't lose Chrome's \"switch to tab\" keyboard accelerators.  When not running in a tab it's better to send these keys to the host so they can be used in vim or emacs.\n\nIf true, Meta-1..9 will be handled by the browser.  If false, Meta-1..9 will be sent to the host.  If null, autodetect based on browser platform and window type."],
"pass-meta-v":[hterm.PreferenceManager.categories.Keyboard,!0,"bool","Set whether meta-V gets passed to host."],"receive-encoding":[hterm.PreferenceManager.categories.Encoding,"utf-8",["utf-8","raw"],"Set the expected encoding for data received from the host.\n\nValid values are 'utf-8' and 'raw'."],"scroll-on-keystroke":[hterm.PreferenceManager.categories.Scrolling,!0,"bool","If true, scroll to the bottom on any keystroke."],"scroll-on-output":[hterm.PreferenceManager.categories.Scrolling,!1,"bool",
"If true, scroll to the bottom on terminal output."],"scrollbar-visible":[hterm.PreferenceManager.categories.Scrolling,!0,"bool","The vertical scrollbar mode."],"scroll-wheel-may-send-arrow-keys":[hterm.PreferenceManager.categories.Scrolling,!1,"bool","When using the alternative screen buffer, and DECCKM (Application Cursor Keys) is active, mouse wheel scroll events will emulate arrow keys.\n\nIt can be temporarily disabled by holding the shift key.\n\nThis frequently comes up when using pagers (less) or reading man pages or text editors (vi/nano) or using screen/tmux."],
"scroll-wheel-move-multiplier":[hterm.PreferenceManager.categories.Scrolling,1,"int","The multiplier for the pixel delta in wheel events caused by the scroll wheel. Alters how fast the page scrolls."],"send-encoding":[hterm.PreferenceManager.categories.Encoding,"utf-8",["utf-8","raw"],"Set the encoding for data sent to host."],"terminal-encoding":[hterm.PreferenceManager.categories.Encoding,"utf-8",["iso-2022","utf-8","utf-8-locked"],"The default terminal encoding (DOCS).\n\nISO-2022 enables character map translations (like graphics maps).\nUTF-8 disables support for those.\n\nThe locked variant means the encoding cannot be changed at runtime via terminal escape sequences.\n\nYou should stick with UTF-8 unless you notice broken rendering with legacy applications."],
"shift-insert-paste":[hterm.PreferenceManager.categories.Keyboard,!0,"bool","Shift + Insert pastes if true, sent to host if false."],"user-css":[hterm.PreferenceManager.categories.Appearance,"","url","URL of user stylesheet to include in the terminal document."],"user-css-text":[hterm.PreferenceManager.categories.Appearance,"","multiline-string","Custom CSS text for styling the terminal."],"allow-images-inline":[hterm.PreferenceManager.categories.Extensions,null,"tristate","Whether to allow the remote side to display images in the terminal.\n\nBy default, we prompt until a choice is made."]};
hterm.PreferenceManager.prototype=Object.create(lib.PreferenceManager.prototype);hterm.PreferenceManager.constructor=hterm.PreferenceManager;"use strict";hterm.PubSub=function(){this.observers_={}};hterm.PubSub.addBehavior=function(a){var b=new hterm.PubSub,c;for(c in hterm.PubSub.prototype)a[c]=hterm.PubSub.prototype[c].bind(b)};hterm.PubSub.prototype.subscribe=function(a,b){a in this.observers_||(this.observers_[a]=[]);this.observers_[a].push(b)};
hterm.PubSub.prototype.unsubscribe=function(a,b){var c=this.observers_[a];if(!c)throw"Invalid subject: "+a;b=c.indexOf(b);if(0>b)throw"Not subscribed: "+a;c.splice(b,1)};hterm.PubSub.prototype.publish=function(a,b,c){function d(a){a<e.length-1&&setTimeout(d,0,a+1);e[a](b)}var e=this.observers_[a];e&&(e=[].concat(e));c&&(e?e.push(c):e=[c]);e&&setTimeout(d,0,0)};"use strict";lib.rtdep("lib.f","lib.wc","hterm.RowCol","hterm.Size","hterm.TextAttributes");
hterm.Screen=function(a){this.rowsArray=[];this.columnCount_=a||80;this.textAttributes=new hterm.TextAttributes(window.document);this.cursorPosition=new hterm.RowCol(0,0);this.cursorState_=new hterm.Screen.CursorState(this);this.wordBreakMatchMiddle=this.wordBreakMatchRight=this.wordBreakMatchLeft=this.cursorOffset_=this.cursorNode_=this.cursorRowNode_=null};hterm.Screen.prototype.getSize=function(){return new hterm.Size(this.columnCount_,this.rowsArray.length)};hterm.Screen.prototype.getHeight=function(){return this.rowsArray.length};
hterm.Screen.prototype.getWidth=function(){return this.columnCount_};hterm.Screen.prototype.setColumnCount=function(a){this.columnCount_=a;this.cursorPosition.column>=a&&this.setCursorPosition(this.cursorPosition.row,a-1)};hterm.Screen.prototype.shiftRow=function(){return this.shiftRows(1)[0]};hterm.Screen.prototype.shiftRows=function(a){return this.rowsArray.splice(0,a)};hterm.Screen.prototype.unshiftRow=function(a){this.rowsArray.splice(0,0,a)};
hterm.Screen.prototype.unshiftRows=function(a){this.rowsArray.unshift.apply(this.rowsArray,a)};hterm.Screen.prototype.popRow=function(){return this.popRows(1)[0]};hterm.Screen.prototype.popRows=function(a){return this.rowsArray.splice(this.rowsArray.length-a,a)};hterm.Screen.prototype.pushRow=function(a){this.rowsArray.push(a)};hterm.Screen.prototype.pushRows=function(a){a.push.apply(this.rowsArray,a)};hterm.Screen.prototype.insertRow=function(a,b){this.rowsArray.splice(a,0,b)};
hterm.Screen.prototype.insertRows=function(a,b){for(var c=0;c<b.length;c++)this.rowsArray.splice(a+c,0,b[c])};hterm.Screen.prototype.removeRow=function(a){return this.rowsArray.splice(a,1)[0]};hterm.Screen.prototype.removeRows=function(a,b){return this.rowsArray.splice(a,b)};hterm.Screen.prototype.invalidateCursorPosition=function(){this.cursorPosition.move(0,0);this.cursorOffset_=this.cursorNode_=this.cursorRowNode_=null};
hterm.Screen.prototype.clearCursorRow=function(){this.cursorRowNode_.innerHTML="";this.cursorRowNode_.removeAttribute("line-overflow");this.cursorOffset_=0;this.cursorPosition.column=0;this.cursorPosition.overflow=!1;var a=this.textAttributes.isDefault()?"":lib.f.getWhitespace(this.columnCount_);var b=this.textAttributes.inverse;this.textAttributes.inverse=!1;this.textAttributes.syncColors();a=this.textAttributes.createContainer(a);this.cursorRowNode_.appendChild(a);this.cursorNode_=a;this.textAttributes.inverse=
b;this.textAttributes.syncColors()};hterm.Screen.prototype.commitLineOverflow=function(){this.cursorRowNode_.setAttribute("line-overflow",!0)};
hterm.Screen.prototype.setCursorPosition=function(a,b){if(this.rowsArray.length){a>=this.rowsArray.length?(console.error("Row out of bounds: "+a),a=this.rowsArray.length-1):0>a&&(console.error("Row out of bounds: "+a),a=0);b>=this.columnCount_?(console.error("Column out of bounds: "+b),b=this.columnCount_-1):0>b&&(console.error("Column out of bounds: "+b),b=0);this.cursorPosition.overflow=!1;var c=this.rowsArray[a],d=c.firstChild;d||(d=c.ownerDocument.createTextNode(""),c.appendChild(d));var e=0;
c==this.cursorRowNode_?b>=this.cursorPosition.column-this.cursorOffset_&&(d=this.cursorNode_,e=this.cursorPosition.column-this.cursorOffset_):this.cursorRowNode_=c;for(this.cursorPosition.move(a,b);d;){a=b-e;c=hterm.TextAttributes.nodeWidth(d);if(!d.nextSibling||c>a){this.cursorNode_=d;this.cursorOffset_=a;break}e+=c;d=d.nextSibling}}else console.warn("Attempt to set cursor position on empty screen.")};hterm.Screen.prototype.syncSelectionCaret=function(a){try{a.collapse(this.cursorNode_,this.cursorOffset_)}catch(b){}};
hterm.Screen.prototype.splitNode_=function(a,b){var c=a.cloneNode(!1),d=a.textContent;setNodeText(a,hterm.TextAttributes.nodeSubstr(a,0,b));setNodeText(c,lib.wc.substr(d,b));c.textContent&&a.parentNode.insertBefore(c,a.nextSibling);a.textContent||a.parentNode.removeChild(a)};
hterm.Screen.prototype.maybeClipCurrentRow=function(){var a=hterm.TextAttributes.nodeWidth(this.cursorRowNode_);if(a<=this.columnCount_)this.cursorPosition.column>=this.columnCount_&&(this.setCursorPosition(this.cursorPosition.row,this.columnCount_-1),this.cursorPosition.overflow=!0);else{var b=this.cursorPosition.column;this.setCursorPosition(this.cursorPosition.row,this.columnCount_-1);a=hterm.TextAttributes.nodeWidth(this.cursorNode_);this.cursorOffset_<a-1&&setNodeText(this.cursorNode_,hterm.TextAttributes.nodeSubstr(this.cursorNode_,
0,this.cursorOffset_+1));a=this.cursorRowNode_;for(var c=this.cursorNode_.nextSibling;c;)a.removeChild(c),c=this.cursorNode_.nextSibling;b<this.columnCount_?this.setCursorPosition(this.cursorPosition.row,b):this.cursorPosition.overflow=!0}};
hterm.Screen.prototype.insertString=function(a,b){var c=this.cursorNode_,d=c.textContent;this.cursorRowNode_.removeAttribute("line-overflow");void 0===b&&(b=lib.wc.strWidth(a));this.cursorPosition.column+=b;var e=this.cursorOffset_,g=hterm.TextAttributes.nodeWidth(c)-e;if(0>g){var h=lib.f.getWhitespace(-g);this.textAttributes.underline||this.textAttributes.strikethrough||this.textAttributes.background||this.textAttributes.wcNode||!this.textAttributes.asciiNode||null!=this.textAttributes.tileData?
c.nodeType!=Node.TEXT_NODE&&(c.wcNode||!c.asciiNode||c.tileNode||c.style.textDecoration||c.style.textDecorationStyle||c.style.textDecorationLine||c.style.backgroundColor)?(d=c.ownerDocument.createTextNode(h),this.cursorRowNode_.insertBefore(d,c.nextSibling),this.cursorNode_=c=d,this.cursorOffset_=e=-g,d=h):setNodeText(c,d+=h):a=h+a;g=0}this.textAttributes.matchesContainer(c)?(0==g?setNodeText(c,d+a):0==e?setNodeText(c,a+d):setNodeText(c,hterm.TextAttributes.nodeSubstr(c,0,e)+a+hterm.TextAttributes.nodeSubstr(c,
e)),this.cursorOffset_+=b):0==e?(g=c.previousSibling)&&this.textAttributes.matchesContainer(g)?(setNodeText(g,g.textContent+a),this.cursorNode_=g,this.cursorOffset_=lib.wc.strWidth(g.textContent)):(a=this.textAttributes.createContainer(a),this.cursorRowNode_.insertBefore(a,c),this.cursorNode_=a,this.cursorOffset_=b):0==g?(b=c.nextSibling)&&this.textAttributes.matchesContainer(b)?(setNodeText(b,a+b.textContent),this.cursorNode_=b,this.cursorOffset_=lib.wc.strWidth(a)):(a=this.textAttributes.createContainer(a),
this.cursorRowNode_.insertBefore(a,b),this.cursorNode_=a,this.cursorOffset_=hterm.TextAttributes.nodeWidth(a)):(this.splitNode_(c,e),a=this.textAttributes.createContainer(a),this.cursorRowNode_.insertBefore(a,c.nextSibling),this.cursorNode_=a,this.cursorOffset_=b)};
hterm.Screen.prototype.overwriteString=function(a,b){var c=this.columnCount_-this.cursorPosition.column;if(!c)return[a];void 0===b&&(b=lib.wc.strWidth(a));this.textAttributes.matchesContainer(this.cursorNode_)&&this.cursorNode_.textContent.substr(this.cursorOffset_)==a?(this.cursorOffset_+=b,this.cursorPosition.column+=b):(this.deleteChars(Math.min(b,c)),this.insertString(a,b))};
hterm.Screen.prototype.deleteChars=function(a){var b=this.cursorNode_,c=this.cursorOffset_;a=Math.min(a,this.columnCount_-this.cursorPosition.column);if(!a)return 0;for(var d=a,e,g;b&&a;){if(0>a){console.error("Deleting "+d+" chars went negative: "+a);break}e=hterm.TextAttributes.nodeWidth(b);setNodeText(b,hterm.TextAttributes.nodeSubstr(b,0,c)+hterm.TextAttributes.nodeSubstr(b,c+a));g=hterm.TextAttributes.nodeWidth(b);b.wcNode&&c<e&&(g&&e==g||!g&&1==c)?(g=this.textAttributes.createContainer(" "),
b.parentNode.insertBefore(g,c?b:b.nextSibling),setNodeText(b,""),g=0,--a):a-=e-g;c=b.nextSibling;0==g&&b!=this.cursorNode_&&b.parentNode.removeChild(b);b=c;c=0}this.cursorNode_.nodeType==Node.TEXT_NODE||this.cursorNode_.textContent||(a=this.cursorNode_,a.previousSibling?(this.cursorNode_=a.previousSibling,this.cursorOffset_=hterm.TextAttributes.nodeWidth(a.previousSibling)):(a.nextSibling?this.cursorNode_=a.nextSibling:(b=this.cursorRowNode_.ownerDocument.createTextNode(""),this.cursorRowNode_.appendChild(b),
this.cursorNode_=b),this.cursorOffset_=0),this.cursorRowNode_.removeChild(a));return d};hterm.Screen.prototype.getLineStartRow_=function(a){for(;a.previousSibling&&a.previousSibling.hasAttribute("line-overflow");)a=a.previousSibling;return a};hterm.Screen.prototype.getLineText_=function(a){for(var b="";a;)if(b+=a.textContent,a.hasAttribute("line-overflow"))a=a.nextSibling;else break;return b};hterm.Screen.prototype.getXRowAncestor_=function(a){for(;a&&"X-ROW"!==a.nodeName;)a=a.parentNode;return a};
hterm.Screen.prototype.getPositionWithOverflow_=function(a,b,c){if(!b)return-1;var d=this.getXRowAncestor_(b);if(!d)return-1;for(var e=0;d!=a;)if(e+=hterm.TextAttributes.nodeWidth(a),a.hasAttribute("line-overflow")&&a.nextSibling)a=a.nextSibling;else return-1;return e+this.getPositionWithinRow_(a,b,c)};
hterm.Screen.prototype.getPositionWithinRow_=function(a,b,c){if(b.parentNode!=a)return null==b.parentNode?-1:this.getPositionWithinRow_(b.parentNode,b,c)+this.getPositionWithinRow_(a,b.parentNode,0);for(var d=0,e=0;e<a.childNodes.length;e++){var g=a.childNodes[e];if(g==b)return d+c;d+=hterm.TextAttributes.nodeWidth(g)}return-1};
hterm.Screen.prototype.getNodeAndOffsetWithOverflow_=function(a,b){for(;a&&b>hterm.TextAttributes.nodeWidth(a);)if(a.hasAttribute("line-overflow")&&a.nextSibling)b-=hterm.TextAttributes.nodeWidth(a),a=a.nextSibling;else return-1;return this.getNodeAndOffsetWithinRow_(a,b)};
hterm.Screen.prototype.getNodeAndOffsetWithinRow_=function(a,b){for(var c=0;c<a.childNodes.length;c++){var d=a.childNodes[c],e=hterm.TextAttributes.nodeWidth(d);if(b<=e)return"SPAN"===d.nodeName?this.getNodeAndOffsetWithinRow_(d,b):[d,b];b-=e}return null};hterm.Screen.prototype.setRange_=function(a,b,c,d){b=this.getNodeAndOffsetWithOverflow_(a,b);null!=b&&(a=this.getNodeAndOffsetWithOverflow_(a,c),null!=a&&(d.setStart(b[0],b[1]),d.setEnd(a[0],a[1])))};
hterm.Screen.prototype.expandSelection=function(a){if(a){var b=a.getRangeAt(0);if(b&&!b.toString().match(/\s/)){var c=this.getLineStartRow_(this.getXRowAncestor_(b.startContainer));if(c){var d=this.getPositionWithOverflow_(c,b.startContainer,b.startOffset);if(-1!=d){var e=this.getPositionWithOverflow_(c,b.endContainer,b.endOffset);if(-1!=e){var g=this.wordBreakMatchLeft,h=this.wordBreakMatchRight,l=this.wordBreakMatchMiddle,n=this.getLineText_(c);g=lib.wc.substring(n,0,e).search(new RegExp(g+l+"$"));
-1==g||g>d||!(h=lib.wc.substring(n,d,lib.wc.strWidth(n)).match(new RegExp("^"+l+h)))||(d+=lib.wc.strWidth(h[0]),-1==d||d<e||(this.setRange_(c,g,d,b),a.addRange(b)))}}}}}};hterm.Screen.prototype.saveCursorAndState=function(a){this.cursorState_.save(a)};hterm.Screen.prototype.restoreCursorAndState=function(a){this.cursorState_.restore(a)};hterm.Screen.CursorState=function(a){this.screen_=a;this.GL=this.GR=this.G0=this.G1=this.G2=this.G3=this.textAttributes=this.cursor=null};
hterm.Screen.CursorState.prototype.save=function(a){this.cursor=a.terminal.saveCursor();this.textAttributes=this.screen_.textAttributes.clone();this.GL=a.GL;this.GR=a.GR;this.G0=a.G0;this.G1=a.G1;this.G2=a.G2;this.G3=a.G3};
hterm.Screen.CursorState.prototype.restore=function(a){a.terminal.restoreCursor(this.cursor);var b=this.textAttributes.clone();b.colorPalette=this.screen_.textAttributes.colorPalette;b.syncColors();this.screen_.textAttributes=b;a.GL=this.GL;a.GR=this.GR;a.G0=this.G0;a.G1=this.G1;a.G2=this.G2;a.G3=this.G3};"use strict";lib.rtdep("lib.f","hterm.PubSub","hterm.Size");
hterm.ScrollPort=function(a){hterm.PubSub.addBehavior(this);this.rowProvider_=a;this.characterSize=new hterm.Size(10,10);this.ruler_=null;this.selection=new hterm.ScrollPort.Selection(this);this.currentRowNodeCache_=null;this.previousRowNodeCache_={};this.lastScreenHeight_=this.lastScreenWidth_=null;this.selectionEnabled_=!0;this.lastRowCount_=0;this.scrollWheelMultiplier_=1;this.lastTouch_={};this.isScrolledEnd=!0;this.currentScrollbarWidthPx=16;this.ctrlVPaste=!1;this.document_=this.div_=null;this.timeouts_=
{};this.observers_={};this.DEBUG_=!1};hterm.ScrollPort.Selection=function(a){this.scrollPort_=a;this.isCollapsed=this.isMultiline=this.endRow=this.startRow=null};hterm.ScrollPort.Selection.prototype.findFirstChild=function(a,b){for(a=a.firstChild;a;){if(-1!=b.indexOf(a))return a;if(a.childNodes.length){var c=this.findFirstChild(a,b);if(c)return c}a=a.nextSibling}return null};
hterm.ScrollPort.Selection.prototype.sync=function(){function a(){c.startRow=e;c.startNode=d.anchorNode;c.startOffset=d.anchorOffset;c.endRow=g;c.endNode=d.focusNode;c.endOffset=d.focusOffset}function b(){c.startRow=g;c.startNode=d.focusNode;c.startOffset=d.focusOffset;c.endRow=e;c.endNode=d.anchorNode;c.endOffset=d.anchorOffset}var c=this,d=this.scrollPort_.getDocument().getSelection();this.isMultiline=this.endRow=this.startRow=null;this.isCollapsed=!d||d.isCollapsed;if(!this.isCollapsed){for(var e=
d.anchorNode;e&&!("rowIndex"in e);)e=e.parentNode;if(e){for(var g=d.focusNode;g&&!("rowIndex"in g);)g=g.parentNode;if(g){if(e.rowIndex<g.rowIndex)a();else if(e.rowIndex>g.rowIndex)b();else if(d.focusNode==d.anchorNode)d.anchorOffset<d.focusOffset?a():b();else{var h=this.findFirstChild(e,[d.anchorNode,d.focusNode]);if(!h)throw Error("Unexpected error syncing selection.");h==d.anchorNode?a():b()}this.isMultiline=e.rowIndex!=g.rowIndex}else console.error("Selection focus is not rooted in a row node: "+
d.focusNode.nodeName)}else console.error("Selection anchor is not rooted in a row node: "+d.anchorNode.nodeName)}};
hterm.ScrollPort.prototype.decorate=function(a){this.div_=a;this.iframe_=a.ownerDocument.createElement("iframe");this.iframe_.style.cssText="border: 0;height: 100%;position: absolute;width: 100%";"mozInnerScreenX"in window&&(this.iframe_.src="#");a.appendChild(this.iframe_);this.iframe_.contentWindow.addEventListener("resize",this.onResize_.bind(this));a=this.document_=this.iframe_.contentDocument;a.body.style.cssText="margin: 0px;padding: 0px;height: 100%;width: 100%;overflow: hidden;cursor: var(--hterm-mouse-cursor-style);-webkit-user-select: none;-moz-user-select: none;";
var b=a.createElement("meta");b.setAttribute("charset","utf-8");a.head.appendChild(b);this.DEBUG_&&(this.document_.body.style.paddingTop=this.document_.body.style.paddingBottom="calc(var(--hterm-charsize-height) * 3)");b=a.createElement("style");b.textContent="x-row {  display: block;  height: var(--hterm-charsize-height);  line-height: var(--hterm-charsize-height);}";a.head.appendChild(b);this.userCssLink_=a.createElement("link");this.userCssLink_.setAttribute("rel","stylesheet");this.userCssText_=
a.createElement("style");a.head.appendChild(this.userCssText_);this.screen_=a.createElement("x-screen");this.screen_.setAttribute("contenteditable","true");this.screen_.setAttribute("spellcheck","false");this.screen_.setAttribute("autocomplete","off");this.screen_.setAttribute("autocorrect","off");this.screen_.setAttribute("autocapitalize","none");this.screen_.setAttribute("role","textbox");this.screen_.setAttribute("tabindex","-1");this.screen_.style.cssText="caret-color: transparent;display: block;font-family: monospace;font-size: 15px;font-variant-ligatures: none;height: 100%;overflow-y: scroll; overflow-x: hidden;white-space: pre;width: 100%;outline: none !important";
a.body.appendChild(this.screen_);this.screen_.addEventListener("scroll",this.onScroll_.bind(this));this.screen_.addEventListener("wheel",this.onScrollWheel_.bind(this));this.screen_.addEventListener("touchstart",this.onTouch_.bind(this));this.screen_.addEventListener("touchmove",this.onTouch_.bind(this));this.screen_.addEventListener("touchend",this.onTouch_.bind(this));this.screen_.addEventListener("touchcancel",this.onTouch_.bind(this));this.screen_.addEventListener("copy",this.onCopy_.bind(this));
this.screen_.addEventListener("paste",this.onPaste_.bind(this));this.screen_.addEventListener("drop",this.onDragAndDrop_.bind(this));a.body.addEventListener("keydown",this.onBodyKeyDown_.bind(this));this.rowNodes_=a.createElement("div");this.rowNodes_.id="hterm:row-nodes";this.rowNodes_.style.cssText="display: block;position: fixed;overflow: hidden;-webkit-user-select: text;-moz-user-select: text;";this.screen_.appendChild(this.rowNodes_);this.topSelectBag_=a.createElement("x-select-bag");this.topSelectBag_.style.cssText=
"display: block;overflow: hidden;height: var(--hterm-charsize-height);white-space: pre;";this.bottomSelectBag_=this.topSelectBag_.cloneNode();this.topFold_=a.createElement("x-fold");this.topFold_.id="hterm:top-fold-for-row-selection";this.topFold_.style.cssText="display: block;";this.rowNodes_.appendChild(this.topFold_);this.bottomFold_=this.topFold_.cloneNode();this.bottomFold_.id="hterm:bottom-fold-for-row-selection";this.rowNodes_.appendChild(this.bottomFold_);this.scrollArea_=a.createElement("div");
this.scrollArea_.id="hterm:scrollarea";this.scrollArea_.style.cssText="visibility: hidden";this.screen_.appendChild(this.scrollArea_);this.svg_=this.div_.ownerDocument.createElementNS("http://www.w3.org/2000/svg","svg");this.svg_.id="hterm:zoom-detector";this.svg_.setAttribute("xmlns","http://www.w3.org/2000/svg");this.svg_.setAttribute("version","1.1");this.svg_.style.cssText="position: absolute;top: 0;left: 0;visibility: hidden";this.pasteTarget_=a.createElement("textarea");this.pasteTarget_.id=
"hterm:ctrl-v-paste-target";this.pasteTarget_.setAttribute("tabindex","-1");this.pasteTarget_.style.cssText="position: absolute;height: 1px;width: 1px;left: 0px; bottom: 0px;opacity: 0";this.pasteTarget_.contentEditable=!0;this.screen_.appendChild(this.pasteTarget_);this.pasteTarget_.addEventListener("textInput",this.handlePasteTargetTextInput_.bind(this));this.resize()};
hterm.ScrollPort.prototype.setFontFamily=function(a,b){this.screen_.style.fontFamily=a;this.screen_.style.webkitFontSmoothing=b?b:"";this.syncCharacterSize()};hterm.ScrollPort.prototype.getFontFamily=function(){return this.screen_.style.fontFamily};hterm.ScrollPort.prototype.setUserCssUrl=function(a){a?(this.userCssLink_.setAttribute("href",a),this.userCssLink_.parentNode||this.document_.head.appendChild(this.userCssLink_)):this.userCssLink_.parentNode&&this.document_.head.removeChild(this.userCssLink_)};
hterm.ScrollPort.prototype.setUserCssText=function(a){this.userCssText_.textContent=a};hterm.ScrollPort.prototype.focus=function(){this.iframe_.focus();this.screen_.focus()};hterm.ScrollPort.prototype.getForegroundColor=function(){return this.screen_.style.color};hterm.ScrollPort.prototype.setForegroundColor=function(a){this.screen_.style.color=a};hterm.ScrollPort.prototype.getBackgroundColor=function(){return this.screen_.style.backgroundColor};
hterm.ScrollPort.prototype.setBackgroundColor=function(a){this.screen_.style.backgroundColor=a};hterm.ScrollPort.prototype.setBackgroundImage=function(a){this.screen_.style.backgroundImage=a};hterm.ScrollPort.prototype.setBackgroundSize=function(a){this.screen_.style.backgroundSize=a};hterm.ScrollPort.prototype.setBackgroundPosition=function(a){this.screen_.style.backgroundPosition=a};hterm.ScrollPort.prototype.setCtrlVPaste=function(a){this.ctrlVPaste=a};
hterm.ScrollPort.prototype.getScreenSize=function(){var a=hterm.getClientSize(this.screen_);return{height:a.height,width:a.width-this.currentScrollbarWidthPx}};hterm.ScrollPort.prototype.getScreenWidth=function(){return this.getScreenSize().width};hterm.ScrollPort.prototype.getScreenHeight=function(){return this.getScreenSize().height};hterm.ScrollPort.prototype.getDocument=function(){return this.document_};hterm.ScrollPort.prototype.getScreenNode=function(){return this.screen_};
hterm.ScrollPort.prototype.resetCache=function(){this.currentRowNodeCache_=null;this.previousRowNodeCache_={}};hterm.ScrollPort.prototype.setRowProvider=function(a){this.resetCache();this.rowProvider_=a;this.scheduleRedraw()};hterm.ScrollPort.prototype.invalidate=function(){for(var a=this.topFold_.nextSibling;a!=this.bottomFold_;){var b=a.nextSibling;a.parentElement.removeChild(a);a=b}this.previousRowNodeCache_=null;a=this.getTopRowIndex();b=this.getBottomRowIndex(a);this.drawVisibleRows_(a,b)};
hterm.ScrollPort.prototype.scheduleInvalidate=function(){if(!this.timeouts_.invalidate){var a=this;this.timeouts_.invalidate=setTimeout(function(){delete a.timeouts_.invalidate;a.invalidate()},0)}};hterm.ScrollPort.prototype.setFontSize=function(a){this.screen_.style.fontSize=a+"px";this.syncCharacterSize()};hterm.ScrollPort.prototype.getFontSize=function(){return parseInt(this.screen_.style.fontSize)};
hterm.ScrollPort.prototype.measureCharacterSize=function(a){this.ruler_||(this.ruler_=this.document_.createElement("div"),this.ruler_.id="hterm:ruler-character-size",this.ruler_.style.cssText="position: absolute;top: 0;left: 0;visibility: hidden;height: auto !important;width: auto !important;",this.rulerSpan_=this.document_.createElement("span"),this.rulerSpan_.id="hterm:ruler-span-workaround",this.rulerSpan_.innerHTML=("X".repeat(100)+"\r").repeat(100),this.ruler_.appendChild(this.rulerSpan_),this.rulerBaseline_=
this.document_.createElement("span"),this.rulerSpan_.id="hterm:ruler-baseline",this.rulerBaseline_.style.fontSize="0px",this.rulerBaseline_.textContent="X");this.rulerSpan_.style.fontWeight=a||"";this.rowNodes_.appendChild(this.ruler_);a=hterm.getClientSize(this.rulerSpan_);a=new hterm.Size(a.width/100,a.height/100);this.ruler_.appendChild(this.rulerBaseline_);a.baseline=this.rulerBaseline_.offsetTop;this.ruler_.removeChild(this.rulerBaseline_);this.rowNodes_.removeChild(this.ruler_);this.div_.ownerDocument.body.appendChild(this.svg_);
a.zoomFactor=this.svg_.currentScale;this.div_.ownerDocument.body.removeChild(this.svg_);return a};hterm.ScrollPort.prototype.syncCharacterSize=function(){this.characterSize=this.measureCharacterSize();this.resize()};
hterm.ScrollPort.prototype.resize=function(){this.currentScrollbarWidthPx=hterm.getClientWidth(this.screen_)-this.screen_.clientWidth;this.syncScrollHeight();this.syncRowNodesDimensions_();var a=this;this.publish("resize",{scrollPort:this},function(){a.scrollRowToBottom(a.rowProvider_.getRowCount());a.scheduleRedraw()})};
hterm.ScrollPort.prototype.syncRowNodesDimensions_=function(){var a=this.getScreenSize();this.lastScreenWidth_=a.width;this.lastScreenHeight_=a.height;this.visibleRowCount=lib.f.smartFloorDivide(a.height,this.characterSize.height);var b=this.visibleRowCount*this.characterSize.height;this.visibleRowTopMargin=0;this.visibleRowBottomMargin=a.height-b;this.topFold_.style.marginBottom=this.visibleRowTopMargin+"px";for(var c=0,d=this.topFold_.previousSibling;d;)c+=hterm.getClientHeight(d),d=d.previousSibling;
this.rowNodes_.style.width=a.width+"px";this.rowNodes_.style.height=b+c+"px";this.rowNodes_.style.left=this.screen_.offsetLeft+"px";this.rowNodes_.style.top=this.screen_.offsetTop-c+"px"};hterm.ScrollPort.prototype.syncScrollHeight=function(){this.lastRowCount_=this.rowProvider_.getRowCount();this.scrollArea_.style.height=this.characterSize.height*this.lastRowCount_+this.visibleRowTopMargin+this.visibleRowBottomMargin+"px"};
hterm.ScrollPort.prototype.scheduleRedraw=function(){if(!this.timeouts_.redraw){var a=this;this.timeouts_.redraw=setTimeout(function(){delete a.timeouts_.redraw;a.redraw_()},0)}};
hterm.ScrollPort.prototype.redraw_=function(){this.resetSelectBags_();this.selection.sync();this.syncScrollHeight();this.currentRowNodeCache_={};var a=this.getTopRowIndex(),b=this.getBottomRowIndex(a);this.drawTopFold_(a);this.drawBottomFold_(b);this.drawVisibleRows_(a,b);this.syncRowNodesDimensions_();this.previousRowNodeCache_=this.currentRowNodeCache_;this.currentRowNodeCache_=null;this.isScrolledEnd=this.getTopRowIndex()+this.visibleRowCount>=this.lastRowCount_};
hterm.ScrollPort.prototype.drawTopFold_=function(a){if(!this.selection.startRow||this.selection.startRow.rowIndex>=a)this.rowNodes_.firstChild!=this.topFold_&&this.rowNodes_.insertBefore(this.topFold_,this.rowNodes_.firstChild);else{if(!this.selection.isMultiline||this.selection.endRow.rowIndex>=a)this.selection.startRow.nextSibling!=this.topFold_&&this.rowNodes_.insertBefore(this.topFold_,this.selection.startRow.nextSibling);else for(this.selection.endRow.nextSibling!=this.topFold_&&this.rowNodes_.insertBefore(this.topFold_,
this.selection.endRow.nextSibling);this.selection.startRow.nextSibling!=this.selection.endRow;)this.rowNodes_.removeChild(this.selection.startRow.nextSibling);for(;this.rowNodes_.firstChild!=this.selection.startRow;)this.rowNodes_.removeChild(this.rowNodes_.firstChild)}};
hterm.ScrollPort.prototype.drawBottomFold_=function(a){if(!this.selection.endRow||this.selection.endRow.rowIndex<=a)this.rowNodes_.lastChild!=this.bottomFold_&&this.rowNodes_.appendChild(this.bottomFold_);else{if(!this.selection.isMultiline||this.selection.startRow.rowIndex<=a)this.bottomFold_.nextSibling!=this.selection.endRow&&this.rowNodes_.insertBefore(this.bottomFold_,this.selection.endRow);else for(this.bottomFold_.nextSibling!=this.selection.startRow&&this.rowNodes_.insertBefore(this.bottomFold_,
this.selection.startRow);this.selection.startRow.nextSibling!=this.selection.endRow;)this.rowNodes_.removeChild(this.selection.startRow.nextSibling);for(;this.rowNodes_.lastChild!=this.selection.endRow;)this.rowNodes_.removeChild(this.rowNodes_.lastChild)}};
hterm.ScrollPort.prototype.drawVisibleRows_=function(a,b){function c(a,b){for(;a!=b;){if(!a)throw"Did not encounter target node";if(a==d.bottomFold_)throw"Encountered bottom fold before target node";var c=a;a=a.nextSibling;c.parentNode.removeChild(c)}}var d=this;b=this.selection.startRow;for(var e=this.selection.endRow,g=this.bottomFold_,h=this.topFold_.nextSibling,l=Math.min(this.visibleRowCount,this.rowProvider_.getRowCount()),n=0;n<l;n++){var m=a+n;if(h==g){var p=this.fetchRowNode_(m);if(!p){console.log("Couldn't fetch row index: "+
m);break}this.rowNodes_.insertBefore(p,h)}else if(h.rowIndex==m)h=h.nextSibling;else if(b&&b.rowIndex==m)c(h,b),h=b.nextSibling;else if(e&&e.rowIndex==m)c(h,e),h=e.nextSibling;else if(h==b||h==e){p=this.fetchRowNode_(m);if(!p){console.log("Couldn't fetch row index: "+m);break}this.rowNodes_.insertBefore(p,h)}else{p=this.fetchRowNode_(m);if(!p){console.log("Couldn't fetch row index: "+m);break}if(h==p)h=h.nextSibling;else{this.rowNodes_.insertBefore(p,h);if(!p.nextSibling)debugger;this.rowNodes_.removeChild(h);
h=p.nextSibling}}}h!=this.bottomFold_&&c(h,g)};hterm.ScrollPort.prototype.resetSelectBags_=function(){this.topSelectBag_.parentNode&&(this.topSelectBag_.textContent="",this.topSelectBag_.parentNode.removeChild(this.topSelectBag_));this.bottomSelectBag_.parentNode&&(this.bottomSelectBag_.textContent="",this.bottomSelectBag_.parentNode.removeChild(this.bottomSelectBag_))};hterm.ScrollPort.prototype.cacheRowNode_=function(a){this.currentRowNodeCache_[a.rowIndex]=a};
hterm.ScrollPort.prototype.fetchRowNode_=function(a){a=this.previousRowNodeCache_&&a in this.previousRowNodeCache_?this.previousRowNodeCache_[a]:this.rowProvider_.getRowNode(a);this.currentRowNodeCache_&&this.cacheRowNode_(a);return a};
hterm.ScrollPort.prototype.selectAll=function(){if(0!=this.topFold_.nextSibling.rowIndex){for(;this.topFold_.previousSibling;)this.rowNodes_.removeChild(this.topFold_.previousSibling);var a=this.fetchRowNode_(0);this.rowNodes_.insertBefore(a,this.topFold_);this.syncRowNodesDimensions_()}else a=this.topFold_.nextSibling;var b=this.rowProvider_.getRowCount()-1;if(this.bottomFold_.previousSibling.rowIndex!=b){for(;this.bottomFold_.nextSibling;)this.rowNodes_.removeChild(this.bottomFold_.nextSibling);
b=this.fetchRowNode_(b);this.rowNodes_.appendChild(b)}else b=this.bottomFold_.previousSibling.rowIndex;var c=this.document_.getSelection();c.collapse(a,0);c.extend(b,b.childNodes.length);this.selection.sync()};hterm.ScrollPort.prototype.getScrollMax_=function(a){return hterm.getClientHeight(this.scrollArea_)+this.visibleRowTopMargin+this.visibleRowBottomMargin-hterm.getClientHeight(this.screen_)};
hterm.ScrollPort.prototype.scrollRowToTop=function(a){this.syncScrollHeight();this.isScrolledEnd=a+this.visibleRowCount>=this.lastRowCount_;a=a*this.characterSize.height+this.visibleRowTopMargin;var b=this.getScrollMax_();a>b&&(a=b);this.screen_.scrollTop!=a&&(this.screen_.scrollTop=a,this.scheduleRedraw())};
hterm.ScrollPort.prototype.scrollRowToBottom=function(a){this.syncScrollHeight();this.isScrolledEnd=a+this.visibleRowCount>=this.lastRowCount_;a=a*this.characterSize.height+this.visibleRowTopMargin+this.visibleRowBottomMargin;a-=this.visibleRowCount*this.characterSize.height;0>a&&(a=0);this.screen_.scrollTop!=a&&(this.screen_.scrollTop=a)};hterm.ScrollPort.prototype.getTopRowIndex=function(){return Math.round(this.screen_.scrollTop/this.characterSize.height)};
hterm.ScrollPort.prototype.getBottomRowIndex=function(a){return a+this.visibleRowCount-1};hterm.ScrollPort.prototype.onScroll_=function(a){a=this.getScreenSize();a.width!=this.lastScreenWidth_||a.height!=this.lastScreenHeight_?this.resize():(this.redraw_(),this.publish("scroll",{scrollPort:this}))};hterm.ScrollPort.prototype.onScrollWheel=function(a){};
hterm.ScrollPort.prototype.onScrollWheel_=function(a){this.onScrollWheel(a);if(!a.defaultPrevented){var b=this.scrollWheelDelta(a);b=this.screen_.scrollTop-b;0>b&&(b=0);var c=this.getScrollMax_();b>c&&(b=c);b!=this.screen_.scrollTop&&(this.screen_.scrollTop=b,a.preventDefault())}};
hterm.ScrollPort.prototype.scrollWheelDelta=function(a){switch(a.deltaMode){case WheelEvent.DOM_DELTA_PIXEL:var b=a.deltaY*this.scrollWheelMultiplier_;break;case WheelEvent.DOM_DELTA_LINE:b=a.deltaY*this.characterSize.height;break;case WheelEvent.DOM_DELTA_PAGE:b=a.deltaY*this.characterSize.height*this.screen_.getHeight()}return-1*b};hterm.ScrollPort.prototype.onTouch=function(a){};
hterm.ScrollPort.prototype.onTouch_=function(a){this.onTouch(a);if(!a.defaultPrevented){var b=function(a){return{id:a.identifier,y:a.clientY,x:a.clientX}},c;switch(a.type){case "touchstart":for(c=0;c<a.changedTouches.length;++c){var d=b(a.changedTouches[c]);this.lastTouch_[d.id]=d}break;case "touchcancel":case "touchend":for(c=0;c<a.changedTouches.length;++c)delete this.lastTouch_[a.changedTouches[c].identifier];break;case "touchmove":var e=0;for(c=0;c<a.changedTouches.length;++c)d=b(a.changedTouches[c]),
e+=this.lastTouch_[d.id].y-d.y,this.lastTouch_[d.id]=d;b=this.screen_.scrollTop- -1*e;0>b&&(b=0);c=this.getScrollMax_();b>c&&(b=c);b!=this.screen_.scrollTop&&(this.screen_.scrollTop=b)}a.preventDefault()}};hterm.ScrollPort.prototype.onResize_=function(a){this.syncCharacterSize()};hterm.ScrollPort.prototype.onCopy=function(a){};
hterm.ScrollPort.prototype.onCopy_=function(a){this.onCopy(a);if(!a.defaultPrevented&&(this.resetSelectBags_(),this.selection.sync(),this.selection.startRow&&!(2>this.selection.endRow.rowIndex-this.selection.startRow.rowIndex))){a=this.getTopRowIndex();var b=this.getBottomRowIndex(a);this.selection.startRow.rowIndex<a&&(this.topSelectBag_.textContent=this.rowProvider_.getRowsText(this.selection.startRow.rowIndex+1,this.selection.endRow.rowIndex<a?this.selection.endRow.rowIndex:this.topFold_.nextSibling.rowIndex),
this.rowNodes_.insertBefore(this.topSelectBag_,this.selection.startRow.nextSibling),this.syncRowNodesDimensions_());this.selection.endRow.rowIndex>b&&(this.bottomSelectBag_.textContent=this.rowProvider_.getRowsText(this.selection.startRow.rowIndex>b?this.selection.startRow.rowIndex+1:this.bottomFold_.previousSibling.rowIndex+1,this.selection.endRow.rowIndex),this.rowNodes_.insertBefore(this.bottomSelectBag_,this.selection.endRow))}};
hterm.ScrollPort.prototype.onBodyKeyDown_=function(a){if(this.ctrlVPaste){var b=String.fromCharCode(a.which).toLowerCase();(a.ctrlKey||a.metaKey)&&"v"==b&&this.pasteTarget_.focus()}};hterm.ScrollPort.prototype.onPaste_=function(a){this.pasteTarget_.focus();var b=this;setTimeout(function(){b.publish("paste",{text:b.pasteTarget_.value});b.pasteTarget_.value="";b.screen_.focus()},0)};hterm.ScrollPort.prototype.handlePasteTargetTextInput_=function(a){a.stopPropagation()};
hterm.ScrollPort.prototype.onDragAndDrop_=function(a){a.preventDefault();var b,c;a.shiftKey&&(a.dataTransfer.types.forEach(function(a){!c&&"text/plain"!=a&&a.startsWith("text/")&&(c=a)}),c&&(b=a.dataTransfer.getData(c)));b||(b=a.dataTransfer.getData("text/plain"));b&&this.publish("paste",{text:b})};hterm.ScrollPort.prototype.setScrollbarVisible=function(a){this.screen_.style.overflowY=a?"scroll":"hidden"};
hterm.ScrollPort.prototype.setScrollWheelMoveMultipler=function(a){this.scrollWheelMultiplier_=a};"use strict";lib.rtdep("lib.colors","lib.PreferenceManager","lib.resource","lib.wc","lib.f","hterm.Keyboard","hterm.Options","hterm.PreferenceManager","hterm.Screen","hterm.ScrollPort","hterm.Size","hterm.TextAttributes","hterm.VT");
hterm.Terminal=function(a){this.profileId_=null;this.primaryScreen_=new hterm.Screen;this.alternateScreen_=new hterm.Screen;this.screen_=this.primaryScreen_;this.screenSize=new hterm.Size(0,0);this.scrollPort_=new hterm.ScrollPort(this);this.scrollPort_.subscribe("resize",this.onResize_.bind(this));this.scrollPort_.subscribe("scroll",this.onScroll_.bind(this));this.scrollPort_.subscribe("paste",this.onPaste_.bind(this));this.scrollPort_.onCopy=this.onCopy_.bind(this);this.div_=null;this.document_=
window.document;this.scrollbackRows_=[];this.tabStops_=[];this.defaultTabStops=!0;this.cursorNode_=this.vtScrollBottom_=this.vtScrollTop_=null;this.cursorShape_=hterm.Terminal.cursorShape.BLOCK;this.cursorColor_=null;this.cursorBlinkCycle_=[100,100];this.myOnCursorBlink_=this.onCursorBlink_.bind(this);this.scrollWheelArrowKeys_=this.scrollOnKeystroke_=this.scrollOnOutput_=this.foregroundColor_=this.backgroundColor_=null;this.defeatMouseReports_=!1;this.bellAudio_=this.document_.createElement("audio");
this.bellAudio_.id="hterm:bell-audio";this.bellAudio_.setAttribute("preload","auto");this.bellNotificationList_=[];this.desktopNotificationBell_=!1;this.savedOptions_={};this.options_=new hterm.Options;this.timeouts_={};this.vt=new hterm.VT(this);this.saveCursorAndState(!0);this.keyboard=new hterm.Keyboard(this);this.io=new hterm.Terminal.IO(this);this.enableMouseDragScroll=!0;this.mousePasteButton=this.mouseRightClickPaste=this.copyOnSelect=null;this.useDefaultWindowCopy=!1;this.clearSelectionAfterCopy=
!0;this.realizeSize_(80,24);this.setDefaultTabStops();this.allowImagesInline=null;this.reportFocus=!1;this.setProfile(a||"default",function(){this.onTerminalReady()}.bind(this))};hterm.Terminal.cursorShape={BLOCK:"BLOCK",BEAM:"BEAM",UNDERLINE:"UNDERLINE"};hterm.Terminal.prototype.onTerminalReady=function(){};hterm.Terminal.prototype.tabWidth=8;
hterm.Terminal.prototype.setProfile=function(a,b){this.profileId_=a.replace(/\//g,"");var c=this;this.prefs_&&this.prefs_.deactivate();this.prefs_=new hterm.PreferenceManager(this.profileId_);this.prefs_.addObservers(null,{"alt-gr-mode":function(a){a=null==a?"en-us"==navigator.language.toLowerCase()?"none":"right-alt":"string"==typeof a?a.toLowerCase():"none";/^(none|ctrl-alt|left-alt|right-alt)$/.test(a)||(a="none");c.keyboard.altGrMode=a},"alt-backspace-is-meta-backspace":function(a){c.keyboard.altBackspaceIsMetaBackspace=
a},"alt-is-meta":function(a){c.keyboard.altIsMeta=a},"alt-sends-what":function(a){/^(escape|8-bit|browser-key)$/.test(a)||(a="escape");c.keyboard.altSendsWhat=a},"audible-bell-sound":function(a){var b=a.match(/^lib-resource:(\S+)/);b?c.bellAudio_.setAttribute("src",lib.resource.getDataUrl(b[1])):c.bellAudio_.setAttribute("src",a)},"desktop-notification-bell":function(a){a&&Notification?(c.desktopNotificationBell_="granted"===Notification.permission,c.desktopNotificationBell_||console.warn("desktop-notification-bell is true but we do not have permission to display notifications.")):
c.desktopNotificationBell_=!1},"background-color":function(a){c.setBackgroundColor(a)},"background-image":function(a){c.scrollPort_.setBackgroundImage(a)},"background-size":function(a){c.scrollPort_.setBackgroundSize(a)},"background-position":function(a){c.scrollPort_.setBackgroundPosition(a)},"backspace-sends-backspace":function(a){c.keyboard.backspaceSendsBackspace=a},"character-map-overrides":function(a){null==a||a instanceof Object?(c.vt.characterMaps.reset(),c.vt.characterMaps.setOverrides(a)):
console.warn("Preference character-map-modifications is not an object: "+a)},"cursor-blink":function(a){c.setCursorBlink(!!a)},"cursor-blink-cycle":function(a){c.cursorBlinkCycle_=a instanceof Array&&"number"==typeof a[0]&&"number"==typeof a[1]?a:"number"==typeof a?[a,a]:[100,100]},"cursor-color":function(a){c.setCursorColor(a)},"color-palette-overrides":function(a){if(null==a||a instanceof Object||a instanceof Array){lib.colors.colorPalette=lib.colors.stockColorPalette.concat();if(a)for(var b in a){var d=
parseInt(b);if(isNaN(d)||0>d||255<d)console.log("Invalid value in palette: "+b+": "+a[b]);else if(a[d]){var h=lib.colors.normalizeCSS(a[d]);h&&(lib.colors.colorPalette[d]=h)}}c.primaryScreen_.textAttributes.resetColorPalette();c.alternateScreen_.textAttributes.resetColorPalette()}else console.warn("Preference color-palette-overrides is not an array or object: "+a)},"copy-on-select":function(a){c.copyOnSelect=!!a},"use-default-window-copy":function(a){c.useDefaultWindowCopy=!!a},"clear-selection-after-copy":function(a){c.clearSelectionAfterCopy=
!!a},"ctrl-plus-minus-zero-zoom":function(a){c.keyboard.ctrlPlusMinusZeroZoom=a},"ctrl-c-copy":function(a){c.keyboard.ctrlCCopy=a},"ctrl-v-paste":function(a){c.keyboard.ctrlVPaste=a;c.scrollPort_.setCtrlVPaste(a)},"east-asian-ambiguous-as-two-column":function(a){lib.wc.regardCjkAmbiguous=a},"enable-8-bit-control":function(a){c.vt.enable8BitControl=!!a},"enable-bold":function(a){c.syncBoldSafeState()},"enable-bold-as-bright":function(a){c.primaryScreen_.textAttributes.enableBoldAsBright=!!a;c.alternateScreen_.textAttributes.enableBoldAsBright=
!!a},"enable-blink":function(a){c.setTextBlink(!!a)},"enable-clipboard-write":function(a){c.vt.enableClipboardWrite=!!a},"enable-dec12":function(a){c.vt.enableDec12=!!a},"font-family":function(a){c.syncFontFamily()},"font-size":function(a){a=parseInt(a);0>=a?console.error("Invalid font size: "+a):c.setFontSize(a)},"font-smoothing":function(a){c.syncFontFamily()},"foreground-color":function(a){c.setForegroundColor(a)},"home-keys-scroll":function(a){c.keyboard.homeKeysScroll=a},keybindings:function(a){c.keyboard.bindings.clear();
if(a)if(a instanceof Object)try{c.keyboard.bindings.addBindings(a)}catch(e){console.error("Error in keybindings preference: "+e)}else console.error("Error in keybindings preference: Expected object")},"media-keys-are-fkeys":function(a){c.keyboard.mediaKeysAreFKeys=a},"meta-sends-escape":function(a){c.keyboard.metaSendsEscape=a},"mouse-right-click-paste":function(a){c.mouseRightClickPaste=a},"mouse-paste-button":function(a){c.syncMousePasteButton()},"page-keys-scroll":function(a){c.keyboard.pageKeysScroll=
a},"pass-alt-number":function(a){null==a&&(a="mac"!=hterm.os&&"popup"!=hterm.windowType);c.passAltNumber=a},"pass-ctrl-number":function(a){null==a&&(a="mac"!=hterm.os&&"popup"!=hterm.windowType);c.passCtrlNumber=a},"pass-meta-number":function(a){null==a&&(a="mac"==hterm.os&&"popup"!=hterm.windowType);c.passMetaNumber=a},"pass-meta-v":function(a){c.keyboard.passMetaV=a},"receive-encoding":function(a){/^(utf-8|raw)$/.test(a)||(console.warn('Invalid value for "receive-encoding": '+a),a="utf-8");c.vt.characterEncoding=
a},"scroll-on-keystroke":function(a){c.scrollOnKeystroke_=a},"scroll-on-output":function(a){c.scrollOnOutput_=a},"scrollbar-visible":function(a){c.setScrollbarVisible(a)},"scroll-wheel-may-send-arrow-keys":function(a){c.scrollWheelArrowKeys_=a},"scroll-wheel-move-multiplier":function(a){c.setScrollWheelMoveMultipler(a)},"send-encoding":function(a){/^(utf-8|raw)$/.test(a)||(console.warn('Invalid value for "send-encoding": '+a),a="utf-8");c.keyboard.characterEncoding=a},"shift-insert-paste":function(a){c.keyboard.shiftInsertPaste=
a},"terminal-encoding":function(a){c.vt.setEncoding(a)},"user-css":function(a){c.scrollPort_.setUserCssUrl(a)},"user-css-text":function(a){c.scrollPort_.setUserCssText(a)},"word-break-match-left":function(a){c.primaryScreen_.wordBreakMatchLeft=a;c.alternateScreen_.wordBreakMatchLeft=a},"word-break-match-right":function(a){c.primaryScreen_.wordBreakMatchRight=a;c.alternateScreen_.wordBreakMatchRight=a},"word-break-match-middle":function(a){c.primaryScreen_.wordBreakMatchMiddle=a;c.alternateScreen_.wordBreakMatchMiddle=
a},"allow-images-inline":function(a){c.allowImagesInline=a}});this.prefs_.readStorage(function(){this.prefs_.notifyAll();b&&b()}.bind(this))};hterm.Terminal.prototype.getPrefs=function(){return this.prefs_};hterm.Terminal.prototype.setBracketedPaste=function(a){this.options_.bracketedPaste=a};hterm.Terminal.prototype.setCursorColor=function(a){void 0===a&&(a=this.prefs_.get("cursor-color"));this.cursorColor_=a;this.cursorNode_.style.backgroundColor=a;this.cursorNode_.style.borderColor=a};
hterm.Terminal.prototype.getCursorColor=function(){return this.cursorColor_};hterm.Terminal.prototype.setSelectionEnabled=function(a){this.enableMouseDragScroll=a};
hterm.Terminal.prototype.setBackgroundColor=function(a){void 0===a&&(a=this.prefs_.get("background-color"));this.backgroundColor_=lib.colors.normalizeCSS(a);this.primaryScreen_.textAttributes.setDefaults(this.foregroundColor_,this.backgroundColor_);this.alternateScreen_.textAttributes.setDefaults(this.foregroundColor_,this.backgroundColor_);this.scrollPort_.setBackgroundColor(a)};hterm.Terminal.prototype.getBackgroundColor=function(){return this.backgroundColor_};
hterm.Terminal.prototype.setForegroundColor=function(a){void 0===a&&(a=this.prefs_.get("foreground-color"));this.foregroundColor_=lib.colors.normalizeCSS(a);this.primaryScreen_.textAttributes.setDefaults(this.foregroundColor_,this.backgroundColor_);this.alternateScreen_.textAttributes.setDefaults(this.foregroundColor_,this.backgroundColor_);this.scrollPort_.setForegroundColor(a)};hterm.Terminal.prototype.getForegroundColor=function(){return this.foregroundColor_};
hterm.Terminal.prototype.runCommandClass=function(a,b){var c=this.prefs_.get("environment");if("object"!=typeof c||null==c)c={};var d=this;this.command=new a({argString:b||"",io:this.io.push(),environment:c,onExit:function(a){d.io.pop();d.uninstallKeyboard();d.prefs_.get("close-on-exit")&&window.close()}});this.installKeyboard();this.command.run()};hterm.Terminal.prototype.isPrimaryScreen=function(){return this.screen_==this.primaryScreen_};hterm.Terminal.prototype.installKeyboard=function(){this.keyboard.installKeyboard(this.scrollPort_.getDocument().body)};
hterm.Terminal.prototype.uninstallKeyboard=function(){this.keyboard.installKeyboard(null)};hterm.Terminal.prototype.setCssVar=function(a,b,c){this.document_.documentElement.style.setProperty(""+(void 0===c?"--hterm-":c)+a,b)};hterm.Terminal.prototype.getCssVar=function(a,b){return this.document_.documentElement.style.getPropertyValue(""+(void 0===b?"--hterm-":b)+a)};
hterm.Terminal.prototype.setFontSize=function(a){0>=a&&(a=this.prefs_.get("font-size"));this.scrollPort_.setFontSize(a);this.setCssVar("charsize-width",this.scrollPort_.characterSize.width+"px");this.setCssVar("charsize-height",this.scrollPort_.characterSize.height+"px")};hterm.Terminal.prototype.getFontSize=function(){return this.scrollPort_.getFontSize()};hterm.Terminal.prototype.getFontFamily=function(){return this.scrollPort_.getFontFamily()};
hterm.Terminal.prototype.syncFontFamily=function(){this.scrollPort_.setFontFamily(this.prefs_.get("font-family"),this.prefs_.get("font-smoothing"));this.syncBoldSafeState()};hterm.Terminal.prototype.syncMousePasteButton=function(){var a=this.prefs_.get("mouse-paste-button");this.mousePasteButton="number"==typeof a?a:"linux"!=hterm.os?1:2};
hterm.Terminal.prototype.syncBoldSafeState=function(){var a=this.prefs_.get("enable-bold");if(null===a){a=this.scrollPort_.measureCharacterSize();var b=this.scrollPort_.measureCharacterSize("bold");(a=a.equals(b))||console.warn("Bold characters disabled: Size of bold weight differs from normal.  Font family is: "+this.scrollPort_.getFontFamily())}this.primaryScreen_.textAttributes.enableBold=a;this.alternateScreen_.textAttributes.enableBold=a};
hterm.Terminal.prototype.setTextBlink=function(a){void 0===a&&(a=this.prefs_.get("enable-blink"));this.setCssVar("blink-node-duration",a?"0.7s":"0")};hterm.Terminal.prototype.syncMouseStyle=function(){this.setCssVar("mouse-cursor-style",this.vt.mouseReport==this.vt.MOUSE_REPORT_DISABLED?"var(--hterm-mouse-cursor-text)":"var(--hterm-mouse-cursor-pointer)")};hterm.Terminal.prototype.saveCursor=function(){return this.screen_.cursorPosition.clone()};hterm.Terminal.prototype.getTextAttributes=function(){return this.screen_.textAttributes};
hterm.Terminal.prototype.setTextAttributes=function(a){this.screen_.textAttributes=a};hterm.Terminal.prototype.getZoomFactor=function(){return this.scrollPort_.characterSize.zoomFactor};hterm.Terminal.prototype.setWindowTitle=function(a){window.document.title=a};
hterm.Terminal.prototype.restoreCursor=function(a){var b=lib.f.clamp(a.row,0,this.screenSize.height-1),c=lib.f.clamp(a.column,0,this.screenSize.width-1);this.screen_.setCursorPosition(b,c);if(a.column>c||a.column==c&&a.overflow)this.screen_.cursorPosition.overflow=!0};hterm.Terminal.prototype.clearCursorOverflow=function(){this.screen_.cursorPosition.overflow=!1};
hterm.Terminal.prototype.saveCursorAndState=function(a){a?(this.primaryScreen_.saveCursorAndState(this.vt),this.alternateScreen_.saveCursorAndState(this.vt)):this.screen_.saveCursorAndState(this.vt)};hterm.Terminal.prototype.restoreCursorAndState=function(a){a?(this.primaryScreen_.restoreCursorAndState(this.vt),this.alternateScreen_.restoreCursorAndState(this.vt)):this.screen_.restoreCursorAndState(this.vt)};hterm.Terminal.prototype.setCursorShape=function(a){this.cursorShape_=a;this.restyleCursor_()};
hterm.Terminal.prototype.getCursorShape=function(){return this.cursorShape_};hterm.Terminal.prototype.setWidth=function(a){null==a?this.div_.style.width="100%":(this.div_.style.width=Math.ceil(this.scrollPort_.characterSize.width*a+this.scrollPort_.currentScrollbarWidthPx)+"px",this.realizeSize_(a,this.screenSize.height),this.scheduleSyncCursorPosition_())};
hterm.Terminal.prototype.setHeight=function(a){null==a?this.div_.style.height="100%":(this.div_.style.height=this.scrollPort_.characterSize.height*a+"px",this.realizeSize_(this.screenSize.width,a),this.scheduleSyncCursorPosition_())};hterm.Terminal.prototype.realizeSize_=function(a,b){a!=this.screenSize.width&&this.realizeWidth_(a);b!=this.screenSize.height&&this.realizeHeight_(b);this.io.onTerminalResize_(a,b)};
hterm.Terminal.prototype.realizeWidth_=function(a){if(0>=a)throw Error("Attempt to realize bad width: "+a);var b=a-this.screen_.getWidth();this.screenSize.width=a;this.screen_.setColumnCount(a);if(0<b)this.defaultTabStops&&this.setDefaultTabStops(this.screenSize.width-b);else for(b=this.tabStops_.length-1;0<=b&&!(this.tabStops_[b]<a);b--)this.tabStops_.pop();this.screen_.setColumnCount(this.screenSize.width)};
hterm.Terminal.prototype.realizeHeight_=function(a){if(0>=a)throw Error("Attempt to realize bad height: "+a);var b=a-this.screen_.getHeight();this.screenSize.height=a;a=this.saveCursor();if(0>b){for(b*=-1;b;){var c=this.getRowCount()-1;if(c-this.scrollbackRows_.length==a.row)break;if(this.getRowText(c))break;this.screen_.popRow();b--}c=this.screen_.shiftRows(b);this.scrollbackRows_.push.apply(this.scrollbackRows_,c);a.row=Math.max(a.row-b,0)}else if(0<b){if(b<=this.scrollbackRows_.length){c=Math.min(b,
this.scrollbackRows_.length);var d=this.scrollbackRows_.splice(this.scrollbackRows_.length-c,c);this.screen_.unshiftRows(d);b-=c;a.row+=c}b&&this.appendRows_(b)}this.setVTScrollRegion(null,null);this.restoreCursor(a)};hterm.Terminal.prototype.scrollHome=function(){this.scrollPort_.scrollRowToTop(0)};hterm.Terminal.prototype.scrollEnd=function(){this.scrollPort_.scrollRowToBottom(this.getRowCount())};
hterm.Terminal.prototype.scrollPageUp=function(){var a=this.scrollPort_.getTopRowIndex();this.scrollPort_.scrollRowToTop(a-this.screenSize.height+1)};hterm.Terminal.prototype.scrollPageDown=function(){var a=this.scrollPort_.getTopRowIndex();this.scrollPort_.scrollRowToTop(a+this.screenSize.height-1)};hterm.Terminal.prototype.scrollLineUp=function(){var a=this.scrollPort_.getTopRowIndex();this.scrollPort_.scrollRowToTop(a-1)};
hterm.Terminal.prototype.scrollLineDown=function(){var a=this.scrollPort_.getTopRowIndex();this.scrollPort_.scrollRowToTop(a+1)};hterm.Terminal.prototype.wipeContents=function(){this.scrollbackRows_.length=0;this.scrollPort_.resetCache();[this.primaryScreen_,this.alternateScreen_].forEach(function(a){var b=a.getHeight();0<b&&(this.renumberRows_(0,b),this.clearHome(a))}.bind(this));this.syncCursorPosition_();this.scrollPort_.invalidate()};
hterm.Terminal.prototype.reset=function(){var a=this;this.vt.reset();this.clearAllTabStops();this.setDefaultTabStops();var b=function(b){b.textAttributes.reset();b.textAttributes.resetColorPalette();a.clearHome(b);b.saveCursorAndState(a.vt)};b(this.primaryScreen_);b(this.alternateScreen_);this.options_=new hterm.Options;this.setCursorBlink(!!this.prefs_.get("cursor-blink"));this.setVTScrollRegion(null,null);this.setCursorVisible(!0)};
hterm.Terminal.prototype.softReset=function(){var a=this;this.vt.reset();this.options_=new hterm.Options;this.options_.cursorBlink=!!this.timeouts_.cursorBlink;var b=function(b){b.textAttributes.reset();b.textAttributes.resetColorPalette();b.saveCursorAndState(a.vt)};b(this.primaryScreen_);b(this.alternateScreen_);this.setVTScrollRegion(null,null);this.setCursorVisible(!0)};
hterm.Terminal.prototype.forwardTabStop=function(){for(var a=this.screen_.cursorPosition.column,b=0;b<this.tabStops_.length;b++)if(this.tabStops_[b]>a){this.setCursorColumn(this.tabStops_[b]);return}a=this.screen_.cursorPosition.overflow;this.setCursorColumn(this.screenSize.width-1);this.screen_.cursorPosition.overflow=a};
hterm.Terminal.prototype.backwardTabStop=function(){for(var a=this.screen_.cursorPosition.column,b=this.tabStops_.length-1;0<=b;b--)if(this.tabStops_[b]<a){this.setCursorColumn(this.tabStops_[b]);return}this.setCursorColumn(1)};hterm.Terminal.prototype.setTabStop=function(a){for(var b=this.tabStops_.length-1;0<=b;b--){if(this.tabStops_[b]==a)return;if(this.tabStops_[b]<a){this.tabStops_.splice(b+1,0,a);return}}this.tabStops_.splice(0,0,a)};
hterm.Terminal.prototype.clearTabStopAtCursor=function(){var a=this.tabStops_.indexOf(this.screen_.cursorPosition.column);-1!=a&&this.tabStops_.splice(a,1)};hterm.Terminal.prototype.clearAllTabStops=function(){this.tabStops_.length=0;this.defaultTabStops=!1};hterm.Terminal.prototype.setDefaultTabStops=function(a){var b=a||0;a=this.tabWidth;for(b=b-1-(b-1)%a+a;b<this.screenSize.width;b+=a)this.setTabStop(b);this.defaultTabStops=!0};
hterm.Terminal.prototype.interpret=function(a){this.vt.interpret(a);this.scheduleSyncCursorPosition_()};
hterm.Terminal.prototype.decorate=function(a){var b=a.ownerDocument.characterSet.toLowerCase();"utf-8"!=b&&console.warn('Document encoding should be set to utf-8, not "'+b+"\"; Add <meta charset='utf-8'/> to your HTML <head> to fix.");this.div_=a;this.scrollPort_.decorate(a);this.scrollPort_.setBackgroundImage(this.prefs_.get("background-image"));this.scrollPort_.setBackgroundSize(this.prefs_.get("background-size"));this.scrollPort_.setBackgroundPosition(this.prefs_.get("background-position"));this.scrollPort_.setUserCssUrl(this.prefs_.get("user-css"));
this.scrollPort_.setUserCssText(this.prefs_.get("user-css-text"));this.div_.focus=this.focus.bind(this);this.setFontSize(this.prefs_.get("font-size"));this.syncFontFamily();this.setScrollbarVisible(this.prefs_.get("scrollbar-visible"));this.setScrollWheelMoveMultipler(this.prefs_.get("scroll-wheel-move-multiplier"));this.document_=this.scrollPort_.getDocument();this.document_.body.oncontextmenu=function(){return!1};var c=this.onMouse_.bind(this);a=this.scrollPort_.getScreenNode();a.addEventListener("mousedown",
c);a.addEventListener("mouseup",c);a.addEventListener("mousemove",c);this.scrollPort_.onScrollWheel=c;a.addEventListener("focus",this.onFocusChange_.bind(this,!0));a.addEventListener("mousedown",function(){setTimeout(this.onFocusChange_.bind(this,!0))}.bind(this));a.addEventListener("blur",this.onFocusChange_.bind(this,!1));a=this.document_.createElement("style");a.textContent='.cursor-node[focus="false"] {  box-sizing: border-box;  background-color: transparent !important;  border-width: 2px;  border-style: solid;}.wc-node {  display: inline-block;  text-align: center;  width: calc(var(--hterm-charsize-width) * 2);  line-height: var(--hterm-charsize-height);}:root {  --hterm-charsize-width: '+
this.scrollPort_.characterSize.width+"px;  --hterm-charsize-height: "+this.scrollPort_.characterSize.height+"px;  --hterm-cursor-offset-col: -1;  --hterm-cursor-offset-row: -1;  --hterm-blink-node-duration: 0.7s;  --hterm-mouse-cursor-text: text;  --hterm-mouse-cursor-pointer: default;  --hterm-mouse-cursor-style: var(--hterm-mouse-cursor-text);}.uri-node:hover {  text-decoration: underline;  cursor: pointer;}@keyframes blink {  from { opacity: 1.0; }  to { opacity: 0.0; }}.blink-node {  animation-name: blink;  animation-duration: var(--hterm-blink-node-duration);  animation-iteration-count: infinite;  animation-timing-function: ease-in-out;  animation-direction: alternate;}";
this.document_.head.appendChild(a);this.cursorNode_=this.document_.createElement("div");this.cursorNode_.id="hterm:terminal-cursor";this.cursorNode_.className="cursor-node";this.cursorNode_.style.cssText="position: absolute;left: calc(var(--hterm-charsize-width) * var(--hterm-cursor-offset-col));top: calc(var(--hterm-charsize-height) * var(--hterm-cursor-offset-row));display: block;width: var(--hterm-charsize-width);height: var(--hterm-charsize-height);-webkit-transition: opacity, background-color 100ms linear;-moz-transition: opacity, background-color 100ms linear;";
this.setCursorColor();this.setCursorBlink(!!this.prefs_.get("cursor-blink"));this.restyleCursor_();this.document_.body.appendChild(this.cursorNode_);this.scrollBlockerNode_=this.document_.createElement("div");this.scrollBlockerNode_.id="hterm:mouse-drag-scroll-blocker";this.scrollBlockerNode_.style.cssText="position: absolute;top: -99px;display: block;width: 10px;height: 10px;";this.document_.body.appendChild(this.scrollBlockerNode_);this.scrollPort_.onScrollWheel=c;["mousedown","mouseup","mousemove",
"click","dblclick"].forEach(function(a){this.scrollBlockerNode_.addEventListener(a,c);this.cursorNode_.addEventListener(a,c);this.document_.addEventListener(a,c)}.bind(this));this.cursorNode_.addEventListener("mousedown",function(){setTimeout(this.focus.bind(this))}.bind(this));this.setReverseVideo(!1);this.scrollPort_.focus();this.scrollPort_.scheduleRedraw()};hterm.Terminal.prototype.getDocument=function(){return this.document_};hterm.Terminal.prototype.focus=function(){this.scrollPort_.focus()};
hterm.Terminal.prototype.getRowNode=function(a){return a<this.scrollbackRows_.length?this.scrollbackRows_[a]:this.screen_.rowsArray[a-this.scrollbackRows_.length]};hterm.Terminal.prototype.getRowsText=function(a,b){for(var c=[];a<b;a++){var d=this.getRowNode(a);c.push(d.textContent);a<b-1&&!d.getAttribute("line-overflow")&&c.push("\n")}return c.join("")};hterm.Terminal.prototype.getRowText=function(a){return this.getRowNode(a).textContent};
hterm.Terminal.prototype.getRowCount=function(){return this.scrollbackRows_.length+this.screen_.rowsArray.length};
hterm.Terminal.prototype.appendRows_=function(a){for(var b=this.screen_.rowsArray.length,c=this.scrollbackRows_.length+b,d=0;d<a;d++){var e=this.document_.createElement("x-row");e.appendChild(this.document_.createTextNode(""));e.rowIndex=c+d;this.screen_.pushRow(e)}a=this.screen_.rowsArray.length-this.screenSize.height;0<a&&(a=this.screen_.shiftRows(a),Array.prototype.push.apply(this.scrollbackRows_,a),this.scrollPort_.isScrolledEnd&&this.scheduleScrollDown_());b>=this.screen_.rowsArray.length&&(b=
this.screen_.rowsArray.length-1);this.setAbsoluteCursorPosition(b,0)};hterm.Terminal.prototype.moveRows_=function(a,b,c){var d=this.screen_.removeRows(a,b);this.screen_.insertRows(c,d);a<c?(d=a,a=c+b):(d=c,a+=b);this.renumberRows_(d,a);this.scrollPort_.scheduleInvalidate()};hterm.Terminal.prototype.renumberRows_=function(a,b,c){c=c||this.screen_;for(var d=this.scrollbackRows_.length;a<b;a++)c.rowsArray[a].rowIndex=d+a};
hterm.Terminal.prototype.print=function(a){var b=0,c=lib.wc.strWidth(a);for(0==c&&a&&(c=1);b<c;){this.options_.wraparound&&this.screen_.cursorPosition.overflow&&(this.screen_.commitLineOverflow(),this.newLine());var d=c-b,e=!1;this.screen_.cursorPosition.column+d>=this.screenSize.width&&(e=!0,d=this.screenSize.width-this.screen_.cursorPosition.column);e&&!this.options_.wraparound?(e=lib.wc.substr(a,b,d-1)+lib.wc.substr(a,c-1),d=c):e=lib.wc.substr(a,b,d);e=hterm.TextAttributes.splitWidecharString(e);
for(var g=0;g<e.length;g++)this.screen_.textAttributes.wcNode=e[g].wcNode,this.screen_.textAttributes.asciiNode=e[g].asciiNode,this.options_.insertMode?this.screen_.insertString(e[g].str,e[g].wcStrWidth):this.screen_.overwriteString(e[g].str,e[g].wcStrWidth),this.screen_.textAttributes.wcNode=!1,this.screen_.textAttributes.asciiNode=!0;this.screen_.maybeClipCurrentRow();b+=d}this.scheduleSyncCursorPosition_();this.scrollOnOutput_&&this.scrollPort_.scrollRowToBottom(this.getRowCount())};
hterm.Terminal.prototype.setVTScrollRegion=function(a,b){0==a&&b==this.screenSize.height-1?this.vtScrollBottom_=this.vtScrollTop_=null:(this.vtScrollTop_=a,this.vtScrollBottom_=b)};hterm.Terminal.prototype.getVTScrollTop=function(){return null!=this.vtScrollTop_?this.vtScrollTop_:0};hterm.Terminal.prototype.getVTScrollBottom=function(){return null!=this.vtScrollBottom_?this.vtScrollBottom_:this.screenSize.height-1};
hterm.Terminal.prototype.newLine=function(){var a=this.screen_.cursorPosition.row==this.screen_.rowsArray.length-1;null!=this.vtScrollBottom_?this.screen_.cursorPosition.row==this.vtScrollBottom_?(this.vtScrollUp(1),this.setAbsoluteCursorPosition(this.screen_.cursorPosition.row,0)):a?this.setAbsoluteCursorPosition(this.screen_.cursorPosition.row,0):this.setAbsoluteCursorPosition(this.screen_.cursorPosition.row+1,0):a?this.appendRows_(1):this.setAbsoluteCursorPosition(this.screen_.cursorPosition.row+
1,0)};hterm.Terminal.prototype.lineFeed=function(){var a=this.screen_.cursorPosition.column;this.newLine();this.setCursorColumn(a)};hterm.Terminal.prototype.formFeed=function(){this.options_.autoCarriageReturn?this.newLine():this.lineFeed()};hterm.Terminal.prototype.reverseLineFeed=function(){var a=this.getVTScrollTop(),b=this.screen_.cursorPosition.row;b==a?this.insertLines(1):this.setAbsoluteCursorRow(b-1)};
hterm.Terminal.prototype.eraseToLeft=function(){var a=this.saveCursor();this.setCursorColumn(0);var b=a.column+1;this.screen_.overwriteString(lib.f.getWhitespace(b),b);this.restoreCursor(a)};
hterm.Terminal.prototype.eraseToRight=function(a){if(!this.screen_.cursorPosition.overflow){var b=this.screenSize.width-this.screen_.cursorPosition.column;a=a?Math.min(a,b):b;this.screen_.textAttributes.background===this.screen_.textAttributes.DEFAULT_COLOR&&hterm.TextAttributes.nodeWidth(this.screen_.rowsArray[this.screen_.cursorPosition.row])<=this.screen_.cursorPosition.column+a?this.screen_.deleteChars(a):(b=this.saveCursor(),this.screen_.overwriteString(lib.f.getWhitespace(a),a),this.restoreCursor(b));
this.clearCursorOverflow()}};hterm.Terminal.prototype.eraseLine=function(){var a=this.saveCursor();this.screen_.clearCursorRow();this.restoreCursor(a);this.clearCursorOverflow()};hterm.Terminal.prototype.eraseAbove=function(){var a=this.saveCursor();this.eraseToLeft();for(var b=0;b<a.row;b++)this.setAbsoluteCursorPosition(b,0),this.screen_.clearCursorRow();this.restoreCursor(a);this.clearCursorOverflow()};
hterm.Terminal.prototype.eraseBelow=function(){var a=this.saveCursor();this.eraseToRight();for(var b=this.screenSize.height-1,c=a.row+1;c<=b;c++)this.setAbsoluteCursorPosition(c,0),this.screen_.clearCursorRow();this.restoreCursor(a);this.clearCursorOverflow()};
hterm.Terminal.prototype.fill=function(a){var b=this.saveCursor();this.setAbsoluteCursorPosition(0,0);for(var c=0;c<this.screenSize.height;c++)for(var d=0;d<this.screenSize.width;d++)this.setAbsoluteCursorPosition(c,d),this.screen_.overwriteString(a,1);this.restoreCursor(b)};hterm.Terminal.prototype.clearHome=function(a){a=a||this.screen_;var b=a.getHeight();if(0!=b){for(var c=0;c<b;c++)a.setCursorPosition(c,0),a.clearCursorRow();a.setCursorPosition(0,0)}};
hterm.Terminal.prototype.clear=function(a){a=a||this.screen_;var b=a.cursorPosition.clone();this.clearHome(a);a.setCursorPosition(b.row,b.column)};hterm.Terminal.prototype.insertLines=function(a){var b=this.screen_.cursorPosition.row,c=this.getVTScrollBottom();a=Math.min(a,c-b);(c=c-b-a+1)&&this.moveRows_(b,c,b+a);for(--a;0<=a;a--)this.setAbsoluteCursorPosition(b+a,0),this.screen_.clearCursorRow()};
hterm.Terminal.prototype.deleteLines=function(a){var b=this.saveCursor(),c=b.row,d=this.getVTScrollBottom(),e=d-c+1;a=Math.min(a,e);d=d-a+1;a!=e&&this.moveRows_(c,a,d);for(c=0;c<a;c++)this.setAbsoluteCursorPosition(d+c,0),this.screen_.clearCursorRow();this.restoreCursor(b);this.clearCursorOverflow()};hterm.Terminal.prototype.insertSpace=function(a){var b=this.saveCursor();a=lib.f.getWhitespace(a||1);this.screen_.insertString(a,a.length);this.screen_.maybeClipCurrentRow();this.restoreCursor(b);this.clearCursorOverflow()};
hterm.Terminal.prototype.deleteChars=function(a){if((a=this.screen_.deleteChars(a))&&!this.screen_.textAttributes.isDefault()){var b=this.saveCursor();this.setCursorColumn(this.screenSize.width-a);this.screen_.insertString(lib.f.getWhitespace(a));this.restoreCursor(b)}this.clearCursorOverflow()};hterm.Terminal.prototype.vtScrollUp=function(a){var b=this.saveCursor();this.setAbsoluteCursorRow(this.getVTScrollTop());this.deleteLines(a);this.restoreCursor(b)};
hterm.Terminal.prototype.vtScrollDown=function(a){var b=this.saveCursor();this.setAbsoluteCursorPosition(this.getVTScrollTop(),0);this.insertLines(a);this.restoreCursor(b)};hterm.Terminal.prototype.setCursorPosition=function(a,b){this.options_.originMode?this.setRelativeCursorPosition(a,b):this.setAbsoluteCursorPosition(a,b)};
hterm.Terminal.prototype.setRelativeCursorPosition=function(a,b){var c=this.getVTScrollTop();a=lib.f.clamp(a+c,c,this.getVTScrollBottom());b=lib.f.clamp(b,0,this.screenSize.width-1);this.screen_.setCursorPosition(a,b)};hterm.Terminal.prototype.setAbsoluteCursorPosition=function(a,b){a=lib.f.clamp(a,0,this.screenSize.height-1);b=lib.f.clamp(b,0,this.screenSize.width-1);this.screen_.setCursorPosition(a,b)};
hterm.Terminal.prototype.setCursorColumn=function(a){this.setAbsoluteCursorPosition(this.screen_.cursorPosition.row,a)};hterm.Terminal.prototype.getCursorColumn=function(){return this.screen_.cursorPosition.column};hterm.Terminal.prototype.setAbsoluteCursorRow=function(a){this.setAbsoluteCursorPosition(a,this.screen_.cursorPosition.column)};hterm.Terminal.prototype.getCursorRow=function(){return this.screen_.cursorPosition.row};
hterm.Terminal.prototype.scheduleRedraw_=function(){if(!this.timeouts_.redraw){var a=this;this.timeouts_.redraw=setTimeout(function(){delete a.timeouts_.redraw;a.scrollPort_.redraw_()},0)}};hterm.Terminal.prototype.scheduleScrollDown_=function(){if(!this.timeouts_.scrollDown){var a=this;this.timeouts_.scrollDown=setTimeout(function(){delete a.timeouts_.scrollDown;a.scrollPort_.scrollRowToBottom(a.getRowCount())},10)}};hterm.Terminal.prototype.cursorUp=function(a){return this.cursorDown(-(a||1))};
hterm.Terminal.prototype.cursorDown=function(a){a=a||1;var b=this.options_.originMode?this.getVTScrollTop():0,c=this.options_.originMode?this.getVTScrollBottom():this.screenSize.height-1;a=lib.f.clamp(this.screen_.cursorPosition.row+a,b,c);this.setAbsoluteCursorRow(a)};
hterm.Terminal.prototype.cursorLeft=function(a){a=a||1;if(!(1>a)){var b=this.screen_.cursorPosition.column;if(this.options_.reverseWraparound){if(this.screen_.cursorPosition.overflow&&(a--,this.clearCursorOverflow(),!a))return;var c=this.screen_.cursorPosition.row;b-=a;0>b&&(c=c-Math.floor(a/this.screenSize.width)-1,0>c&&(c=this.screenSize.height+c%this.screenSize.height),b=this.screenSize.width+b%this.screenSize.width);this.setCursorPosition(Math.max(c,0),b)}else b=Math.max(b-a,0),this.setCursorColumn(b)}};
hterm.Terminal.prototype.cursorRight=function(a){a=a||1;1>a||(a=lib.f.clamp(this.screen_.cursorPosition.column+a,0,this.screenSize.width-1),this.setCursorColumn(a))};hterm.Terminal.prototype.setReverseVideo=function(a){(this.options_.reverseVideo=a)?(this.scrollPort_.setForegroundColor(this.prefs_.get("background-color")),this.scrollPort_.setBackgroundColor(this.prefs_.get("foreground-color"))):(this.scrollPort_.setForegroundColor(this.prefs_.get("foreground-color")),this.scrollPort_.setBackgroundColor(this.prefs_.get("background-color")))};
hterm.Terminal.prototype.ringBell=function(){this.cursorNode_.style.backgroundColor=this.scrollPort_.getForegroundColor();var a=this;setTimeout(function(){a.restyleCursor_()},200);if(!this.bellSquelchTimeout_&&(this.bellAudio_.getAttribute("src")?(this.bellAudio_.play(),this.bellSequelchTimeout_=setTimeout(function(){delete this.bellSquelchTimeout_}.bind(this),500)):delete this.bellSquelchTimeout_,this.desktopNotificationBell_&&!this.document_.hasFocus())){var b=hterm.notify();this.bellNotificationList_.push(b);
b.onclick=function(){a.closeBellNotifications_()}}};hterm.Terminal.prototype.setOriginMode=function(a){this.options_.originMode=a;this.setCursorPosition(0,0)};hterm.Terminal.prototype.setInsertMode=function(a){this.options_.insertMode=a};hterm.Terminal.prototype.setAutoCarriageReturn=function(a){this.options_.autoCarriageReturn=a};hterm.Terminal.prototype.setWraparound=function(a){this.options_.wraparound=a};
hterm.Terminal.prototype.setReverseWraparound=function(a){this.options_.reverseWraparound=a};
hterm.Terminal.prototype.setAlternateMode=function(a){var b=this.saveCursor();this.screen_=a?this.alternateScreen_:this.primaryScreen_;if(this.screen_.rowsArray.length&&this.screen_.rowsArray[0].rowIndex!=this.scrollbackRows_.length){a=this.scrollbackRows_.length;for(var c=this.screen_.rowsArray,d=0;d<c.length;d++)c[d].rowIndex=a+d}this.realizeWidth_(this.screenSize.width);this.realizeHeight_(this.screenSize.height);this.scrollPort_.syncScrollHeight();this.scrollPort_.invalidate();this.restoreCursor(b);
this.scrollPort_.resize()};hterm.Terminal.prototype.setCursorBlink=function(a){this.options_.cursorBlink=a;!a&&this.timeouts_.cursorBlink&&(clearTimeout(this.timeouts_.cursorBlink),delete this.timeouts_.cursorBlink);this.options_.cursorVisible&&this.setCursorVisible(!0)};
hterm.Terminal.prototype.setCursorVisible=function(a){if(this.options_.cursorVisible=a)if(this.syncCursorPosition_(),this.cursorNode_.style.opacity="1",this.options_.cursorBlink){if(!this.timeouts_.cursorBlink)this.onCursorBlink_()}else this.timeouts_.cursorBlink&&(clearTimeout(this.timeouts_.cursorBlink),delete this.timeouts_.cursorBlink);else this.timeouts_.cursorBlink&&(clearTimeout(this.timeouts_.cursorBlink),delete this.timeouts_.cursorBlink),this.cursorNode_.style.opacity="0"};
hterm.Terminal.prototype.syncCursorPosition_=function(){var a=this.scrollPort_.getTopRowIndex(),b=this.scrollPort_.getBottomRowIndex(a),c=this.scrollbackRows_.length+this.screen_.cursorPosition.row;c>b?this.setCssVar("cursor-offset-row","-1"):(this.options_.cursorVisible&&"none"==this.cursorNode_.style.display&&(this.cursorNode_.style.display=""),this.setCssVar("cursor-offset-row",c-a+" + "+(this.scrollPort_.visibleRowTopMargin+"px")),this.setCssVar("cursor-offset-col",this.screen_.cursorPosition.column),
this.cursorNode_.setAttribute("title","("+this.screen_.cursorPosition.column+", "+this.screen_.cursorPosition.row+")"),(a=this.document_.getSelection())&&a.isCollapsed&&this.screen_.syncSelectionCaret(a))};
hterm.Terminal.prototype.restyleCursor_=function(){var a=this.cursorShape_;"false"==this.cursorNode_.getAttribute("focus")&&(a=hterm.Terminal.cursorShape.BLOCK);var b=this.cursorNode_.style;switch(a){case hterm.Terminal.cursorShape.BEAM:b.height="var(--hterm-charsize-height)";b.backgroundColor="transparent";b.borderBottomStyle=null;b.borderLeftStyle="solid";break;case hterm.Terminal.cursorShape.UNDERLINE:b.height=this.scrollPort_.characterSize.baseline+"px";b.backgroundColor="transparent";b.borderBottomStyle=
"solid";b.borderLeftStyle=null;break;default:b.height="var(--hterm-charsize-height)",b.backgroundColor=this.cursorColor_,b.borderBottomStyle=null,b.borderLeftStyle=null}};hterm.Terminal.prototype.scheduleSyncCursorPosition_=function(){if(!this.timeouts_.syncCursor){var a=this;this.timeouts_.syncCursor=setTimeout(function(){a.syncCursorPosition_();delete a.timeouts_.syncCursor},0)}};
hterm.Terminal.prototype.showZoomWarning_=function(a){if(!this.zoomWarningNode_){if(!a)return;this.zoomWarningNode_=this.document_.createElement("div");this.zoomWarningNode_.id="hterm:zoom-warning";this.zoomWarningNode_.style.cssText="color: black;background-color: #ff2222;font-size: large;border-radius: 8px;opacity: 0.75;padding: 0.2em 0.5em 0.2em 0.5em;top: 0.5em;right: 1.2em;position: absolute;-webkit-text-size-adjust: none;-webkit-user-select: none;-moz-text-size-adjust: none;-moz-user-select: none;";
this.zoomWarningNode_.addEventListener("click",function(a){this.parentNode.removeChild(this)})}this.zoomWarningNode_.textContent=lib.MessageManager.replaceReferences(hterm.zoomWarningMessage,[parseInt(100*this.scrollPort_.characterSize.zoomFactor)]);this.zoomWarningNode_.style.fontFamily=this.prefs_.get("font-family");a?this.zoomWarningNode_.parentNode||this.div_.parentNode.appendChild(this.zoomWarningNode_):this.zoomWarningNode_.parentNode&&this.zoomWarningNode_.parentNode.removeChild(this.zoomWarningNode_)};
hterm.Terminal.prototype.showOverlay=function(a,b){var c=this;if(!this.overlayNode_){if(!this.div_)return;this.overlayNode_=this.document_.createElement("div");this.overlayNode_.style.cssText="border-radius: 15px;font-size: xx-large;opacity: 0.75;padding: 0.2em 0.5em 0.2em 0.5em;position: absolute;-webkit-user-select: none;-webkit-transition: opacity 180ms ease-in;-moz-user-select: none;-moz-transition: opacity 180ms ease-in;";this.overlayNode_.addEventListener("mousedown",function(a){a.preventDefault();
a.stopPropagation()},!0)}this.overlayNode_.style.color=this.prefs_.get("background-color");this.overlayNode_.style.backgroundColor=this.prefs_.get("foreground-color");this.overlayNode_.style.fontFamily=this.prefs_.get("font-family");this.overlayNode_.textContent=a;this.overlayNode_.style.opacity="0.75";this.overlayNode_.parentNode||this.div_.appendChild(this.overlayNode_);a=hterm.getClientSize(this.div_);var d=hterm.getClientSize(this.overlayNode_);this.overlayNode_.style.top=(a.height-d.height)/
2+"px";this.overlayNode_.style.left=(a.width-d.width-this.scrollPort_.currentScrollbarWidthPx)/2+"px";this.overlayTimeout_&&clearTimeout(this.overlayTimeout_);null!==b&&(this.overlayTimeout_=setTimeout(function(){c.overlayNode_.style.opacity="0";c.overlayTimeout_=setTimeout(function(){return c.hideOverlay()},200)},b||1500))};
hterm.Terminal.prototype.hideOverlay=function(){this.overlayTimeout_&&clearTimeout(this.overlayTimeout_);this.overlayTimeout_=null;this.overlayNode_.parentNode&&this.overlayNode_.parentNode.removeChild(this.overlayNode_);this.overlayNode_.style.opacity="0.75"};hterm.Terminal.prototype.paste=function(){return hterm.pasteFromClipboard(this.document_)};
hterm.Terminal.prototype.copyStringToClipboard=function(a){this.prefs_.get("enable-clipboard-notice")&&setTimeout(this.showOverlay.bind(this,hterm.notifyCopyMessage,500),200);var b=this.document_.createElement("pre");b.id="hterm:copy-to-clipboard-source";b.textContent=a;b.style.cssText="-webkit-user-select: text;-moz-user-select: text;position: absolute;top: -99px";this.document_.body.appendChild(b);a=this.document_.getSelection();var c=a.anchorNode,d=a.anchorOffset,e=a.focusNode,g=a.focusOffset;
a.selectAllChildren(b);hterm.copySelectionToClipboard(this.document_);a.extend&&(a.collapse(c,d),a.extend(e,g));b.parentNode.removeChild(b)};
hterm.Terminal.prototype.displayImage=function(a){var b=this;if(void 0!==a.uri)if(a.name||(a.name=""),!0!==this.allowImagesInline){this.newLine();var c=this.getRowNode(this.scrollbackRows_.length+this.getCursorRow()-1);if(!1===this.allowImagesInline)c.textContent=hterm.msg("POPUP_INLINE_IMAGE_DISABLED",[],"Inline Images Disabled");else{var d=this.document_.createElement("span");d.innerText=hterm.msg("POPUP_INLINE_IMAGE",[],"Inline Images");d.style.fontWeight="bold";d.style.borderWidth="1px";d.style.borderStyle=
"dashed";var e=this.document_.createElement("span");e.innerText=hterm.msg("BUTTON_BLOCK",[],"block");e.style.marginLeft="1em";e.style.borderWidth="1px";e.style.borderStyle="solid";e.addEventListener("click",function(){b.prefs_.set("allow-images-inline",!1)});d.appendChild(e);e=this.document_.createElement("span");e.innerText=hterm.msg("BUTTON_ALLOW_SESSION",[],"allow this session");e.style.marginLeft="1em";e.style.borderWidth="1px";e.style.borderStyle="solid";e.addEventListener("click",function(){b.allowImagesInline=
!0});d.appendChild(e);e=this.document_.createElement("span");e.innerText=hterm.msg("BUTTON_ALLOW_ALWAYS",[],"always allow");e.style.marginLeft="1em";e.style.borderWidth="1px";e.style.borderStyle="solid";e.addEventListener("click",function(){b.prefs_.set("allow-images-inline",!0)});d.appendChild(e);c.appendChild(d)}}else if(a.inline){var g=this.io.push();g.showOverlay(hterm.msg("LOADING_RESOURCE_START",[a.name],"Loading $1 ..."),null);g.onVTKeystroke=g.sendString=function(){};var h=this.document_.createElement("img");
h.src=a.uri;h.title=h.alt=a.name;this.document_.body.appendChild(h);h.onload=function(){h.style.objectFit=a.preserveAspectRatio?"scale-down":"fill";h.style.maxWidth=b.document_.body.clientWidth+"px";h.style.maxHeight=b.document_.body.clientHeight+"px";var c=function(a,b,c){if(!a||"auto"==a)return"";var d=a.match(/^([0-9]+)(px|%)?$/);return d?"%"==d[2]?b*parseInt(d[1])/100+"px":"px"==d[2]?a:"calc("+a+" * var("+c+"))":""};h.style.width=c(a.width,b.document_.body.clientWidth,"--hterm-charsize-width");
h.style.height=c(a.height,b.document_.body.clientHeight,"--hterm-charsize-height");c=Math.ceil(h.clientHeight/b.scrollPort_.characterSize.height);for(var d=0;d<c;++d)b.newLine();h.style.maxHeight="calc("+c+" * var(--hterm-charsize-height))";b.document_.body.removeChild(h);c=b.document_.createElement("div");c.style.position="relative";c.style.textAlign=a.align;h.style.position="absolute";h.style.bottom="calc(0px - var(--hterm-charsize-height))";c.appendChild(h);b.getRowNode(b.scrollbackRows_.length+
b.getCursorRow()-1).appendChild(c);g.hideOverlay();g.pop()};h.onerror=function(c){b.document_.body.removeChild(h);g.showOverlay(hterm.msg("LOADING_RESOURCE_FAILED",[a.name],"Loading $1 failed ..."));g.pop()}}else c=this.document_.createElement("a"),c.href=a.uri,c.download=a.name,this.document_.body.appendChild(c),c.click(),c.remove()};
hterm.Terminal.prototype.getSelectionText=function(){var a=this.scrollPort_.selection;a.sync();if(a.isCollapsed)return null;var b=a.startOffset,c=a.startNode;if("X-ROW"!=c.nodeName)for("#text"==c.nodeName&&"SPAN"==c.parentNode.nodeName&&(c=c.parentNode);c.previousSibling;)c=c.previousSibling,b+=hterm.TextAttributes.nodeWidth(c);var d=hterm.TextAttributes.nodeWidth(a.endNode)-a.endOffset;c=a.endNode;if("X-ROW"!=c.nodeName)for("#text"==c.nodeName&&"SPAN"==c.parentNode.nodeName&&(c=c.parentNode);c.nextSibling;)c=
c.nextSibling,d+=hterm.TextAttributes.nodeWidth(c);a=this.getRowsText(a.startRow.rowIndex,a.endRow.rowIndex+1);return lib.wc.substring(a,b,lib.wc.strWidth(a)-d)};hterm.Terminal.prototype.copySelectionToClipboard=function(){var a=this.getSelectionText();null!=a&&this.copyStringToClipboard(a)};hterm.Terminal.prototype.overlaySize=function(){this.showOverlay(this.screenSize.width+"x"+this.screenSize.height)};
hterm.Terminal.prototype.onVTKeystroke=function(a){this.scrollOnKeystroke_&&this.scrollPort_.scrollRowToBottom(this.getRowCount());this.io.onVTKeystroke(this.keyboard.encode(a))};
hterm.Terminal.prototype.openSelectedUrl_=function(){var a=this.getSelectionText();if(null==a&&(this.screen_.expandSelection(this.document_.getSelection()),a=this.getSelectionText(),null==a))return;if(!(2048<a.length||0<=a.search(/[\s\[\](){}<>"'\\^`]/))){if(0>a.search("^[a-zA-Z][a-zA-Z0-9+.-]*://"))switch(a.split(":",1)[0]){case "mailto":break;default:a="http://"+a}hterm.openUrl(a)}};
hterm.Terminal.prototype.onMouse_=function(a){if(!a.processedByTerminalHandler_){var b=!this.defeatMouseReports_&&this.vt.mouseReport!=this.vt.MOUSE_REPORT_DISABLED;a.processedByTerminalHandler_=!0;a.terminalRow=parseInt((a.clientY-this.scrollPort_.visibleRowTopMargin)/this.scrollPort_.characterSize.height)+1;a.terminalColumn=parseInt(a.clientX/this.scrollPort_.characterSize.width)+1;if(!("mousedown"==a.type&&a.terminalColumn>this.screenSize.width)){this.options_.cursorVisible&&!b&&(a.terminalRow-
1==this.screen_.cursorPosition.row&&a.terminalColumn-1==this.screen_.cursorPosition.column?this.cursorNode_.style.display="none":"none"==this.cursorNode_.style.display&&(this.cursorNode_.style.display=""));"mousedown"==a.type&&(a.altKey||!b?(this.defeatMouseReports_=!0,this.setSelectionEnabled(!0)):(this.defeatMouseReports_=!1,this.document_.getSelection().collapseToEnd(),this.setSelectionEnabled(!1),a.preventDefault()));if(b)this.scrollBlockerNode_.engaged||("mousedown"==a.type?(this.scrollBlockerNode_.engaged=
!0,this.scrollBlockerNode_.style.top=a.clientY-5+"px",this.scrollBlockerNode_.style.left=a.clientX-5+"px"):"mousemove"==a.type&&(this.document_.getSelection().collapseToEnd(),a.preventDefault())),this.onMouse(a);else{"dblclick"==a.type&&this.copyOnSelect&&(this.screen_.expandSelection(this.document_.getSelection()),this.copySelectionToClipboard(this.document_));if("click"==a.type&&!a.shiftKey&&(a.ctrlKey||a.metaKey)){clearTimeout(this.timeouts_.openUrl);this.timeouts_.openUrl=setTimeout(this.openSelectedUrl_.bind(this),
500);return}"mousedown"==a.type&&(this.mouseRightClickPaste&&2==a.button||a.button==this.mousePasteButton)&&(this.paste()||console.warn("Could not paste manually due to web restrictions"));"mouseup"==a.type&&0==a.button&&this.copyOnSelect&&!this.document_.getSelection().isCollapsed&&this.copySelectionToClipboard(this.document_);"mousemove"!=a.type&&"mouseup"!=a.type||!this.scrollBlockerNode_.engaged||(this.scrollBlockerNode_.engaged=!1,this.scrollBlockerNode_.style.top="-99px");if(this.scrollWheelArrowKeys_&&
!a.shiftKey&&this.keyboard.applicationCursor&&!this.isPrimaryScreen()&&"wheel"==a.type){b=this.scrollPort_.scrollWheelDelta(a);var c=lib.f.smartFloorDivide(Math.abs(b),this.scrollPort_.characterSize.height);this.io.sendString(("\u001bO"+(0>b?"B":"A")).repeat(c));a.preventDefault()}}"mouseup"==a.type&&this.document_.getSelection().isCollapsed&&(this.defeatMouseReports_=!1)}}};hterm.Terminal.prototype.onMouse=function(a){};
hterm.Terminal.prototype.onFocusChange_=function(a){this.cursorNode_.setAttribute("focus",a);this.restyleCursor_();this.reportFocus&&this.io.sendString(!0===a?"\u001b[I":"\u001b[O");!0===a&&this.closeBellNotifications_()};hterm.Terminal.prototype.onScroll_=function(){this.scheduleSyncCursorPosition_()};hterm.Terminal.prototype.onPaste_=function(a){a=a.text.replace(/\n/mg,"\r");a=this.keyboard.encode(a);this.options_.bracketedPaste&&(a="\u001b[200~"+a+"\u001b[201~");this.io.sendString(a)};
hterm.Terminal.prototype.onCopy_=function(a){this.useDefaultWindowCopy||(a.preventDefault(),setTimeout(this.copySelectionToClipboard.bind(this),0))};
hterm.Terminal.prototype.onResize_=function(){var a=Math.floor(this.scrollPort_.getScreenWidth()/this.scrollPort_.characterSize.width)||0,b=lib.f.smartFloorDivide(this.scrollPort_.getScreenHeight(),this.scrollPort_.characterSize.height)||0;if(!(0>=a||0>=b)){var c=a!=this.screenSize.width||b!=this.screenSize.height;this.realizeSize_(a,b);this.showZoomWarning_(1!=this.scrollPort_.characterSize.zoomFactor);c&&this.overlaySize();this.restyleCursor_();this.scheduleSyncCursorPosition_()}};
hterm.Terminal.prototype.onCursorBlink_=function(){this.options_.cursorBlink?"false"==this.cursorNode_.getAttribute("focus")||"0"==this.cursorNode_.style.opacity?(this.cursorNode_.style.opacity="1",this.timeouts_.cursorBlink=setTimeout(this.myOnCursorBlink_,this.cursorBlinkCycle_[0])):(this.cursorNode_.style.opacity="0",this.timeouts_.cursorBlink=setTimeout(this.myOnCursorBlink_,this.cursorBlinkCycle_[1])):delete this.timeouts_.cursorBlink};hterm.Terminal.prototype.setScrollbarVisible=function(a){this.scrollPort_.setScrollbarVisible(a)};
hterm.Terminal.prototype.setScrollWheelMoveMultipler=function(a){this.scrollPort_.setScrollWheelMoveMultipler(a)};hterm.Terminal.prototype.closeBellNotifications_=function(){this.bellNotificationList_.forEach(function(a){a.close()});this.bellNotificationList_.length=0};"use strict";lib.rtdep("lib.encodeUTF8");hterm.Terminal.IO=function(a){this.terminal_=a;this.previousIO_=null;this.buffered_=""};hterm.Terminal.IO.prototype.showOverlay=function(a,b){this.terminal_.showOverlay(a,b)};
hterm.Terminal.IO.prototype.hideOverlay=function(){this.terminal_.hideOverlay()};hterm.Terminal.IO.prototype.createFrame=function(a,b){return new hterm.Frame(this.terminal_,a,b)};hterm.Terminal.IO.prototype.setTerminalProfile=function(a){this.terminal_.setProfile(a)};
hterm.Terminal.IO.prototype.push=function(){var a=new hterm.Terminal.IO(this.terminal_);a.keyboardCaptured_=this.keyboardCaptured_;a.columnCount=this.columnCount;a.rowCount=this.rowCount;a.previousIO_=this.terminal_.io;return this.terminal_.io=a};hterm.Terminal.IO.prototype.pop=function(){this.terminal_.io=this.previousIO_;this.previousIO_.flush()};hterm.Terminal.IO.prototype.flush=function(){this.buffered_&&(this.terminal_.interpret(this.buffered_),this.buffered_="")};
hterm.Terminal.IO.prototype.sendString=function(a){console.log("Unhandled sendString: "+a)};hterm.Terminal.IO.prototype.onVTKeystroke=function(a){console.log("Unobserverd VT keystroke: "+JSON.stringify(a))};hterm.Terminal.IO.prototype.onTerminalResize_=function(a,b){for(var c=this;c;)c.columnCount=a,c.rowCount=b,c=c.previousIO_;this.onTerminalResize(a,b)};hterm.Terminal.IO.prototype.onTerminalResize=function(a,b){};
hterm.Terminal.IO.prototype.writeUTF8=function(a){this.terminal_.io!=this?this.buffered_+=a:this.terminal_.interpret(a)};hterm.Terminal.IO.prototype.writelnUTF8=function(a){this.writeUTF8(a+"\r\n")};hterm.Terminal.IO.prototype.print=hterm.Terminal.IO.prototype.writeUTF16=function(a){this.writeUTF8(lib.encodeUTF8(a))};hterm.Terminal.IO.prototype.println=hterm.Terminal.IO.prototype.writelnUTF16=function(a){this.writelnUTF8(lib.encodeUTF8(a))};"use strict";lib.rtdep("lib.colors");
hterm.TextAttributes=function(a){this.document_=a;this.underlineSource=this.backgroundSource=this.foregroundSource=this.SRC_DEFAULT;this.underlineColor=this.background=this.foreground=this.DEFAULT_COLOR;this.defaultForeground="rgb(255, 255, 255)";this.defaultBackground="rgb(0, 0, 0)";this.wcNode=this.invisible=this.inverse=this.strikethrough=this.underline=this.blink=this.italic=this.faint=this.bold=!1;this.asciiNode=!0;this.colorPalette=this.uriId=this.uri=this.tileData=null;this.resetColorPalette()};
hterm.TextAttributes.prototype.enableBold=!0;hterm.TextAttributes.prototype.enableBoldAsBright=!0;hterm.TextAttributes.prototype.DEFAULT_COLOR=lib.f.createEnum("");hterm.TextAttributes.prototype.SRC_DEFAULT="default";hterm.TextAttributes.prototype.setDocument=function(a){this.document_=a};hterm.TextAttributes.prototype.clone=function(){var a=new hterm.TextAttributes(null),b;for(b in this)a[b]=this[b];a.colorPalette=this.colorPalette.concat();return a};
hterm.TextAttributes.prototype.reset=function(){this.underlineSource=this.backgroundSource=this.foregroundSource=this.SRC_DEFAULT;this.underlineColor=this.background=this.foreground=this.DEFAULT_COLOR;this.wcNode=this.invisible=this.inverse=this.strikethrough=this.underline=this.blink=this.italic=this.faint=this.bold=!1;this.asciiNode=!0;this.uriId=this.uri=null};hterm.TextAttributes.prototype.resetColorPalette=function(){this.colorPalette=lib.colors.colorPalette.concat();this.syncColors()};
hterm.TextAttributes.prototype.isDefault=function(){return this.foregroundSource==this.SRC_DEFAULT&&this.backgroundSource==this.SRC_DEFAULT&&!this.bold&&!this.faint&&!this.italic&&!this.blink&&!this.underline&&!this.strikethrough&&!this.inverse&&!this.invisible&&!this.wcNode&&this.asciiNode&&null==this.tileData&&null==this.uri};
hterm.TextAttributes.prototype.createContainer=function(a){if(this.isDefault())return a=this.document_.createTextNode(a),a.asciiNode=!0,a;var b=this.document_.createElement("span"),c=b.style,d=[];this.foreground!=this.DEFAULT_COLOR&&(c.color=this.foreground);this.background!=this.DEFAULT_COLOR&&(c.backgroundColor=this.background);this.enableBold&&this.bold&&(c.fontWeight="bold");this.faint&&(b.faint=!0);this.italic&&(c.fontStyle="italic");this.blink&&(d.push("blink-node"),b.blinkNode=!0);var e="";
if(b.underline=this.underline)e+=" underline",c.textDecorationStyle=this.underline;this.underlineSource!=this.SRC_DEFAULT&&(c.textDecorationColor=this.underlineColor);this.strikethrough&&(e+=" line-through",b.strikethrough=!0);e&&(c.textDecorationLine=e);this.wcNode&&(d.push("wc-node"),b.wcNode=!0);b.asciiNode=this.asciiNode;null!=this.tileData&&(d.push("tile"),d.push("tile_"+this.tileData),b.tileNode=!0);a&&setNodeText(b,a);this.uri&&(d.push("uri-node"),b.uriId=this.uriId,b.title=this.uri,b.addEventListener("click",
hterm.openUrl.bind(this,this.uri)));d.length&&(b.className=d.join(" "));return b};
hterm.TextAttributes.prototype.matchesContainer=function(a){if("string"==typeof a||a.nodeType==Node.TEXT_NODE)return this.isDefault();var b=a.style;return!(this.wcNode||a.wcNode)&&this.asciiNode==a.asciiNode&&!(null!=this.tileData||a.tileNode)&&this.uriId==a.uriId&&this.foreground==b.color&&this.background==b.backgroundColor&&this.underlineColor==b.textDecorationColor&&(this.enableBold&&this.bold)==!!b.fontWeight&&this.blink==!!a.blinkNode&&this.italic==!!b.fontStyle&&this.underline==a.underline&&
!!this.strikethrough==!!a.strikethrough};hterm.TextAttributes.prototype.setDefaults=function(a,b){this.defaultForeground=a;this.defaultBackground=b;this.syncColors()};
hterm.TextAttributes.prototype.syncColors=function(){var a=this.foregroundSource,b=this.backgroundSource,c=this.DEFAULT_COLOR,d=this.DEFAULT_COLOR;this.inverse&&(a=this.backgroundSource,b=this.foregroundSource,c=this.defaultBackground,d=this.defaultForeground);this.enableBoldAsBright&&this.bold&&Number.isInteger(a)&&8>a&&(a+=8);a==this.SRC_DEFAULT?this.foreground=c:Number.isInteger(a)?this.foreground=this.colorPalette[a]:this.foreground=a;this.faint&&(this.foreground=lib.colors.mix(this.foreground==
this.DEFAULT_COLOR?this.defaultForeground:this.foreground,"rgb(0, 0, 0)",.3333));b==this.SRC_DEFAULT?this.background=d:Number.isInteger(b)?this.background=this.colorPalette[b]:this.background=b;this.invisible&&(this.foreground=this.background);this.underlineSource==this.SRC_DEFAULT?this.underlineColor="":Number.isInteger(this.underlineSource)?this.underlineColor=this.colorPalette[this.underlineSource]:this.underlineColor=this.underlineSource};
hterm.TextAttributes.containersMatch=function(a,b){if("string"==typeof a)return hterm.TextAttributes.containerIsDefault(b);if(a.nodeType!=b.nodeType)return!1;if(a.nodeType==Node.TEXT_NODE)return!0;a=a.style;b=b.style;return a.color==b.color&&a.backgroundColor==b.backgroundColor&&a.backgroundColor==b.backgroundColor&&a.fontWeight==b.fontWeight&&a.fontStyle==b.fontStyle&&a.textDecoration==b.textDecoration&&a.textDecorationColor==b.textDecorationColor&&a.textDecorationStyle==b.textDecorationStyle&&a.textDecorationLine==
b.textDecorationLine};hterm.TextAttributes.containerIsDefault=function(a){return"string"==typeof a||a.nodeType==Node.TEXT_NODE};hterm.TextAttributes.nodeWidth=function(a){return a.asciiNode?a.textContent.length:lib.wc.strWidth(a.textContent)};hterm.TextAttributes.nodeSubstr=function(a,b,c){return a.asciiNode?a.textContent.substr(b,c):lib.wc.substr(a.textContent,b,c)};
hterm.TextAttributes.nodeSubstring=function(a,b,c){return a.asciiNode?a.textContent.substring(b,c):lib.wc.substring(a.textContent,b,c)};
hterm.TextAttributes.splitWidecharString=function(a){for(var b=[],c=0,d=0,e=0,g,h=!0,l=0;l<a.length;){g=a.codePointAt(l);if(128>g){e+=1;d+=1;var n=1}else n=65535>=g?1:2,g=lib.wc.charWidth(g),1>=g?(e+=g,d+=n,h=!1):(d&&(b.push({str:a.substr(c,d),asciiNode:h,wcStrWidth:e}),h=!0,e=0),b.push({str:a.substr(l,n),wcNode:!0,asciiNode:!1,wcStrWidth:2}),c=l+n,d=0);l+=n}d&&b.push({str:a.substr(c,d),asciiNode:h,wcStrWidth:e});return b};"use strict";lib.rtdep("lib.colors","lib.f","lib.UTF8Decoder","hterm.VT.CharacterMap");
hterm.VT=function(a){this.terminal=a;a.onMouse=this.onTerminalMouse_.bind(this);this.mouseReport=this.MOUSE_REPORT_DISABLED;this.mouseCoordinates=this.MOUSE_COORDINATES_X10;this.lastMouseDragResponse_=null;this.parseState_=new hterm.VT.ParseState(this.parseUnknown_);this.trailingModifier_=this.leadingModifier_="";this.allowColumnWidthChanges_=!1;this.oscTimeLimit_=2E4;this.utf8Decoder_=new lib.UTF8Decoder;this.enable8BitControl=!1;this.enableClipboardWrite=!0;this.enableDec12=!1;this.characterEncoding=
"utf-8";this.warnUnimplemented=!1;this.characterMaps=new hterm.VT.CharacterMaps;this.G0=this.G1=this.G2=this.G3=this.characterMaps.getMap("B");this.GR=this.GL="G0";this.codingSystemLocked_=this.codingSystemUtf8_=!1;this.cc1Pattern_=null;this.updateEncodingState_()};hterm.VT.prototype.MOUSE_REPORT_DISABLED=0;hterm.VT.prototype.MOUSE_REPORT_PRESS=1;hterm.VT.prototype.MOUSE_REPORT_CLICK=2;hterm.VT.prototype.MOUSE_REPORT_DRAG=3;hterm.VT.prototype.MOUSE_COORDINATES_X10=0;
hterm.VT.prototype.MOUSE_COORDINATES_UTF8=1;hterm.VT.prototype.MOUSE_COORDINATES_SGR=2;hterm.VT.ParseState=function(a,b){this.defaultFunction=a;this.buf=b||null;this.pos=0;this.func=a;this.args=[];this.subargs=null};hterm.VT.ParseState.prototype.reset=function(a){this.resetParseFunction();this.resetBuf(a||"");this.resetArguments()};hterm.VT.ParseState.prototype.resetParseFunction=function(){this.func=this.defaultFunction};
hterm.VT.ParseState.prototype.resetBuf=function(a){this.buf="string"==typeof a?a:null;this.pos=0};hterm.VT.ParseState.prototype.resetArguments=function(a){this.args.length=0;"undefined"!=typeof a&&(this.args[0]=a)};hterm.VT.ParseState.prototype.parseInt=function(a,b){void 0===b&&(b=0);return a?(a=parseInt(a,10),0==a?b:a):b};hterm.VT.ParseState.prototype.iarg=function(a,b){return this.parseInt(this.args[a],b)};hterm.VT.ParseState.prototype.argHasSubargs=function(a){return this.subargs&&this.subargs[a]};
hterm.VT.ParseState.prototype.argSetSubargs=function(a){null===this.subargs&&(this.subargs={});this.subargs[a]=!0};hterm.VT.ParseState.prototype.advance=function(a){this.pos+=a};hterm.VT.ParseState.prototype.peekRemainingBuf=function(){return this.buf.substr(this.pos)};hterm.VT.ParseState.prototype.peekChar=function(){return this.buf.substr(this.pos,1)};hterm.VT.ParseState.prototype.consumeChar=function(){return this.buf.substr(this.pos++,1)};
hterm.VT.ParseState.prototype.isComplete=function(){return null==this.buf||this.buf.length<=this.pos};hterm.VT.prototype.reset=function(){this.G0=this.G1=this.G2=this.G3=this.characterMaps.getMap("B");this.GR=this.GL="G0";this.mouseReport=this.MOUSE_REPORT_DISABLED;this.mouseCoordinates=this.MOUSE_COORDINATES_X10;this.lastMouseDragResponse_=null};
hterm.VT.prototype.onTerminalMouse_=function(a){if(this.mouseReport!=this.MOUSE_REPORT_DISABLED&&(this.mouseReport==this.MOUSE_REPORT_DRAG||"mousemove"!=a.type)){var b=0;if(this.mouseReport!=this.MOUSE_REPORT_PRESS){a.shiftKey&&(b|=4);if(a.metaKey||this.terminal.keyboard.altIsMeta&&a.altKey)b|=8;a.ctrlKey&&(b|=16)}var c=255;switch(this.mouseCoordinates){case this.MOUSE_COORDINATES_UTF8:c=2047;case this.MOUSE_COORDINATES_X10:var d=String.fromCharCode(lib.f.clamp(a.terminalColumn+32,32,c));var e=String.fromCharCode(lib.f.clamp(a.terminalRow+
32,32,c));break;case this.MOUSE_COORDINATES_SGR:d=a.terminalColumn,e=a.terminalRow}switch(a.type){case "wheel":var g=(0<-1*a.deltaY?0:1)+64;g|=b;g=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?"\u001b[<"+g+";"+d+";"+e+"M":"\u001b[M"+String.fromCharCode(g)+d+e;a.preventDefault();break;case "mousedown":g=Math.min(a.button,2);this.mouseCoordinates!=this.MOUSE_COORDINATES_SGR&&(g+=32);g|=b;g=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?"\u001b[<"+g+";"+d+";"+e+"M":"\u001b[M"+String.fromCharCode(g)+
d+e;break;case "mouseup":this.mouseReport!=this.MOUSE_REPORT_PRESS&&(g=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?"\u001b[<"+a.button+";"+d+";"+e+"m":"\u001b[M#"+d+e);break;case "mousemove":this.mouseReport==this.MOUSE_REPORT_DRAG&&a.buttons&&(g=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?0:32,g=a.buttons&1?g+0:a.buttons&4?g+1:a.buttons&2?g+2:g+3,g=g+32|b,g=this.mouseCoordinates==this.MOUSE_COORDINATES_SGR?"\u001b[<"+g+";"+d+";"+e+"M":"\u001b[M"+String.fromCharCode(g)+d+e,this.lastMouseDragResponse_==
g?g="":this.lastMouseDragResponse_=g);break;case "click":case "dblclick":break;default:console.error("Unknown mouse event: "+a.type,a)}g&&this.terminal.io.sendString(g)}};
hterm.VT.prototype.interpret=function(a){for(this.parseState_.resetBuf(this.decode(a));!this.parseState_.isComplete();){var b=this.parseState_.func,c=this.parseState_.pos;a=this.parseState_.buf;this.parseState_.func.call(this,this.parseState_);if(this.parseState_.func==b&&this.parseState_.pos==c&&this.parseState_.buf==a)throw"Parser did not alter the state!";}};hterm.VT.prototype.decode=function(a){return"utf-8"==this.characterEncoding?this.decodeUTF8(a):a};hterm.VT.prototype.encodeUTF8=function(a){return lib.encodeUTF8(a)};
hterm.VT.prototype.decodeUTF8=function(a){return this.utf8Decoder_.decode(a)};hterm.VT.prototype.setEncoding=function(a){switch(a){default:console.warn('Invalid value for "terminal-encoding": '+a);case "iso-2022":this.codingSystemLocked_=this.codingSystemUtf8_=!1;break;case "utf-8-locked":this.codingSystemLocked_=this.codingSystemUtf8_=!0;break;case "utf-8":this.codingSystemUtf8_=!0,this.codingSystemLocked_=!1}this.updateEncodingState_()};
hterm.VT.prototype.updateEncodingState_=function(){var a=this,b=Object.keys(hterm.VT.CC1).filter(function(b){return!a.codingSystemUtf8_||128>b.charCodeAt()}).map(function(a){return"\\x"+lib.f.zpad(a.charCodeAt().toString(16),2)}).join("");this.cc1Pattern_=new RegExp("["+b+"]")};
hterm.VT.prototype.parseUnknown_=function(a){function b(a){!c.codingSystemUtf8_&&c[c.GL].GL&&(a=c[c.GL].GL(a));c.terminal.print(a)}var c=this,d=a.peekRemainingBuf(),e=d.search(this.cc1Pattern_);0==e?(this.dispatch("CC1",d.substr(0,1),a),a.advance(1)):-1==e?(b(d),a.reset()):(b(d.substr(0,e)),this.dispatch("CC1",d.substr(e,1),a),a.advance(e+1))};
hterm.VT.prototype.parseCSI_=function(a){var b=a.peekChar(),c=a.args,d=function(){a.resetArguments();a.subargs=null;a.resetParseFunction()};"@"<=b&&"~">=b?(this.dispatch("CSI",this.leadingModifier_+this.trailingModifier_+b,a),d()):";"==b?this.trailingModifier_?d():(c.length||c.push(""),c.push("")):"0"<=b&&"9">=b||":"==b?this.trailingModifier_?d():(c.length?c[c.length-1]+=b:c[0]=b,":"==b&&a.argSetSubargs(c.length-1)):" "<=b&&"?">=b?c.length?this.trailingModifier_+=b:this.leadingModifier_+=b:this.cc1Pattern_.test(b)?
this.dispatch("CC1",b,a):d();a.advance(1)};
hterm.VT.prototype.parseUntilStringTerminator_=function(a){var b=a.peekRemainingBuf(),c=a.args,d=0;c.length?"\u001b"==c[0].slice(-1)&&(c[0]=c[0].slice(0,-1),b="\u001b"+b,d=1):(c[0]="",c[1]=new Date);var e=b.search(/[\x1b\x07]/),g=b[e];if("\u001b"==g&&"\\"!=b[e+1]||-1==e){c[0]+=b;var h;"\u001b"==g&&e!=b.length-1&&(h="embedded escape: "+e);new Date-c[1]>this.oscTimeLimit_&&(h="timeout expired: "+(new Date-c[1]));if(h)return this.warnUnimplemented&&console.log("parseUntilStringTerminator_: aborting: "+h,
c[0]),a.reset(c[0]),!1;a.advance(b.length-d);return!0}c[0]+=b.substr(0,e);a.resetParseFunction();a.advance(e+("\u001b"==g?2:1)-d);return!0};
hterm.VT.prototype.dispatch=function(a,b,c){var d=hterm.VT[a][b];d?d==hterm.VT.ignore?this.warnUnimplemented&&console.warn("Ignored "+a+" code: "+JSON.stringify(b)):c.subargs&&!d.supportsSubargs?this.warnUnimplemented&&console.warn("Ignored "+a+" code w/subargs: "+JSON.stringify(b)):"CC1"==a&&"\u007f"<b&&!this.enable8BitControl?console.warn("Ignoring 8-bit control code: 0x"+b.charCodeAt(0).toString(16)):d.apply(this,[c,b]):this.warnUnimplemented&&console.warn("Unknown "+a+" code: "+JSON.stringify(b))};
hterm.VT.prototype.setANSIMode=function(a,b){4==a?this.terminal.setInsertMode(b):20==a?this.terminal.setAutoCarriageReturn(b):this.warnUnimplemented&&console.warn("Unimplemented ANSI Mode: "+a)};
hterm.VT.prototype.setDECMode=function(a,b){switch(parseInt(a,10)){case 1:this.terminal.keyboard.applicationCursor=b;break;case 3:this.allowColumnWidthChanges_&&(this.terminal.setWidth(b?132:80),this.terminal.clearHome(),this.terminal.setVTScrollRegion(null,null));break;case 5:this.terminal.setReverseVideo(b);break;case 6:this.terminal.setOriginMode(b);break;case 7:this.terminal.setWraparound(b);break;case 9:this.mouseReport=b?this.MOUSE_REPORT_PRESS:this.MOUSE_REPORT_DISABLED;this.terminal.syncMouseStyle();
break;case 12:this.enableDec12&&this.terminal.setCursorBlink(b);break;case 25:this.terminal.setCursorVisible(b);break;case 30:this.terminal.setScrollbarVisible(b);break;case 40:this.terminal.allowColumnWidthChanges_=b;break;case 45:this.terminal.setReverseWraparound(b);break;case 67:this.terminal.keyboard.backspaceSendsBackspace=b;break;case 1E3:this.mouseReport=b?this.MOUSE_REPORT_CLICK:this.MOUSE_REPORT_DISABLED;this.terminal.syncMouseStyle();break;case 1002:this.mouseReport=b?this.MOUSE_REPORT_DRAG:
this.MOUSE_REPORT_DISABLED;this.terminal.syncMouseStyle();break;case 1004:this.terminal.reportFocus=b;break;case 1005:this.mouseCoordinates=b?this.MOUSE_COORDINATES_UTF8:this.MOUSE_COORDINATES_X10;break;case 1006:this.mouseCoordinates=b?this.MOUSE_COORDINATES_SGR:this.MOUSE_COORDINATES_X10;break;case 1007:this.terminal.scrollWheelArrowKeys_=b;break;case 1010:this.terminal.scrollOnOutput=b;break;case 1011:this.terminal.scrollOnKeystroke=b;break;case 1036:this.terminal.keyboard.metaSendsEscape=b;break;
case 1039:b?this.terminal.keyboard.previousAltSendsWhat_||(this.terminal.keyboard.previousAltSendsWhat_=this.terminal.keyboard.altSendsWhat,this.terminal.keyboard.altSendsWhat="escape"):this.terminal.keyboard.previousAltSendsWhat_&&(this.terminal.keyboard.altSendsWhat=this.terminal.keyboard.previousAltSendsWhat_,this.terminal.keyboard.previousAltSendsWhat_=null);break;case 47:case 1047:this.terminal.setAlternateMode(b);break;case 1048:b?this.terminal.saveCursorAndState():this.terminal.restoreCursorAndState();
break;case 1049:b?(this.terminal.saveCursorAndState(),this.terminal.setAlternateMode(b),this.terminal.clear()):(this.terminal.setAlternateMode(b),this.terminal.restoreCursorAndState());break;case 2004:this.terminal.setBracketedPaste(b);break;default:this.warnUnimplemented&&console.warn("Unimplemented DEC Private Mode: "+a)}};hterm.VT.ignore=function(){};hterm.VT.CC1={};hterm.VT.ESC={};hterm.VT.CSI={};hterm.VT.OSC={};hterm.VT.VT52={};hterm.VT.CC1["\x00"]=hterm.VT.ignore;hterm.VT.CC1["\u0005"]=hterm.VT.ignore;
hterm.VT.CC1["\u0007"]=function(){this.terminal.ringBell()};hterm.VT.CC1["\b"]=function(){this.terminal.cursorLeft(1)};hterm.VT.CC1["\t"]=function(){this.terminal.forwardTabStop()};hterm.VT.CC1["\n"]=function(){this.terminal.formFeed()};hterm.VT.CC1["\x0B"]=hterm.VT.CC1["\n"];hterm.VT.CC1["\f"]=hterm.VT.CC1["\n"];hterm.VT.CC1["\r"]=function(){this.terminal.setCursorColumn(0)};hterm.VT.CC1["\u000e"]=function(){this.GL="G1"};hterm.VT.CC1["\u000f"]=function(){this.GL="G0"};hterm.VT.CC1["\u0011"]=hterm.VT.ignore;
hterm.VT.CC1["\u0013"]=hterm.VT.ignore;hterm.VT.CC1["\u0018"]=function(a){"G1"==this.GL&&(this.GL="G0");a.resetParseFunction();this.terminal.print("?")};hterm.VT.CC1["\u001a"]=hterm.VT.CC1["\u0018"];hterm.VT.CC1["\u001b"]=function(a){function b(a){var c=a.consumeChar();"\u001b"!=c&&(this.dispatch("ESC",c,a),a.func==b&&a.resetParseFunction())}a.func=b};hterm.VT.CC1["\u007f"]=hterm.VT.ignore;hterm.VT.CC1["\u0084"]=hterm.VT.ESC.D=function(){this.terminal.lineFeed()};
hterm.VT.CC1["\u0085"]=hterm.VT.ESC.E=function(){this.terminal.setCursorColumn(0);this.terminal.cursorDown(1)};hterm.VT.CC1["\u0088"]=hterm.VT.ESC.H=function(){this.terminal.setTabStop(this.terminal.getCursorColumn())};hterm.VT.CC1["\u008d"]=hterm.VT.ESC.M=function(){this.terminal.reverseLineFeed()};hterm.VT.CC1["\u008e"]=hterm.VT.ESC.N=hterm.VT.ignore;hterm.VT.CC1["\u008f"]=hterm.VT.ESC.O=hterm.VT.ignore;hterm.VT.CC1["\u0090"]=hterm.VT.ESC.P=function(a){a.resetArguments();a.func=this.parseUntilStringTerminator_};
hterm.VT.CC1["\u0096"]=hterm.VT.ESC.V=hterm.VT.ignore;hterm.VT.CC1["\u0097"]=hterm.VT.ESC.W=hterm.VT.ignore;hterm.VT.CC1["\u0098"]=hterm.VT.ESC.X=hterm.VT.ignore;hterm.VT.CC1["\u009a"]=hterm.VT.ESC.Z=function(){this.terminal.io.sendString("\u001b[?1;2c")};hterm.VT.CC1["\u009b"]=hterm.VT.ESC["["]=function(a){a.resetArguments();this.trailingModifier_=this.leadingModifier_="";a.func=this.parseCSI_};hterm.VT.CC1["\u009c"]=hterm.VT.ESC["\\"]=hterm.VT.ignore;
hterm.VT.CC1["\u009d"]=hterm.VT.ESC["]"]=function(a){function b(a){if(this.parseUntilStringTerminator_(a)&&a.func!=b){var c=a.args[0].match(/^(\d+);(.*)$/);c?(a.args[0]=c[2],this.dispatch("OSC",c[1],a)):console.warn("Invalid OSC: "+JSON.stringify(a.args[0]));a.resetArguments()}}a.resetArguments();a.func=b};hterm.VT.CC1["\u009e"]=hterm.VT.ESC["^"]=function(a){a.resetArguments();a.func=this.parseUntilStringTerminator_};hterm.VT.CC1["\u009f"]=hterm.VT.ESC._=function(a){a.resetArguments();a.func=this.parseUntilStringTerminator_};
hterm.VT.ESC[" "]=function(a){a.func=function(a){var b=a.consumeChar();this.warnUnimplemented&&console.warn("Unimplemented sequence: ESC 0x20 "+b);a.resetParseFunction()}};hterm.VT.ESC["#"]=function(a){a.func=function(a){"8"==a.consumeChar()&&this.terminal.fill("E");a.resetParseFunction()}};
hterm.VT.ESC["%"]=function(a){a.func=function(a){var b=a.consumeChar();if(this.codingSystemLocked_)"/"==b&&a.consumeChar();else switch(b){case "@":this.setEncoding("iso-2022");break;case "G":this.setEncoding("utf-8");break;case "/":b=a.consumeChar();switch(b){case "G":case "H":case "I":this.setEncoding("utf-8-locked");break;default:this.warnUnimplemented&&console.warn("Unknown ESC % / argument: "+JSON.stringify(b))}break;default:this.warnUnimplemented&&console.warn("Unknown ESC % argument: "+JSON.stringify(b))}a.resetParseFunction()}};
hterm.VT.ESC["("]=hterm.VT.ESC[")"]=hterm.VT.ESC["*"]=hterm.VT.ESC["+"]=hterm.VT.ESC["-"]=hterm.VT.ESC["."]=hterm.VT.ESC["/"]=function(a,b){a.func=function(a){var c=a.consumeChar();if("\u001b"==c)a.resetParseFunction(),a.func();else{var e=this.characterMaps.getMap(c);if(void 0!==e)if("("==b)this.G0=e;else if(")"==b||"-"==b)this.G1=e;else if("*"==b||"."==b)this.G2=e;else{if("+"==b||"/"==b)this.G3=e}else this.warnUnimplemented&&console.log('Invalid character set for "'+b+'": '+c);a.resetParseFunction()}}};
hterm.VT.ESC["6"]=hterm.VT.ignore;hterm.VT.ESC["7"]=function(){this.terminal.saveCursorAndState()};hterm.VT.ESC["8"]=function(){this.terminal.restoreCursorAndState()};hterm.VT.ESC["9"]=hterm.VT.ignore;hterm.VT.ESC["="]=function(){this.terminal.keyboard.applicationKeypad=!0};hterm.VT.ESC[">"]=function(){this.terminal.keyboard.applicationKeypad=!1};hterm.VT.ESC.F=hterm.VT.ignore;hterm.VT.ESC.c=function(){this.terminal.reset()};hterm.VT.ESC.l=hterm.VT.ESC.m=hterm.VT.ignore;
hterm.VT.ESC.n=function(){this.GL="G2"};hterm.VT.ESC.o=function(){this.GL="G3"};hterm.VT.ESC["|"]=function(){this.GR="G3"};hterm.VT.ESC["}"]=function(){this.GR="G2"};hterm.VT.ESC["~"]=function(){this.GR="G1"};hterm.VT.OSC["0"]=function(a){this.terminal.setWindowTitle(a.args[0])};hterm.VT.OSC["2"]=hterm.VT.OSC["0"];
hterm.VT.OSC["4"]=function(a){a=a.args[0].split(";");for(var b=parseInt(a.length/2),c=this.terminal.getTextAttributes().colorPalette,d=[],e=0;e<b;++e){var g=parseInt(a[2*e]),h=a[2*e+1];g>=c.length||("?"==h?(h=lib.colors.rgbToX11(c[g]))&&d.push(g+";"+h):(h=lib.colors.x11ToCSS(h))&&(c[g]=h))}d.length&&this.terminal.io.sendString("\u001b]4;"+d.join(";")+"\u0007")};
hterm.VT.OSC["8"]=function(a){a=a.args[0].split(";");var b=null,c=null;2==a.length&&0!=a[1].length&&(c=a[0].split(":"),b="",c.forEach(function(a){var c=a.indexOf("=");if(-1!=c){var d=a.slice(0,c);a=a.slice(c+1);switch(d){case "id":b=a}}}),c=a[1]);a=this.terminal.getTextAttributes();a.uri=c;a.uriId=b};hterm.VT.OSC["9"]=function(a){hterm.notify({body:a.args[0]})};
hterm.VT.OSC["10"]=function(a){var b=a.args[0].split(";");if(b){var c=lib.colors.x11ToCSS(b.shift());c&&this.terminal.setForegroundColor(c);0<b.length&&(a.args[0]=b.join(";"),hterm.VT.OSC["11"].apply(this,[a]))}};hterm.VT.OSC["11"]=function(a){var b=a.args[0].split(";");if(b){var c=lib.colors.x11ToCSS(b.shift());c&&this.terminal.setBackgroundColor(c);0<b.length&&(a.args[0]=b.join(";"),hterm.VT.OSC["12"].apply(this,[a]))}};
hterm.VT.OSC["12"]=function(a){(a=a.args[0].split(";"))&&(a=lib.colors.x11ToCSS(a.shift()))&&this.terminal.setCursorColor(a)};hterm.VT.OSC["50"]=function(a){var b=a.args[0].match(/CursorShape=(.)/i);if(b)switch(b[1]){case "1":this.terminal.setCursorShape(hterm.Terminal.cursorShape.BEAM);break;case "2":this.terminal.setCursorShape(hterm.Terminal.cursorShape.UNDERLINE);break;default:this.terminal.setCursorShape(hterm.Terminal.cursorShape.BLOCK)}else console.warn("Could not parse OSC 50 args: "+a.args[0])};
hterm.VT.OSC["52"]=function(a){this.enableClipboardWrite&&(a=a.args[0].match(/^[cps01234567]*;(.*)/))&&(a=window.atob(a[1]))&&this.terminal.copyStringToClipboard(this.decode(a))};hterm.VT.OSC["110"]=function(a){this.terminal.setForegroundColor()};hterm.VT.OSC["111"]=function(a){this.terminal.setBackgroundColor()};hterm.VT.OSC["112"]=function(a){this.terminal.setCursorColor()};
hterm.VT.OSC["1337"]=function(a){var b=a.args[0].match(/^File=([^:]*):([\s\S]*)$/m);if(b){var c={name:"",size:0,preserveAspectRatio:!0,inline:!1,width:"auto",height:"auto",align:"left",uri:"data:application/octet-stream;base64,"+b[2].replace(/[\n\r]+/gm,"")};b[1].split(";").forEach(function(a){if(a=a.match(/^([^=]+)=(.*)$/m))switch(a[1]){case "name":try{c.name=window.atob(a[2])}catch(g){}break;case "size":try{c.size=parseInt(a[2])}catch(g){}break;case "width":c.width=a[2];break;case "height":c.height=
a[2];break;case "preserveAspectRatio":c.preserveAspectRatio="0"!=a[2];break;case "inline":c.inline="0"!=a[2];break;case "align":c.align=a[2]}});if(c.inline){b=this.terminal.io;var d=a.peekRemainingBuf();a.advance(d.length);this.terminal.displayImage(c);b.writeUTF8(d)}else this.terminal.displayImage(c)}else this.warnUnimplemented&&console.log("iTerm2 1337: unsupported sequence: "+b[1])};
hterm.VT.OSC["777"]=function(a){switch(a.args[0].split(";",1)[0]){case "notify":if(a=a.args[0].match(/^[^;]+;([^;]*)(;([\s\S]*))?$/)){var b=a[1];var c=a[3]}hterm.notify({title:b,body:c});break;default:console.warn("Unknown urxvt module: "+a.args[0])}};hterm.VT.CSI["@"]=function(a){this.terminal.insertSpace(a.iarg(0,1))};hterm.VT.CSI.A=function(a){this.terminal.cursorUp(a.iarg(0,1))};hterm.VT.CSI.B=function(a){this.terminal.cursorDown(a.iarg(0,1))};
hterm.VT.CSI.C=function(a){this.terminal.cursorRight(a.iarg(0,1))};hterm.VT.CSI.D=function(a){this.terminal.cursorLeft(a.iarg(0,1))};hterm.VT.CSI.E=function(a){this.terminal.cursorDown(a.iarg(0,1));this.terminal.setCursorColumn(0)};hterm.VT.CSI.F=function(a){this.terminal.cursorUp(a.iarg(0,1));this.terminal.setCursorColumn(0)};hterm.VT.CSI.G=function(a){this.terminal.setCursorColumn(a.iarg(0,1)-1)};hterm.VT.CSI.H=function(a){this.terminal.setCursorPosition(a.iarg(0,1)-1,a.iarg(1,1)-1)};
hterm.VT.CSI.I=function(a){a=a.iarg(0,1);a=lib.f.clamp(a,1,this.terminal.screenSize.width);for(var b=0;b<a;b++)this.terminal.forwardTabStop()};hterm.VT.CSI.J=hterm.VT.CSI["?J"]=function(a,b){(a=a.args[0])&&0!=a?1==a?this.terminal.eraseAbove():2==a?this.terminal.clear():3==a&&this.terminal.clear():this.terminal.eraseBelow()};hterm.VT.CSI.K=hterm.VT.CSI["?K"]=function(a,b){(a=a.args[0])&&0!=a?1==a?this.terminal.eraseToLeft():2==a&&this.terminal.eraseLine():this.terminal.eraseToRight()};
hterm.VT.CSI.L=function(a){this.terminal.insertLines(a.iarg(0,1))};hterm.VT.CSI.M=function(a){this.terminal.deleteLines(a.iarg(0,1))};hterm.VT.CSI.P=function(a){this.terminal.deleteChars(a.iarg(0,1))};hterm.VT.CSI.S=function(a){this.terminal.vtScrollUp(a.iarg(0,1))};hterm.VT.CSI.T=function(a){1>=a.args.length&&this.terminal.vtScrollDown(a.iarg(0,1))};hterm.VT.CSI[">T"]=hterm.VT.ignore;hterm.VT.CSI.X=function(a){this.terminal.eraseToRight(a.iarg(0,1))};
hterm.VT.CSI.Z=function(a){a=a.iarg(0,1);a=lib.f.clamp(a,1,this.terminal.screenSize.width);for(var b=0;b<a;b++)this.terminal.backwardTabStop()};hterm.VT.CSI["`"]=hterm.VT.CSI.G;hterm.VT.CSI.a=function(a){this.terminal.setCursorColumn(this.terminal.getCursorColumn()+a.iarg(0,1))};hterm.VT.CSI.b=hterm.VT.ignore;hterm.VT.CSI.c=function(a){a.args[0]&&0!=a.args[0]||this.terminal.io.sendString("\u001b[?1;2c")};hterm.VT.CSI[">c"]=function(a){this.terminal.io.sendString("\u001b[>0;256;0c")};
hterm.VT.CSI.d=function(a){this.terminal.setAbsoluteCursorRow(a.iarg(0,1)-1)};hterm.VT.CSI.f=hterm.VT.CSI.H;hterm.VT.CSI.g=function(a){a.args[0]&&0!=a.args[0]?3==a.args[0]&&this.terminal.clearAllTabStops():this.terminal.clearTabStopAtCursor(!1)};hterm.VT.CSI.h=function(a){for(var b=0;b<a.args.length;b++)this.setANSIMode(a.args[b],!0)};hterm.VT.CSI["?h"]=function(a){for(var b=0;b<a.args.length;b++)this.setDECMode(a.args[b],!0)};hterm.VT.CSI.i=hterm.VT.CSI["?i"]=hterm.VT.ignore;
hterm.VT.CSI.l=function(a){for(var b=0;b<a.args.length;b++)this.setANSIMode(a.args[b],!1)};hterm.VT.CSI["?l"]=function(a){for(var b=0;b<a.args.length;b++)this.setDECMode(a.args[b],!1)};
hterm.VT.prototype.parseSgrExtendedColors=function(a,b,c){if(a.argHasSubargs(b)){b=a.args[b].split(":");b.shift();var d=!0}else{if(a.argHasSubargs(b+1))return{skipCount:0};b=a.args.slice(b+1);d=!1}switch(parseInt(b[0])){default:case 0:return{skipCount:0};case 1:return d?{color:"rgba(0, 0, 0, 0)",skipCount:0}:{skipCount:0};case 2:var e=d?4==b.length?1:2:1;if(b.length<e+3)return{skipCount:0};c=a.parseInt(b[e+0]);var g=a.parseInt(b[e+1]);a=a.parseInt(b[e+2]);return{color:"rgb("+c+", "+g+", "+a+")",skipCount:d?
0:4};case 3:if(!d||4>b.length)return{skipCount:0};a.parseInt(b[1]);a.parseInt(b[2]);a.parseInt(b[3]);return{skipCount:0};case 4:if(!d||5>b.length)return{skipCount:0};a.parseInt(b[1]);a.parseInt(b[2]);a.parseInt(b[3]);a.parseInt(b[4]);return{skipCount:0};case 5:if(2>b.length)return{skipCount:0};d={skipCount:d?0:2};a=a.parseInt(b[1]);a<c.colorPalette.length&&(d.color=a);return d}};
hterm.VT.CSI.m=function(a){var b=this.terminal.getTextAttributes();if(a.args.length){for(var c=0;c<a.args.length;c++){var d=a.iarg(c,0);30>d?0==d?b.reset():1==d?b.bold=!0:2==d?b.faint=!0:3==d?b.italic=!0:4==d?a.argHasSubargs(c)?(d=a.args[c].split(":")[1],0==d?b.underline=!1:1==d?b.underline="solid":2==d?b.underline="double":3==d?b.underline="wavy":4==d?b.underline="dotted":5==d&&(b.underline="dashed")):b.underline="solid":5==d?b.blink=!0:7==d?b.inverse=!0:8==d?b.invisible=!0:9==d?b.strikethrough=
!0:21==d?b.underline="double":22==d?(b.bold=!1,b.faint=!1):23==d?b.italic=!1:24==d?b.underline=!1:25==d?b.blink=!1:27==d?b.inverse=!1:28==d?b.invisible=!1:29==d&&(b.strikethrough=!1):50>d?38>d?b.foregroundSource=d-30:38==d?(d=this.parseSgrExtendedColors(a,c,b),void 0!==d.color&&(b.foregroundSource=d.color),c+=d.skipCount):39==d?b.foregroundSource=b.SRC_DEFAULT:48>d?b.backgroundSource=d-40:48==d?(d=this.parseSgrExtendedColors(a,c,b),void 0!==d.color&&(b.backgroundSource=d.color),c+=d.skipCount):b.backgroundSource=
b.SRC_DEFAULT:58==d?(d=this.parseSgrExtendedColors(a,c,b),void 0!==d.color&&(b.underlineSource=d.color),c+=d.skipCount):59==d?b.underlineSource=b.SRC_DEFAULT:90<=d&&97>=d?b.foregroundSource=d-90+8:100<=d&&107>=d&&(b.backgroundSource=d-100+8)}b.setDefaults(this.terminal.getForegroundColor(),this.terminal.getBackgroundColor())}else b.reset()};hterm.VT.CSI.m.supportsSubargs=!0;hterm.VT.CSI[">m"]=hterm.VT.ignore;
hterm.VT.CSI.n=function(a){if(5==a.args[0])this.terminal.io.sendString("\u001b0n");else if(6==a.args[0]){a=this.terminal.getCursorRow()+1;var b=this.terminal.getCursorColumn()+1;this.terminal.io.sendString("\u001b["+a+";"+b+"R")}};hterm.VT.CSI[">n"]=hterm.VT.ignore;
hterm.VT.CSI["?n"]=function(a){if(6==a.args[0]){a=this.terminal.getCursorRow()+1;var b=this.terminal.getCursorColumn()+1;this.terminal.io.sendString("\u001b["+a+";"+b+"R")}else 15==a.args[0]?this.terminal.io.sendString("\u001b[?11n"):25==a.args[0]?this.terminal.io.sendString("\u001b[?21n"):26==a.args[0]?this.terminal.io.sendString("\u001b[?12;1;0;0n"):53==a.args[0]&&this.terminal.io.sendString("\u001b[?50n")};hterm.VT.CSI[">p"]=hterm.VT.ignore;hterm.VT.CSI["!p"]=function(){this.terminal.softReset()};
hterm.VT.CSI.$p=hterm.VT.ignore;hterm.VT.CSI["?$p"]=hterm.VT.ignore;hterm.VT.CSI['"p']=hterm.VT.ignore;hterm.VT.CSI.q=hterm.VT.ignore;
hterm.VT.CSI[" q"]=function(a){a=a.args[0];0==a||1==a?(this.terminal.setCursorShape(hterm.Terminal.cursorShape.BLOCK),this.terminal.setCursorBlink(!0)):2==a?(this.terminal.setCursorShape(hterm.Terminal.cursorShape.BLOCK),this.terminal.setCursorBlink(!1)):3==a?(this.terminal.setCursorShape(hterm.Terminal.cursorShape.UNDERLINE),this.terminal.setCursorBlink(!0)):4==a?(this.terminal.setCursorShape(hterm.Terminal.cursorShape.UNDERLINE),this.terminal.setCursorBlink(!1)):5==a?(this.terminal.setCursorShape(hterm.Terminal.cursorShape.BEAM),
this.terminal.setCursorBlink(!0)):6==a?(this.terminal.setCursorShape(hterm.Terminal.cursorShape.BEAM),this.terminal.setCursorBlink(!1)):console.warn("Unknown cursor style: "+a)};hterm.VT.CSI['"q']=hterm.VT.ignore;hterm.VT.CSI.r=function(a){var b=a.args;a=b[0]?parseInt(b[0],10)-1:null;b=b[1]?parseInt(b[1],10)-1:null;this.terminal.setVTScrollRegion(a,b);this.terminal.setCursorPosition(0,0)};hterm.VT.CSI["?r"]=hterm.VT.ignore;hterm.VT.CSI.$r=hterm.VT.ignore;hterm.VT.CSI.s=function(){this.terminal.saveCursorAndState()};
hterm.VT.CSI["?s"]=hterm.VT.ignore;hterm.VT.CSI.t=hterm.VT.ignore;hterm.VT.CSI.$t=hterm.VT.ignore;hterm.VT.CSI[">t"]=hterm.VT.ignore;hterm.VT.CSI[" t"]=hterm.VT.ignore;hterm.VT.CSI.u=function(){this.terminal.restoreCursorAndState()};hterm.VT.CSI[" u"]=hterm.VT.ignore;hterm.VT.CSI.$v=hterm.VT.ignore;hterm.VT.CSI["'w"]=hterm.VT.ignore;hterm.VT.CSI.x=hterm.VT.ignore;hterm.VT.CSI["*x"]=hterm.VT.ignore;hterm.VT.CSI.$x=hterm.VT.ignore;
hterm.VT.CSI.z=function(a){if(!(1>a.args.length)){var b=a.args[0];0==b?2>a.args.length||(this.terminal.getTextAttributes().tileData=a.args[1]):1==b&&(this.terminal.getTextAttributes().tileData=null)}};hterm.VT.CSI["'z"]=hterm.VT.ignore;hterm.VT.CSI.$z=hterm.VT.ignore;hterm.VT.CSI["'{"]=hterm.VT.ignore;hterm.VT.CSI["'|"]=hterm.VT.ignore;hterm.VT.CSI["'}"]=hterm.VT.ignore;hterm.VT.CSI["'~"]=hterm.VT.ignore;"use strict";lib.rtdep("lib.f");
hterm.VT.CharacterMap=function(a,b){this.description=a;this.GL=null;this.glmapBase_=b;this.sync_()};
hterm.VT.CharacterMap.prototype.sync_=function(a){var b=this;this.glmapBase_||a?(this.glmap_=a?Object.assign({},this.glmapBase_,a):this.glmapBase_,a=Object.keys(this.glmap_).map(function(a){return"\\x"+lib.f.zpad(a.charCodeAt(0).toString(16))}),this.glre_=new RegExp("["+a.join("")+"]","g"),this.GL=function(a){return a.replace(b.glre_,function(a){return b.glmap_[a]})}):(this.GL=null,delete this.glmap_,delete this.glre_)};
hterm.VT.CharacterMap.prototype.reset=function(){this.glmap_!==this.glmapBase_&&this.sync_()};hterm.VT.CharacterMap.prototype.setOverrides=function(a){this.sync_(a)};hterm.VT.CharacterMap.prototype.clone=function(){var a=new hterm.VT.CharacterMap(this.description,this.glmapBase_);this.glmap_!==this.glmapBase_&&a.setOverrides(this.glmap_);return a};hterm.VT.CharacterMaps=function(){this.mapsBase_=this.maps_=hterm.VT.CharacterMaps.DefaultMaps};hterm.VT.CharacterMaps.prototype.getMap=function(a){if(this.maps_.hasOwnProperty(a))return this.maps_[a]};
hterm.VT.CharacterMaps.prototype.addMap=function(a,b){this.maps_===this.mapsBase_&&(this.maps_=Object.assign({},this.mapsBase_));this.maps_[a]=b};hterm.VT.CharacterMaps.prototype.reset=function(){this.maps_!==hterm.VT.CharacterMaps.DefaultMaps&&(this.maps_=hterm.VT.CharacterMaps.DefaultMaps)};
hterm.VT.CharacterMaps.prototype.setOverrides=function(a){this.maps_===this.mapsBase_&&(this.maps_=Object.assign({},this.mapsBase_));for(var b in a){var c=this.getMap(b);void 0!==c?(this.maps_[b]=c.clone(),this.maps_[b].setOverrides(a[b])):this.addMap(b,new hterm.VT.CharacterMap("user "+b,a[b]))}};hterm.VT.CharacterMaps.DefaultMaps={};
hterm.VT.CharacterMaps.DefaultMaps["0"]=new hterm.VT.CharacterMap("graphic",{"`":"\u25c6",a:"\u2592",b:"\u2409",c:"\u240c",d:"\u240d",e:"\u240a",f:"\u00b0",g:"\u00b1",h:"\u2424",i:"\u240b",j:"\u2518",k:"\u2510",l:"\u250c",m:"\u2514",n:"\u253c",o:"\u23ba",p:"\u23bb",q:"\u2500",r:"\u23bc",s:"\u23bd",t:"\u251c",u:"\u2524",v:"\u2534",w:"\u252c",x:"\u2502",y:"\u2264",z:"\u2265","{":"\u03c0","|":"\u2260","}":"\u00a3","~":"\u00b7"});
hterm.VT.CharacterMaps.DefaultMaps.A=new hterm.VT.CharacterMap("british",{"#":"\u00a3"});hterm.VT.CharacterMaps.DefaultMaps.B=new hterm.VT.CharacterMap("us",null);hterm.VT.CharacterMaps.DefaultMaps["4"]=new hterm.VT.CharacterMap("dutch",{"#":"\u00a3","@":"\u00be","[":"\u0132","\\":"\u00bd","]":"|","{":"\u00a8","|":"f","}":"\u00bc","~":"\u00b4"});
hterm.VT.CharacterMaps.DefaultMaps.C=hterm.VT.CharacterMaps.DefaultMaps["5"]=new hterm.VT.CharacterMap("finnish",{"[":"\u00c4","\\":"\u00d6","]":"\u00c5","^":"\u00dc","`":"\u00e9","{":"\u00e4","|":"\u00f6","}":"\u00e5","~":"\u00fc"});hterm.VT.CharacterMaps.DefaultMaps.R=new hterm.VT.CharacterMap("french",{"#":"\u00a3","@":"\u00e0","[":"\u00b0","\\":"\u00e7","]":"\u00a7","{":"\u00e9","|":"\u00f9","}":"\u00e8","~":"\u00a8"});
hterm.VT.CharacterMaps.DefaultMaps.Q=new hterm.VT.CharacterMap("french canadian",{"@":"\u00e0","[":"\u00e2","\\":"\u00e7","]":"\u00ea","^":"\u00ee","`":"\u00f4","{":"\u00e9","|":"\u00f9","}":"\u00e8","~":"\u00fb"});hterm.VT.CharacterMaps.DefaultMaps.K=new hterm.VT.CharacterMap("german",{"@":"\u00a7","[":"\u00c4","\\":"\u00d6","]":"\u00dc","{":"\u00e4","|":"\u00f6","}":"\u00fc","~":"\u00df"});
hterm.VT.CharacterMaps.DefaultMaps.Y=new hterm.VT.CharacterMap("italian",{"#":"\u00a3","@":"\u00a7","[":"\u00b0","\\":"\u00e7","]":"\u00e9","`":"\u00f9","{":"\u00e0","|":"\u00f2","}":"\u00e8","~":"\u00ec"});hterm.VT.CharacterMaps.DefaultMaps.E=hterm.VT.CharacterMaps.DefaultMaps["6"]=new hterm.VT.CharacterMap("norwegian/danish",{"@":"\u00c4","[":"\u00c6","\\":"\u00d8","]":"\u00c5","^":"\u00dc","`":"\u00e4","{":"\u00e6","|":"\u00f8","}":"\u00e5","~":"\u00fc"});
hterm.VT.CharacterMaps.DefaultMaps.Z=new hterm.VT.CharacterMap("spanish",{"#":"\u00a3","@":"\u00a7","[":"\u00a1","\\":"\u00d1","]":"\u00bf","{":"\u00b0","|":"\u00f1","}":"\u00e7"});hterm.VT.CharacterMaps.DefaultMaps["7"]=hterm.VT.CharacterMaps.DefaultMaps.H=new hterm.VT.CharacterMap("swedish",{"@":"\u00c9","[":"\u00c4","\\":"\u00d6","]":"\u00c5","^":"\u00dc","`":"\u00e9","{":"\u00e4","|":"\u00f6","}":"\u00e5","~":"\u00fc"});
hterm.VT.CharacterMaps.DefaultMaps["="]=new hterm.VT.CharacterMap("swiss",{"#":"\u00f9","@":"\u00e0","[":"\u00e9","\\":"\u00e7","]":"\u00ea","^":"\u00ee",_:"\u00e8","`":"\u00f4","{":"\u00e4","|":"\u00f6","}":"\u00fc","~":"\u00fb"});lib.resource.add("hterm/audio/bell","audio/ogg;base64","base64  --  Encode/decode file as base64.  Call:            base64 [-e / -d] [options] [infile] [outfile]Options:           --copyright       Print copyright information           -d, --decode      Decode base64 encoded file           -e, --encode      Encode file into base64           -n, --noerrcheck  Ignore errors when decoding           -u, --help        Print this message           --version         Print version numberby John Walkerhttp://www.fourmilab.ch/");
lib.resource.add("hterm/images/icon-96","image/png;base64","base64  --  Encode/decode file as base64.  Call:            base64 [-e / -d] [options] [infile] [outfile]Options:           --copyright       Print copyright information           -d, --decode      Decode base64 encoded file           -e, --encode      Encode file into base64           -n, --noerrcheck  Ignore errors when decoding           -u, --help        Print this message           --version         Print version numberby John Walkerhttp://www.fourmilab.ch/");
lib.resource.add("hterm/concat/date","text/plain","Fri, 02 Feb 2018 11:09:27 +0000");lib.resource.add("hterm/changelog/version","text/plain","1.78");lib.resource.add("hterm/changelog/date","text/plain","2018-01-29");lib.resource.add("hterm/git/HEAD","text/plain","a8d402c0d12b1a88186cedaab208a91ce9f261f8");
